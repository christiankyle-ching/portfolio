parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"vCxL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=i,exports.__awaiter=u,exports.__generator=c,exports.__createBinding=f,exports.__exportStar=l,exports.__values=s,exports.__read=p,exports.__spread=y,exports.__spreadArrays=_,exports.__await=h,exports.__asyncGenerator=v,exports.__asyncDelegator=d,exports.__asyncValues=b,exports.__makeTemplateObject=w,exports.__importStar=x,exports.__importDefault=m,exports.__classPrivateFieldGet=O,exports.__classPrivateFieldSet=g,exports.__assign=void 0;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,i=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(i=(a<3?o(i):a>3?o(e,r,i):o(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function a(t,e){return function(r,n){e(r,n,t)}}function i(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function u(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{c(n.next(t))}catch(e){a(e)}}function u(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,u)}c((n=n.apply(t,e||[])).next())})}function c(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(u){a=[6,u],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function f(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}function l(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||(e[r]=t[r])}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(u){o={error:u}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function _(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],i=0,u=a.length;i<u;i++,o++)n[o]=a[i];return n}function h(t){return this instanceof h?(this.v=t,this):new h(t)}function v(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||u(t,e)})})}function u(t,e){try{(r=o[t](e)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function c(t){u("next",t)}function f(t){u("throw",t)}function l(t,e){t(e),a.shift(),a.length&&u(a[0][0],a[0][1])}}function d(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:h(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof s?s(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function x(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function m(t){return t&&t.__esModule?t:{default:t}}function O(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function g(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}exports.__assign=r;
},{}],"KxmD":[function(require,module,exports) {
var global = arguments[3];
var r=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.areCookiesEnabled=w,exports.async=X,exports.calculateBackoffMillis=hr,exports.contains=F,exports.createSubscribe=G,exports.deepCopy=u,exports.deepExtend=f,exports.errorPrefix=Z,exports.getUA=l,exports.isBrowser=_,exports.isBrowserExtension=y,exports.isElectron=E,exports.isEmpty=z,exports.isIE=g,exports.isIndexedDBAvailable=O,exports.isMobileCordova=v,exports.isNode=b,exports.isNodeSdk=S,exports.isReactNative=x,exports.isSafari=m,exports.isUWP=A,exports.jsonEval=j,exports.map=U,exports.ordinal=ur,exports.querystring=H,exports.querystringDecode=q,exports.safeGet=W,exports.stringify=k,exports.validateCallback=tr,exports.validateContextObject=er,exports.validateIndexedDBOpenable=C,exports.validateNamespace=rr,exports.validateArgCount=exports.stringToByteArray=exports.stringLength=exports.issuedAtTime=exports.isValidTimestamp=exports.isValidFormat=exports.isAdmin=exports.decode=exports.base64Encode=exports.base64Decode=exports.base64=exports.assertionError=exports.assert=exports.Sha1=exports.RANDOM_FACTOR=exports.MAX_VALUE_MILLIS=exports.FirebaseError=exports.ErrorFactory=exports.Deferred=exports.CONSTANTS=void 0;var t=require("tslib"),e={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};exports.CONSTANTS=e;var o=function(r,t){if(!r)throw n(t)};exports.assert=o;var n=function(r){return new Error("Firebase Database ("+e.SDK_VERSION+") INTERNAL ASSERT FAILED: "+r)};exports.assertionError=n;var i=function(r){for(var t=[],e=0,o=0;o<r.length;o++){var n=r.charCodeAt(o);n<128?t[e++]=n:n<2048?(t[e++]=n>>6|192,t[e++]=63&n|128):55296==(64512&n)&&o+1<r.length&&56320==(64512&r.charCodeAt(o+1))?(n=65536+((1023&n)<<10)+(1023&r.charCodeAt(++o)),t[e++]=n>>18|240,t[e++]=n>>12&63|128,t[e++]=n>>6&63|128,t[e++]=63&n|128):(t[e++]=n>>12|224,t[e++]=n>>6&63|128,t[e++]=63&n|128)}return t},s=function(r){for(var t=[],e=0,o=0;e<r.length;){var n=r[e++];if(n<128)t[o++]=String.fromCharCode(n);else if(n>191&&n<224){var i=r[e++];t[o++]=String.fromCharCode((31&n)<<6|63&i)}else if(n>239&&n<365){var s=((7&n)<<18|(63&(i=r[e++]))<<12|(63&(a=r[e++]))<<6|63&r[e++])-65536;t[o++]=String.fromCharCode(55296+(s>>10)),t[o++]=String.fromCharCode(56320+(1023&s))}else{i=r[e++];var a=r[e++];t[o++]=String.fromCharCode((15&n)<<12|(63&i)<<6|63&a)}}return t.join("")},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(r,t){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[],n=0;n<r.length;n+=3){var i=r[n],s=n+1<r.length,a=s?r[n+1]:0,c=n+2<r.length,h=c?r[n+2]:0,u=i>>2,f=(3&i)<<4|a>>4,p=(15&a)<<2|h>>6,d=63&h;c||(d=64,s||(p=64)),o.push(e[u],e[f],e[p],e[d])}return o.join("")},encodeString:function(r,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(r):this.encodeByteArray(i(r),t)},decodeString:function(r,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(r):s(this.decodeStringToByteArray(r,t))},decodeStringToByteArray:function(r,t){this.init_();for(var e=t?this.charToByteMapWebSafe_:this.charToByteMap_,o=[],n=0;n<r.length;){var i=e[r.charAt(n++)],s=n<r.length?e[r.charAt(n)]:0,a=++n<r.length?e[r.charAt(n)]:64,c=++n<r.length?e[r.charAt(n)]:64;if(++n,null==i||null==s||null==a||null==c)throw Error();var h=i<<2|s>>4;if(o.push(h),64!==a){var u=s<<4&240|a>>2;if(o.push(u),64!==c){var f=a<<6&192|c;o.push(f)}}}return o},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};exports.base64=a;var c=function(r){var t=i(r);return a.encodeByteArray(t,!0)};exports.base64Encode=c;var h=function(r){try{return a.decodeString(r,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function u(r){return f(void 0,r)}function f(r,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===r&&(r={});break;case Array:r=[];break;default:return t}for(var e in t)t.hasOwnProperty(e)&&p(e)&&(r[e]=f(r[e],t[e]));return r}function p(r){return"__proto__"!==r}exports.base64Decode=h;var d=function(){function r(){var r=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(t,e){r.resolve=t,r.reject=e})}return r.prototype.wrapCallback=function(r){var t=this;return function(e,o){e?t.reject(e):t.resolve(o),"function"==typeof r&&(t.promise.catch(function(){}),1===r.length?r(e):r(e,o))}},r}();function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function v(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())}function b(){try{return"[object process]"===Object.prototype.toString.call(r.process)}catch(t){return!1}}function _(){return"object"==typeof self&&self.self===self}function y(){var r="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof r&&void 0!==r.id}function x(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function E(){return l().indexOf("Electron/")>=0}function g(){var r=l();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function A(){return l().indexOf("MSAppHost/")>=0}function S(){return!0===e.NODE_CLIENT||!0===e.NODE_ADMIN}function m(){return!b()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function O(){return"indexedDB"in self&&null!=indexedDB}function C(){return new Promise(function(r,t){try{var e=!0,o="validate-browser-context-for-indexeddb-analytics-module",n=window.indexedDB.open(o);n.onsuccess=function(){n.result.close(),e||window.indexedDB.deleteDatabase(o),r(!0)},n.onupgradeneeded=function(){e=!1},n.onerror=function(){var r;t((null===(r=n.error)||void 0===r?void 0:r.message)||"")}}catch(i){t(i)}})}function w(){return!(!navigator||!navigator.cookieEnabled)}exports.Deferred=d;var D="FirebaseError",T=function(r){function e(t,o,n){var i=r.call(this,o)||this;return i.code=t,i.customData=n,i.name=D,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,N.prototype.create),i}return(0,t.__extends)(e,r),e}(Error);exports.FirebaseError=T;var N=function(){function r(r,t,e){this.service=r,this.serviceName=t,this.errors=e}return r.prototype.create=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var o=t[0]||{},n=this.service+"/"+r,i=this.errors[r],s=i?M(i,o):"Error",a=this.serviceName+": "+s+" ("+n+").";return new T(n,a,o)},r}();function M(r,t){return r.replace(B,function(r,e){var o=t[e];return null!=o?String(o):"<"+e+"?>"})}exports.ErrorFactory=N;var B=/\{\$([^}]+)}/g;function j(r){return JSON.parse(r)}function k(r){return JSON.stringify(r)}var P=function(r){var t={},e={},o={},n="";try{var i=r.split(".");t=j(h(i[0])||""),e=j(h(i[1])||""),n=i[2],o=e.d||{},delete e.d}catch(s){}return{header:t,claims:e,data:o,signature:n}};exports.decode=P;var I=function(r){var t=P(r).claims,e=Math.floor((new Date).getTime()/1e3),o=0,n=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?o=t.nbf:t.hasOwnProperty("iat")&&(o=t.iat),n=t.hasOwnProperty("exp")?t.exp:o+86400),!!e&&!!o&&!!n&&e>=o&&e<=n};exports.isValidTimestamp=I;var L=function(r){var t=P(r).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null};exports.issuedAtTime=L;var V=function(r){var t=P(r).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")};exports.isValidFormat=V;var R=function(r){var t=P(r).claims;return"object"==typeof t&&!0===t.admin};function F(r,t){return Object.prototype.hasOwnProperty.call(r,t)}function W(r,t){return Object.prototype.hasOwnProperty.call(r,t)?r[t]:void 0}function z(r){for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t))return!1;return!0}function U(r,t,e){var o={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(o[n]=t.call(e,r[n],n,r));return o}function H(r){for(var t=[],e=function(r,e){Array.isArray(e)?e.forEach(function(e){t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))},o=0,n=Object.entries(r);o<n.length;o++){var i=n[o];e(i[0],i[1])}return t.length?"&"+t.join("&"):""}function q(r){var t={};return r.replace(/^\?/,"").split("&").forEach(function(r){if(r){var e=r.split("=");t[e[0]]=e[1]}}),t}exports.isAdmin=R;var J=function(){function r(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var r=1;r<this.blockSize;++r)this.pad_[r]=0;this.reset()}return r.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},r.prototype.compress_=function(r,t){t||(t=0);var e=this.W_;if("string"==typeof r)for(var o=0;o<16;o++)e[o]=r.charCodeAt(t)<<24|r.charCodeAt(t+1)<<16|r.charCodeAt(t+2)<<8|r.charCodeAt(t+3),t+=4;else for(o=0;o<16;o++)e[o]=r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3],t+=4;for(o=16;o<80;o++){var n=e[o-3]^e[o-8]^e[o-14]^e[o-16];e[o]=4294967295&(n<<1|n>>>31)}var i,s,a=this.chain_[0],c=this.chain_[1],h=this.chain_[2],u=this.chain_[3],f=this.chain_[4];for(o=0;o<80;o++){o<40?o<20?(i=u^c&(h^u),s=1518500249):(i=c^h^u,s=1859775393):o<60?(i=c&h|u&(c|h),s=2400959708):(i=c^h^u,s=3395469782);n=(a<<5|a>>>27)+i+f+s+e[o]&4294967295;f=u,u=h,h=4294967295&(c<<30|c>>>2),c=a,a=n}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+f&4294967295},r.prototype.update=function(r,t){if(null!=r){void 0===t&&(t=r.length);for(var e=t-this.blockSize,o=0,n=this.buf_,i=this.inbuf_;o<t;){if(0===i)for(;o<=e;)this.compress_(r,o),o+=this.blockSize;if("string"==typeof r){for(;o<t;)if(n[i]=r.charCodeAt(o),++o,++i===this.blockSize){this.compress_(n),i=0;break}}else for(;o<t;)if(n[i]=r[o],++o,++i===this.blockSize){this.compress_(n),i=0;break}}this.inbuf_=i,this.total_+=t}},r.prototype.digest=function(){var r=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);var o=0;for(e=0;e<5;e++)for(var n=24;n>=0;n-=8)r[o]=this.chain_[e]>>n&255,++o;return r},r}();function G(r,t){var e=new K(r,t);return e.subscribe.bind(e)}exports.Sha1=J;var K=function(){function r(r,t){var e=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){r(e)}).catch(function(r){e.error(r)})}return r.prototype.next=function(r){this.forEachObserver(function(t){t.next(r)})},r.prototype.error=function(r){this.forEachObserver(function(t){t.error(r)}),this.close(r)},r.prototype.complete=function(){this.forEachObserver(function(r){r.complete()}),this.close()},r.prototype.subscribe=function(r,t,e){var o,n=this;if(void 0===r&&void 0===t&&void 0===e)throw new Error("Missing Observer.");void 0===(o=$(r,["next","error","complete"])?r:{next:r,error:t,complete:e}).next&&(o.next=Q),void 0===o.error&&(o.error=Q),void 0===o.complete&&(o.complete=Q);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{n.finalError?o.error(n.finalError):o.complete()}catch(r){}}),this.observers.push(o),i},r.prototype.unsubscribeOne=function(r){void 0!==this.observers&&void 0!==this.observers[r]&&(delete this.observers[r],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},r.prototype.forEachObserver=function(r){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,r)},r.prototype.sendOne=function(r,t){var e=this;this.task.then(function(){if(void 0!==e.observers&&void 0!==e.observers[r])try{t(e.observers[r])}catch(o){"undefined"!=typeof console&&console.error&&console.error(o)}})},r.prototype.close=function(r){var t=this;this.finalized||(this.finalized=!0,void 0!==r&&(this.finalError=r),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},r}();function X(r,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];Promise.resolve(!0).then(function(){r.apply(void 0,e)}).catch(function(r){t&&t(r)})}}function $(r,t){if("object"!=typeof r||null===r)return!1;for(var e=0,o=t;e<o.length;e++){var n=o[e];if(n in r&&"function"==typeof r[n])return!0}return!1}function Q(){}var Y=function(r,t,e,o){var n;if(o<t?n="at least "+t:o>e&&(n=0===e?"none":"no more than "+e),n)throw new Error(r+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+n+".")};function Z(r,t,e){var o="";switch(t){case 1:o=e?"first":"First";break;case 2:o=e?"second":"Second";break;case 3:o=e?"third":"Third";break;case 4:o=e?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var n=r+" failed: ";return n+=o+" argument "}function rr(r,t,e,o){if((!o||e)&&"string"!=typeof e)throw new Error(Z(r,t,o)+"must be a valid firebase namespace.")}function tr(r,t,e,o){if((!o||e)&&"function"!=typeof e)throw new Error(Z(r,t,o)+"must be a valid function.")}function er(r,t,e,o){if((!o||e)&&("object"!=typeof e||null===e))throw new Error(Z(r,t,o)+"must be a valid context object.")}exports.validateArgCount=Y;var or=function(r){for(var t=[],e=0,n=0;n<r.length;n++){var i=r.charCodeAt(n);if(i>=55296&&i<=56319){var s=i-55296;o(++n<r.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(r.charCodeAt(n)-56320)}i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=63&i|128):i<65536?(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=63&i|128):(t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=63&i|128)}return t};exports.stringToByteArray=or;var nr=function(r){for(var t=0,e=0;e<r.length;e++){var o=r.charCodeAt(e);o<128?t++:o<2048?t+=2:o>=55296&&o<=56319?(t+=4,e++):t+=3}return t};exports.stringLength=nr;var ir=1e3,sr=2,ar=144e5;exports.MAX_VALUE_MILLIS=ar;var cr=.5;function hr(r,t,e){void 0===t&&(t=ir),void 0===e&&(e=sr);var o=t*Math.pow(e,r),n=Math.round(cr*o*(Math.random()-.5)*2);return Math.min(ar,o+n)}function ur(r){return Number.isFinite(r)?r+fr(r):""+r}function fr(r){var t=(r=Math.abs(r))%100;if(t>=10&&t<=20)return"th";var e=r%10;return 1===e?"st":2===e?"nd":3===e?"rd":"th"}exports.RANDOM_FACTOR=cr;
},{"tslib":"vCxL"}],"sLOu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Provider=exports.ComponentContainer=exports.Component=void 0;var t=require("tslib"),e=require("@firebase/util"),n=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();exports.Component=n;var r="[DEFAULT]",i=function(){function n(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return n.prototype.get=function(t){void 0===t&&(t=r);var n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){var i=new e.Deferred;this.instancesDeferred.set(n,i);try{var o=this.getOrInitializeService(n);o&&i.resolve(o)}catch(s){}}return this.instancesDeferred.get(n).promise},n.prototype.getImmediate=function(e){var n=(0,t.__assign)({identifier:r,optional:!1},e),i=n.identifier,o=n.optional,s=this.normalizeInstanceIdentifier(i);try{var a=this.getOrInitializeService(s);if(!a){if(o)return null;throw Error("Service "+this.name+" is not available")}return a}catch(c){if(o)return null;throw c}},n.prototype.getComponent=function(){return this.component},n.prototype.setComponent=function(e){var n,i;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,s(e))try{this.getOrInitializeService(r)}catch(l){}try{for(var o=(0,t.__values)(this.instancesDeferred.entries()),a=o.next();!a.done;a=o.next()){var c=(0,t.__read)(a.value,2),p=c[0],h=c[1],u=this.normalizeInstanceIdentifier(p);try{var f=this.getOrInitializeService(u);h.resolve(f)}catch(l){}}}catch(d){n={error:d}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},n.prototype.clearInstance=function(t){void 0===t&&(t=r),this.instancesDeferred.delete(t),this.instances.delete(t)},n.prototype.delete=function(){return(0,t.__awaiter)(this,void 0,void 0,function(){var e;return(0,t.__generator)(this,function(n){switch(n.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all((0,t.__spread)(e.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}),e.filter(function(t){return"_delete"in t}).map(function(t){return t._delete()})))];case 1:return n.sent(),[2]}})})},n.prototype.isComponentSet=function(){return null!=this.component},n.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,o(t)),this.instances.set(t,e)),e||null},n.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:r:t},n}();function o(t){return t===r?void 0:t}function s(t){return"EAGER"===t.instantiationMode}exports.Provider=i;var a=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new i(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();exports.ComponentContainer=a;
},{"tslib":"vCxL","@firebase/util":"KxmD"}],"TUpU":[function(require,module,exports) {
"use strict";function e(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var l=arguments[t],i=0,s=l.length;i<s;i++,n++)o[n]=l[i];return o}var t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.setLogLevel=g,exports.setUserLogHandler=u,exports.Logger=exports.LogLevel=void 0;var r,o=[];exports.LogLevel=r,function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(r||(exports.LogLevel=r={}));var n={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},l=r.INFO,i=((t={})[r.DEBUG]="log",t[r.VERBOSE]="log",t[r.INFO]="info",t[r.WARN]="warn",t[r.ERROR]="error",t),s=function(t,r){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];if(!(r<t.logLevel)){var l=(new Date).toISOString(),s=i[r];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+r+")");console[s].apply(console,e(["["+l+"]  "+t.name+":"],o))}},a=function(){function t(e){this.name=e,this._logLevel=l,this._logHandler=s,this._userLogHandler=null,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in r))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?n[e]:e},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this._userLogHandler&&this._userLogHandler.apply(this,e([this,r.DEBUG],t)),this._logHandler.apply(this,e([this,r.DEBUG],t))},t.prototype.log=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this._userLogHandler&&this._userLogHandler.apply(this,e([this,r.VERBOSE],t)),this._logHandler.apply(this,e([this,r.VERBOSE],t))},t.prototype.info=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this._userLogHandler&&this._userLogHandler.apply(this,e([this,r.INFO],t)),this._logHandler.apply(this,e([this,r.INFO],t))},t.prototype.warn=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this._userLogHandler&&this._userLogHandler.apply(this,e([this,r.WARN],t)),this._logHandler.apply(this,e([this,r.WARN],t))},t.prototype.error=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this._userLogHandler&&this._userLogHandler.apply(this,e([this,r.ERROR],t)),this._logHandler.apply(this,e([this,r.ERROR],t))},t}();function g(e){o.forEach(function(t){t.setLogLevel(e)})}function u(e,t){for(var l=function(o){var l=null;t&&t.level&&(l=n[t.level]),o.userLogHandler=null===e?null:function(t,o){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var s=n.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}}).filter(function(e){return e}).join(" ");o>=(null!=l?l:t.logLevel)&&e({level:r[o].toLowerCase(),message:s,args:n,type:t.name})}},i=0,s=o;i<s.length;i++){l(s[i])}}exports.Logger=a;
},{}],"VxYX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.firebase=exports.default=void 0;var e,n,r=require("tslib"),t=require("@firebase/util"),i=require("@firebase/component"),a=require("@firebase/logger"),o=((e={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",e["bad-app-name"]="Illegal App name: '{$appName}",e["duplicate-app"]="Firebase App named '{$appName}' already exists",e["app-deleted"]="Firebase App named '{$appName}' already deleted",e["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",e["invalid-log-argument"]="First argument to `onLog` must be null or a function.",e),s=new t.ErrorFactory("app","Firebase",o),p="@firebase/app",l="0.6.13",c="@firebase/analytics",u="@firebase/auth",f="@firebase/database",d="@firebase/functions",m="@firebase/installations",b="@firebase/messaging",h="@firebase/performance",g="@firebase/remote-config",v="@firebase/storage",y="@firebase/firestore",_="firebase-wrapper",w="[DEFAULT]",N=((n={})[p]="fire-core",n[c]="fire-analytics",n[u]="fire-auth",n[f]="fire-rtdb",n[d]="fire-fn",n[m]="fire-iid",n[b]="fire-fcm",n[h]="fire-perf",n[g]="fire-rc",n[v]="fire-gcs",n[y]="fire-fst",n["fire-js"]="fire-js",n[_]="fire-js-all",n),C=new a.Logger("@firebase/app"),I=function(){function e(e,n,a){var o,s,p=this;this.firebase_=a,this.isDeleted_=!1,this.name_=n.name,this.automaticDataCollectionEnabled_=n.automaticDataCollectionEnabled||!1,this.options_=(0,t.deepCopy)(e),this.container=new i.ComponentContainer(n.name),this._addComponent(new i.Component("app",function(){return p},"PUBLIC"));try{for(var l=(0,r.__values)(this.firebase_.INTERNAL.components.values()),c=l.next();!c.done;c=l.next()){var u=c.value;this._addComponent(u)}}catch(f){o={error:f}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(n){e.checkDestroyed_(),n()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(e){return e.delete()}))}).then(function(){e.isDeleted_=!0})},e.prototype._getService=function(e,n){return void 0===n&&(n=w),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:n})},e.prototype._removeServiceInstance=function(e,n){void 0===n&&(n=w),this.container.getProvider(e).clearInstance(n)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(n){C.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,n)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw s.create("app-deleted",{appName:this.name_})},e}();I.prototype.name&&I.prototype.options||I.prototype.delete||console.log("dc");var E="8.0.1";function A(e){var n={},o=new Map,p={__esModule:!0,initializeApp:function(r,i){void 0===i&&(i={});if("object"!=typeof i||null===i){var a=i;i={name:a}}var o=i;void 0===o.name&&(o.name=w);var l=o.name;if("string"!=typeof l||!l)throw s.create("bad-app-name",{appName:String(l)});if((0,t.contains)(n,l))throw s.create("duplicate-app",{appName:l});var c=new e(r,o,p);return n[l]=c,c},app:l,registerVersion:function(e,n,r){var t,a=null!==(t=N[e])&&void 0!==t?t:e;r&&(a+="-"+r);var o=a.match(/\s|\//),s=n.match(/\s|\//);if(o||s){var p=['Unable to register library "'+a+'" with version "'+n+'":'];return o&&p.push('library name "'+a+'" contains illegal characters (whitespace or "/")'),o&&s&&p.push("and"),s&&p.push('version name "'+n+'" contains illegal characters (whitespace or "/")'),void C.warn(p.join(" "))}c(new i.Component(a+"-version",function(){return{library:a,version:n}},"VERSION"))},setLogLevel:a.setLogLevel,onLog:function(e,n){if(null!==e&&"function"!=typeof e)throw s.create("invalid-log-argument",{appName:name});(0,a.setUserLogHandler)(e,n)},apps:null,SDK_VERSION:E,INTERNAL:{registerComponent:c,removeApp:function(e){delete n[e]},components:o,useAsService:function(e,n){if("serverAuth"===n)return null;return n}}};function l(e){if(e=e||w,!(0,t.contains)(n,e))throw s.create("no-app",{appName:e});return n[e]}function c(i){var a,c,u=i.name;if(o.has(u))return C.debug("There were multiple attempts to register component "+u+"."),"PUBLIC"===i.type?p[u]:null;if(o.set(u,i),"PUBLIC"===i.type){var f=function(e){if(void 0===e&&(e=l()),"function"!=typeof e[u])throw s.create("invalid-app-argument",{appName:u});return e[u]()};void 0!==i.serviceProps&&(0,t.deepExtend)(f,i.serviceProps),p[u]=f,e.prototype[u]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._getService.bind(this,u).apply(this,i.multipleInstances?e:[])}}try{for(var d=(0,r.__values)(Object.keys(n)),m=d.next();!m.done;m=d.next()){var b=m.value;n[b]._addComponent(i)}}catch(h){a={error:h}}finally{try{m&&!m.done&&(c=d.return)&&c.call(d)}finally{if(a)throw a.error}}return"PUBLIC"===i.type?p[u]:null}return p.default=p,Object.defineProperty(p,"apps",{get:function(){return Object.keys(n).map(function(e){return n[e]})}}),l.App=e,p}function F(){var e=A(I);return e.INTERNAL=(0,r.__assign)((0,r.__assign)({},e.INTERNAL),{createFirebaseNamespace:F,extendNamespace:function(n){(0,t.deepExtend)(e,n)},createSubscribe:t.createSubscribe,ErrorFactory:t.ErrorFactory,deepExtend:t.deepExtend}),e}var P=F(),L=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(D(e)){var n=e.getImmediate();return n.library+"/"+n.version}return null}).filter(function(e){return e}).join(" ")},e}();function D(e){var n=e.getComponent();return"VERSION"===(null==n?void 0:n.type)}function j(e,n){e.INTERNAL.registerComponent(new i.Component("platform-logger",function(e){return new L(e)},"PRIVATE")),e.registerVersion(p,l,n),e.registerVersion("fire-js","")}if((0,t.isBrowser)()&&void 0!==self.firebase){C.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var x=self.firebase.SDK_VERSION;x&&x.indexOf("LITE")>=0&&C.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var O=P.initializeApp;P.initializeApp=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(0,t.isNode)()&&C.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),O.apply(void 0,e)};var k=P;exports.firebase=k,j(k);var S=k;exports.default=S;
},{"tslib":"vCxL","@firebase/util":"KxmD","@firebase/component":"sLOu","@firebase/logger":"TUpU"}],"OJEJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return e.default}});var e=r(require("@firebase/app"));function r(e){return e&&e.__esModule?e:{default:e}}var t="firebase",u="8.1.1";e.default.registerVersion(t,u,"app");
},{"@firebase/app":"VxYX"}],"ueHA":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStatEventTarget=exports.createWebChannelTransport=exports.XhrIo=exports.WebChannel=exports.Stat=exports.EventType=exports.Event=exports.ErrorCode=exports.default=void 0;var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,e)};function e(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}function i(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}var r,a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},o=o||{},s=a||self;function h(){}function l(t){var n=typeof t;return"array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length}function u(t){var n=typeof t;return"object"==n&&null!=t||"function"==n}function c(t){return Object.prototype.hasOwnProperty.call(t,f)&&t[f]||(t[f]=++p)}var f="closure_uid_"+(1e9*Math.random()>>>0),p=0;function v(t,n,e){return t.call.apply(t.bind,arguments)}function g(t,n,e){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,i),t.apply(n,e)}}return function(){return t.apply(n,arguments)}}function y(t,n,e){return(y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?v:g).apply(null,arguments)}function d(t,n){var e=Array.prototype.slice.call(arguments,1);return function(){var n=e.slice();return n.push.apply(n,arguments),t.apply(this,n)}}function b(){return Date.now()}function m(t,n){function e(){}e.prototype=n.prototype,t.X=n.prototype,t.prototype=new e,t.prototype.constructor=t,t.Kb=function(t,e,i){for(var r=Array(arguments.length-2),a=2;a<arguments.length;a++)r[a-2]=arguments[a];return n.prototype[e].apply(t,r)}}function w(){this.j=this.j,this.i=this.i}var T=0;w.prototype.j=!1,w.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0!=T))c(this)},w.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var E=Array.prototype.indexOf?function(t,n){return Array.prototype.indexOf.call(t,n,void 0)}:function(t,n){if("string"==typeof t)return"string"!=typeof n||1!=n.length?-1:t.indexOf(n,0);for(var e=0;e<t.length;e++)if(e in t&&t[e]===n)return e;return-1},S=Array.prototype.forEach?function(t,n,e){Array.prototype.forEach.call(t,n,e)}:function(t,n,e){for(var i=t.length,r="string"==typeof t?t.split(""):t,a=0;a<i;a++)a in r&&n.call(e,r[a],a,t)};function C(t){t:{for(var n=De,e=t.length,i="string"==typeof t?t.split(""):t,r=0;r<e;r++)if(r in i&&n.call(void 0,i[r],r,t)){n=r;break t}n=-1}return 0>n?null:"string"==typeof t?t.charAt(n):t[n]}function x(t){return Array.prototype.concat.apply([],arguments)}function I(t){var n=t.length;if(0<n){for(var e=Array(n),i=0;i<n;i++)e[i]=t[i];return e}return[]}function O(t){return/^[\s\xa0]*$/.test(t)}var P,A=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function R(t,n){return-1!=t.indexOf(n)}function j(t,n){return t<n?-1:t>n?1:0}t:{var M=s.navigator;if(M){var L=M.userAgent;if(L){P=L;break t}}P=""}function _(t,n,e){for(var i in t)n.call(e,t[i],i,t)}function X(t){var n={};for(var e in t)n[e]=t[e];return n}var k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(t,n){for(var e,i,r=1;r<arguments.length;r++){for(e in i=arguments[r])t[e]=i[e];for(var a=0;a<k.length;a++)e=k[a],Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])}}function H(t){return H[" "](t),t}function N(t,n){var e=Z;return Object.prototype.hasOwnProperty.call(e,t)?e[t]:e[t]=n(t)}H[" "]=h;var U,B=R(P,"Opera"),F=R(P,"Trident")||R(P,"MSIE"),K=R(P,"Edge"),Y=K||F,W=R(P,"Gecko")&&!(R(P.toLowerCase(),"webkit")&&!R(P,"Edge"))&&!(R(P,"Trident")||R(P,"MSIE"))&&!R(P,"Edge"),G=R(P.toLowerCase(),"webkit")&&!R(P,"Edge");function J(){var t=s.document;return t?t.documentMode:void 0}t:{var V="",q=function(){var t=P;return W?/rv:([^\);]+)(\)|;)/.exec(t):K?/Edge\/([\d\.]+)/.exec(t):F?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):G?/WebKit\/(\S+)/.exec(t):B?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(q&&(V=q?q[1]:""),F){var $=J();if(null!=$&&$>parseFloat(V)){U=String($);break t}}U=V}var z,Z={};function Q(t){return N(t,function(){for(var n=0,e=A(String(U)).split("."),i=A(String(t)).split("."),r=Math.max(e.length,i.length),a=0;0==n&&a<r;a++){var o=e[a]||"",s=i[a]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;n=j(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||j(0==o[2].length,0==s[2].length)||j(o[2],s[2]),o=o[3],s=s[3]}while(0==n)}return 0<=n})}if(s.document&&F){var tt=J();z=tt||(parseInt(U,10)||void 0)}else z=void 0;var nt=z,et=!F||9<=Number(nt),it=F&&!Q("9"),rt=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,n=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",h,n),s.removeEventListener("test",h,n)}catch(e){}return t}();function at(t,n){this.type=t,this.a=this.target=n,this.defaultPrevented=!1}function ot(t,n){if(at.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var e=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=n,n=t.relatedTarget){if(W){t:{try{H(n.nodeName);var r=!0;break t}catch(a){}r=!1}r||(n=null)}}else"mouseover"==e?n=t.fromElement:"mouseout"==e&&(n=t.toElement);this.relatedTarget=n,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:st[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}at.prototype.b=function(){this.defaultPrevented=!0},m(ot,at);var st={2:"touch",3:"pen",4:"mouse"};ot.prototype.b=function(){ot.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,it)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(n){}};var ht="closure_listenable_"+(1e6*Math.random()|0),lt=0;function ut(t,n,e,i,r){this.listener=t,this.proxy=null,this.src=n,this.type=e,this.capture=!!i,this.ca=r,this.key=++lt,this.Y=this.Z=!1}function ct(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function ft(t){this.src=t,this.a={},this.b=0}function pt(t,n){var e=n.type;if(e in t.a){var i,r=t.a[e],a=E(r,n);(i=0<=a)&&Array.prototype.splice.call(r,a,1),i&&(ct(n),0==t.a[e].length&&(delete t.a[e],t.b--))}}function vt(t,n,e,i){for(var r=0;r<t.length;++r){var a=t[r];if(!a.Y&&a.listener==n&&a.capture==!!e&&a.ca==i)return r}return-1}ft.prototype.add=function(t,n,e,i,r){var a=t.toString();(t=this.a[a])||(t=this.a[a]=[],this.b++);var o=vt(t,n,i,r);return-1<o?(n=t[o],e||(n.Z=!1)):((n=new ut(n,this.src,a,!!i,r)).Z=e,t.push(n)),n};var gt="closure_lm_"+(1e6*Math.random()|0),yt={};function dt(t,n,e,i,r){if(i&&i.once)return wt(t,n,e,i,r);if(Array.isArray(n)){for(var a=0;a<n.length;a++)dt(t,n[a],e,i,r);return null}return e=Pt(e),t&&t[ht]?t.va(n,e,u(i)?!!i.capture:!!i,r):bt(t,n,e,!1,i,r)}function bt(t,n,e,i,r,a){if(!n)throw Error("Invalid event type");var o=u(r)?!!r.capture:!!r;if(o&&!et)return null;var s=It(t);if(s||(t[gt]=s=new ft(t)),(e=s.add(n,e,i,o,a)).proxy)return e;if(i=mt(),e.proxy=i,i.src=t,i.listener=e,t.addEventListener)rt||(r=o),void 0===r&&(r=!1),t.addEventListener(n.toString(),i,r);else if(t.attachEvent)t.attachEvent(St(n.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return e}function mt(){var t=xt,n=et?function(e){return t.call(n.src,n.listener,e)}:function(e){if(!(e=t.call(n.src,n.listener,e)))return e};return n}function wt(t,n,e,i,r){if(Array.isArray(n)){for(var a=0;a<n.length;a++)wt(t,n[a],e,i,r);return null}return e=Pt(e),t&&t[ht]?t.wa(n,e,u(i)?!!i.capture:!!i,r):bt(t,n,e,!0,i,r)}function Tt(t,n,e,i,r){if(Array.isArray(n))for(var a=0;a<n.length;a++)Tt(t,n[a],e,i,r);else i=u(i)?!!i.capture:!!i,e=Pt(e),t&&t[ht]?(t=t.c,(n=String(n).toString())in t.a&&(-1<(e=vt(a=t.a[n],e,i,r))&&(ct(a[e]),Array.prototype.splice.call(a,e,1),0==a.length&&(delete t.a[n],t.b--)))):t&&(t=It(t))&&(n=t.a[n.toString()],t=-1,n&&(t=vt(n,e,i,r)),(e=-1<t?n[t]:null)&&Et(e))}function Et(t){if("number"!=typeof t&&t&&!t.Y){var n=t.src;if(n&&n[ht])pt(n.c,t);else{var e=t.type,i=t.proxy;n.removeEventListener?n.removeEventListener(e,i,t.capture):n.detachEvent?n.detachEvent(St(e),i):n.addListener&&n.removeListener&&n.removeListener(i),(e=It(n))?(pt(e,t),0==e.b&&(e.src=null,n[gt]=null)):ct(t)}}}function St(t){return t in yt?yt[t]:yt[t]="on"+t}function Ct(t,n){var e=t.listener,i=t.ca||t.src;return t.Z&&Et(t),e.call(i,n)}function xt(t,n){if(t.Y)return!0;if(!et){if(!n)t:{n=["window","event"];for(var e=s,i=0;i<n.length;i++)if(null==(e=e[n[i]])){n=null;break t}n=e}return Ct(t,n=new ot(n,this))}return Ct(t,new ot(n,this))}function It(t){return(t=t[gt])instanceof ft?t:null}var Ot="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pt(t){return"function"==typeof t?t:(t[Ot]||(t[Ot]=function(n){return t.handleEvent(n)}),t[Ot])}function At(){w.call(this),this.c=new ft(this),this.J=this,this.C=null}function Rt(t,n){var e,i=t.C;if(i)for(e=[];i;i=i.C)e.push(i);if(t=t.J,i=n.type||n,"string"==typeof n)n=new at(n,t);else if(n instanceof at)n.target=n.target||t;else{var r=n;D(n=new at(i,t),r)}if(r=!0,e)for(var a=e.length-1;0<=a;a--){var o=n.a=e[a];r=jt(o,i,!0,n)&&r}if(r=jt(o=n.a=t,i,!0,n)&&r,r=jt(o,i,!1,n)&&r,e)for(a=0;a<e.length;a++)r=jt(o=n.a=e[a],i,!1,n)&&r}function jt(t,n,e,i){if(!(n=t.c.a[String(n)]))return!0;n=n.concat();for(var r=!0,a=0;a<n.length;++a){var o=n[a];if(o&&!o.Y&&o.capture==e){var s=o.listener,h=o.ca||o.src;o.Z&&pt(t.c,o),r=!1!==s.call(h,i)&&r}}return r&&!i.defaultPrevented}m(At,w),At.prototype[ht]=!0,(r=At.prototype).addEventListener=function(t,n,e,i){dt(this,t,n,e,i)},r.removeEventListener=function(t,n,e,i){Tt(this,t,n,e,i)},r.G=function(){if(At.X.G.call(this),this.c){var t,n=this.c;for(t in n.a){for(var e=n.a[t],i=0;i<e.length;i++)ct(e[i]);delete n.a[t],n.b--}}this.C=null},r.va=function(t,n,e,i){return this.c.add(String(t),n,!1,e,i)},r.wa=function(t,n,e,i){return this.c.add(String(t),n,!0,e,i)};var Mt=s.JSON.stringify;function Lt(){this.b=this.a=null}var _t,Xt=new(function(){function t(t,n){this.c=t,this.f=n,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())(function(){return new Dt},function(t){t.reset()});function kt(){var t=Ft,n=null;return t.a&&(n=t.a,t.a=t.a.next,t.a||(t.b=null),n.next=null),n}function Dt(){this.next=this.b=this.a=null}function Ht(t){s.setTimeout(function(){throw t},0)}function Nt(t,n){_t||Ut(),Bt||(_t(),Bt=!0),Ft.add(t,n)}function Ut(){var t=s.Promise.resolve(void 0);_t=function(){t.then(Kt)}}Lt.prototype.add=function(t,n){var e=Xt.get();e.set(t,n),this.b?this.b.next=e:this.a=e,this.b=e},Dt.prototype.set=function(t,n){this.a=t,this.b=n,this.next=null},Dt.prototype.reset=function(){this.next=this.b=this.a=null};var Bt=!1,Ft=new Lt;function Kt(){for(var t;t=kt();){try{t.a.call(t.b)}catch(e){Ht(e)}var n=Xt;n.f(t),100>n.b&&(n.b++,t.next=n.a,n.a=t)}Bt=!1}function Yt(t,n){At.call(this),this.b=t||1,this.a=n||s,this.f=y(this.Za,this),this.g=b()}function Wt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Gt(t,n,e){if("function"==typeof t)e&&(t=y(t,e));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=y(t.handleEvent,t)}return 2147483647<Number(n)?-1:s.setTimeout(t,n||0)}function Jt(t){t.a=Gt(function(){t.a=null,t.c&&(t.c=!1,Jt(t))},t.h);var n=t.b;t.b=null,t.g.apply(null,n)}m(Yt,At),(r=Yt.prototype).aa=!1,r.M=null,r.Za=function(){if(this.aa){var t=b()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Rt(this,"tick"),this.aa&&(Wt(this),this.start()))}},r.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=b())},r.G=function(){Yt.X.G.call(this),Wt(this),delete this.a};var Vt=function(t){function n(n,e){var i=t.call(this)||this;return i.g=n,i.h=e,i.b=null,i.c=!1,i.a=null,i}return e(n,t),n.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Jt(this)},n.prototype.G=function(){t.prototype.G.call(this),this.a&&(s.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},n}(w);function qt(t){w.call(this),this.b=t,this.a={}}m(qt,w);var $t=[];function zt(t,n,e,i){Array.isArray(e)||(e&&($t[0]=e.toString()),e=$t);for(var r=0;r<e.length;r++){var a=dt(n,e[r],i||t.handleEvent,!1,t.b||t);if(!a)break;t.a[a.key]=a}}function Zt(t){_(t.a,function(t,n){this.a.hasOwnProperty(n)&&Et(t)},t),t.a={}}function Qt(){this.a=!0}function tn(t,n,e,i,r,a){t.info(function(){if(t.a)if(a)for(var o="",s=a.split("&"),h=0;h<s.length;h++){var l=s[h].split("=");if(1<l.length){var u=l[0];l=l[1];var c=u.split("_");o=2<=c.length&&"type"==c[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+n+"\n"+e+"\n"+o})}function nn(t,n,e,i,r,a,o){t.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+n+"\n"+e+"\n"+a+" "+o})}function en(t,n,e,i){t.info(function(){return"XMLHTTP TEXT ("+n+"): "+an(t,e)+(i?" "+i:"")})}function rn(t,n){t.info(function(){return"TIMEOUT: "+n})}function an(t,n){if(!t.a)return n;if(!n)return null;try{var e=JSON.parse(n);if(e)for(t=0;t<e.length;t++)if(Array.isArray(e[t])){var i=e[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var a=r[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<r.length;o++)r[o]=""}}}return Mt(e)}catch(s){return n}}qt.prototype.G=function(){qt.X.G.call(this),Zt(this)},qt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Qt.prototype.info=function(){};var on={},sn=null;function hn(){return sn=sn||new At}function ln(t){at.call(this,on.Fa,t)}function un(t){var n=hn();Rt(n,new ln(n,t))}function cn(t,n){at.call(this,on.STAT_EVENT,t),this.stat=n}function fn(t){var n=hn();Rt(n,new cn(n,t))}function pn(t){at.call(this,on.Ga,t)}function vn(t,n){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){t()},n)}on.Fa="serverreachability",m(ln,at),on.STAT_EVENT="statevent",m(cn,at),on.Ga="timingevent",m(pn,at);var gn={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},yn={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function dn(){}function bn(t){var n;return(n=t.a)||(n=t.a={}),n}function mn(){}dn.prototype.a=null;var wn,Tn={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function En(){at.call(this,"d")}function Sn(){at.call(this,"c")}function Cn(){}function xn(t,n,e,i){this.g=t,this.c=n,this.f=e,this.S=i||1,this.J=new qt(this),this.P=In,t=Y?125:void 0,this.R=new Yt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}m(En,at),m(Sn,at),m(Cn,dn),wn=new Cn;var In=45e3,On={},Pn={};function An(t,n,e){t.H=1,t.i=Qn(Jn(n)),t.j=e,t.I=!0,Rn(t,null)}function Rn(t,n){t.u=b(),Ln(t),t.l=Jn(t.i);var e=t.l,i=t.S;Array.isArray(i)||(i=[String(i)]),ve(e.b,"t",i),t.D=0,t.a=pi(t.g,t.g.C?n:null),0<t.O&&(t.F=new Vt(y(t.Ca,t,t.a),t.O)),zt(t.J,t.a,"readystatechange",t.Xa),n=t.B?X(t.B):{},t.j?(t.m||(t.m="POST"),n["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,n)):(t.m="GET",t.a.ba(t.l,t.m,null,n)),un(1),tn(t.c,t.m,t.l,t.f,t.S,t.j)}function jn(t,n,e){for(var i=!0;!t.A&&t.D<e.length;){var r=Mn(t,e);if(r==Pn){4==n&&(t.h=4,fn(14),i=!1),en(t.c,t.f,null,"[Incomplete Response]");break}if(r==On){t.h=4,fn(15),en(t.c,t.f,e,"[Invalid Chunk]"),i=!1;break}en(t.c,t.f,r,null),Hn(t,r)}4==n&&0==e.length&&(t.h=1,fn(16),i=!1),t.b=t.b&&i,i?0<e.length&&!t.V&&(t.V=!0,(n=t.g).a==t&&n.U&&!n.F&&(n.c.info("Great, no buffering proxy detected. Bytes received: "+e.length),ai(n),n.F=!0,fn(11))):(en(t.c,t.f,e,"[Invalid Chunked Response]"),Dn(t),kn(t))}function Mn(t,n){var e=t.D,i=n.indexOf("\n",e);return-1==i?Pn:(e=Number(n.substring(e,i)),isNaN(e)?On:(i+=1)+e>n.length?Pn:(n=n.substr(i,e),t.D=i+e,n))}function Ln(t){t.T=b()+t.P,_n(t,t.P)}function _n(t,n){if(null!=t.o)throw Error("WatchDog timer not null");t.o=vn(y(t.Va,t),n)}function Xn(t){t.o&&(s.clearTimeout(t.o),t.o=null)}function kn(t){0==t.g.v||t.A||hi(t.g,t)}function Dn(t){Xn(t);var n=t.F;n&&"function"==typeof n.ja&&n.ja(),t.F=null,Wt(t.R),Zt(t.J),t.a&&(n=t.a,t.a=null,n.abort(),n.ja())}function Hn(t,n){try{var e=t.g;if(0!=e.v&&(e.a==t||Ee(e.b,t)))if(e.I=t.N,!t.C&&Ee(e.b,t)&&3==e.v){try{var i=e.ka.a.parse(n)}catch(d){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!e.j){if(e.a){if(!(e.a.u+3e3<t.u))break t;si(e),qe(e)}ri(e),fn(18)}}else e.oa=r[1],0<e.oa-e.P&&37500>r[2]&&e.H&&0==e.o&&!e.m&&(e.m=vn(y(e.Sa,e),6e3));if(1>=Te(e.b)&&e.ea){try{e.ea()}catch(d){}e.ea=void 0}}else ui(e,11)}else if((t.C||e.a==t)&&si(e),!O(n))for(n=i=e.ka.a.parse(n),i=0;i<n.length;i++)if(r=n[i],e.P=r[0],r=r[1],2==e.v)if("c"==r[0]){e.J=r[1],e.ga=r[2];var a=r[3];null!=a&&(e.ha=a,e.c.info("VER="+e.ha));var o=r[4];null!=o&&(e.pa=o,e.c.info("SVER="+e.pa));var s=r[5];if(null!=s&&"number"==typeof s&&0<s){var h=1.5*s;e.D=h,e.c.info("backChannelRequestTimeoutMs_="+h)}h=e;var l=t.a;if(l){var u=l.a?l.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(u){var c=h.b;!c.a&&(R(u,"spdy")||R(u,"quic")||R(u,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(Se(c,c.b),c.b=null))}if(h.A){var f=l.a?l.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(h.na=f,Zn(h.B,h.A,f))}}e.v=3,e.f&&e.f.ta(),e.U&&(e.N=b()-t.u,e.c.info("Handshake RTT: "+e.N+"ms"));var p=t;if((h=e).la=fi(h,h.C?h.ga:null,h.fa),p.C){Ce(h.b,p);var v=p,g=h.D;g&&v.setTimeout(g),v.o&&(Xn(v),Ln(v)),h.a=p}else ii(h);0<e.g.length&&Ze(e)}else"stop"!=r[0]&&"close"!=r[0]||ui(e,7);else 3==e.v&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?ui(e,7):Ve(e):"noop"!=r[0]&&e.f&&e.f.sa(r),e.o=0);un(4)}catch(d){}}function Nn(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(l(t)){for(var n=[],e=t.length,i=0;i<e;i++)n.push(t[i]);return n}for(i in n=[],e=0,t)n[e++]=t[i];return n}function Un(t,n){if(t.forEach&&"function"==typeof t.forEach)t.forEach(n,void 0);else if(l(t)||"string"==typeof t)S(t,n,void 0);else{if(t.L&&"function"==typeof t.L)var e=t.L();else if(t.K&&"function"==typeof t.K)e=void 0;else if(l(t)||"string"==typeof t){e=[];for(var i=t.length,r=0;r<i;r++)e.push(r)}else for(r in e=[],i=0,t)e[i++]=r;r=(i=Nn(t)).length;for(var a=0;a<r;a++)n.call(void 0,i[a],e&&e[a],t)}}function Bn(t,n){this.b={},this.a=[],this.c=0;var e=arguments.length;if(1<e){if(e%2)throw Error("Uneven number of arguments");for(var i=0;i<e;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Bn)for(e=t.L(),i=0;i<e.length;i++)this.set(e[i],t.get(e[i]));else for(i in t)this.set(i,t[i])}function Fn(t){if(t.c!=t.a.length){for(var n=0,e=0;n<t.a.length;){var i=t.a[n];Kn(t.b,i)&&(t.a[e++]=i),n++}t.a.length=e}if(t.c!=t.a.length){var r={};for(e=n=0;n<t.a.length;)Kn(r,i=t.a[n])||(t.a[e++]=i,r[i]=1),n++;t.a.length=e}}function Kn(t,n){return Object.prototype.hasOwnProperty.call(t,n)}(r=xn.prototype).setTimeout=function(t){this.P=t},r.Xa=function(t){t=t.target;var n=this.F;n&&3==Ke(t)?n.f():this.Ca(t)},r.Ca=function(t){try{if(t==this.a)t:{var n=Ke(this.a),e=this.a.ua(),i=this.a.W();if(!(3>n||3==n&&!Y&&!this.a.$())){this.A||4!=n||7==e||un(8==e||0>=i?3:2),Xn(this);var r=this.a.W();this.N=r;var a=this.a.$();if(this.b=200==r,nn(this.c,this.m,this.l,this.f,this.S,n,r),this.b){if(this.U&&!this.C){n:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(o)){var h=o;break n}}h=null}if(!h){this.b=!1,this.h=3,fn(12),Dn(this),kn(this);break t}en(this.c,this.f,h,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Hn(this,h)}this.I?(jn(this,n,a),Y&&this.b&&3==n&&(zt(this.J,this.R,"tick",this.Wa),this.R.start())):(en(this.c,this.f,a,null),Hn(this,a)),4==n&&Dn(this),this.b&&!this.A&&(4==n?hi(this.g,this):(this.b=!1,Ln(this)))}else 400==r&&0<a.indexOf("Unknown SID")?(this.h=3,fn(12)):(this.h=0,fn(13)),Dn(this),kn(this)}}}catch(l){}},r.Wa=function(){if(this.a){var t=Ke(this.a),n=this.a.$();this.D<n.length&&(Xn(this),jn(this,t,n),this.b&&4!=t&&Ln(this))}},r.cancel=function(){this.A=!0,Dn(this)},r.Va=function(){this.o=null;var t=b();0<=t-this.T?(rn(this.c,this.l),2!=this.H&&(un(3),fn(17)),Dn(this),this.h=2,kn(this)):_n(this,this.T-t)},(r=Bn.prototype).K=function(){Fn(this);for(var t=[],n=0;n<this.a.length;n++)t.push(this.b[this.a[n]]);return t},r.L=function(){return Fn(this),this.a.concat()},r.get=function(t,n){return Kn(this.b,t)?this.b[t]:n},r.set=function(t,n){Kn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=n},r.forEach=function(t,n){for(var e=this.L(),i=0;i<e.length;i++){var r=e[i],a=this.get(r);t.call(n,a,r,this)}};var Yn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Wn(t,n){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var i=t[e].indexOf("="),r=null;if(0<=i){var a=t[e].substring(0,i);r=t[e].substring(i+1)}else a=t[e];n(a,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function Gn(t,n){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Gn){this.a=void 0!==n?n:t.a,Vn(this,t.f),this.j=t.j,qn(this,t.c),$n(this,t.h),this.g=t.g,n=t.b;var e=new ue;e.c=n.c,n.a&&(e.a=new Bn(n.a),e.b=n.b),zn(this,e),this.i=t.i}else t&&(e=String(t).match(Yn))?(this.a=!!n,Vn(this,e[1]||"",!0),this.j=ee(e[2]||""),qn(this,e[3]||"",!0),$n(this,e[4]),this.g=ee(e[5]||"",!0),zn(this,e[6]||"",!0),this.i=ee(e[7]||"")):(this.a=!!n,this.b=new ue(null,this.a))}function Jn(t){return new Gn(t)}function Vn(t,n,e){t.f=e?ee(n,!0):n,t.f&&(t.f=t.f.replace(/:$/,""))}function qn(t,n,e){t.c=e?ee(n,!0):n}function $n(t,n){if(n){if(n=Number(n),isNaN(n)||0>n)throw Error("Bad port number "+n);t.h=n}else t.h=null}function zn(t,n,e){n instanceof ue?(t.b=n,ye(t.b,t.a)):(e||(n=ie(n,he)),t.b=new ue(n,t.a))}function Zn(t,n,e){t.b.set(n,e)}function Qn(t){return Zn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^b()).toString(36)),t}function te(t){return t instanceof Gn?Jn(t):new Gn(t,void 0)}function ne(t,n,e,i){var r=new Gn(null,void 0);return t&&Vn(r,t),n&&qn(r,n),e&&$n(r,e),i&&(r.g=i),r}function ee(t,n){return t?n?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ie(t,n,e){return"string"==typeof t?(t=encodeURI(t).replace(n,re),e&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function re(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Gn.prototype.toString=function(){var t=[],n=this.f;n&&t.push(ie(n,ae,!0),":");var e=this.c;return(e||"file"==n)&&(t.push("//"),(n=this.j)&&t.push(ie(n,ae,!0),"@"),t.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.h)&&t.push(":",String(e))),(e=this.g)&&(this.c&&"/"!=e.charAt(0)&&t.push("/"),t.push(ie(e,"/"==e.charAt(0)?se:oe,!0))),(e=this.b.toString())&&t.push("?",e),(e=this.i)&&t.push("#",ie(e,le)),t.join("")};var ae=/[#\/\?@]/g,oe=/[#\?:]/g,se=/[#\?]/g,he=/[#\?@]/g,le=/#/g;function ue(t,n){this.b=this.a=null,this.c=t||null,this.f=!!n}function ce(t){t.a||(t.a=new Bn,t.b=0,t.c&&Wn(t.c,function(n,e){t.add(decodeURIComponent(n.replace(/\+/g," ")),e)}))}function fe(t,n){ce(t),n=ge(t,n),Kn(t.a.b,n)&&(t.c=null,t.b-=t.a.get(n).length,Kn((t=t.a).b,n)&&(delete t.b[n],t.c--,t.a.length>2*t.c&&Fn(t)))}function pe(t,n){return ce(t),n=ge(t,n),Kn(t.a.b,n)}function ve(t,n,e){fe(t,n),0<e.length&&(t.c=null,t.a.set(ge(t,n),I(e)),t.b+=e.length)}function ge(t,n){return n=String(n),t.f&&(n=n.toLowerCase()),n}function ye(t,n){n&&!t.f&&(ce(t),t.c=null,t.a.forEach(function(t,n){var e=n.toLowerCase();n!=e&&(fe(this,n),ve(this,e,t))},t)),t.f=n}(r=ue.prototype).add=function(t,n){ce(this),this.c=null,t=ge(this,t);var e=this.a.get(t);return e||this.a.set(t,e=[]),e.push(n),this.b+=1,this},r.forEach=function(t,n){ce(this),this.a.forEach(function(e,i){S(e,function(e){t.call(n,e,i,this)},this)},this)},r.L=function(){ce(this);for(var t=this.a.K(),n=this.a.L(),e=[],i=0;i<n.length;i++)for(var r=t[i],a=0;a<r.length;a++)e.push(n[i]);return e},r.K=function(t){ce(this);var n=[];if("string"==typeof t)pe(this,t)&&(n=x(n,this.a.get(ge(this,t))));else{t=this.a.K();for(var e=0;e<t.length;e++)n=x(n,t[e])}return n},r.set=function(t,n){return ce(this),this.c=null,pe(this,t=ge(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[n]),this.b+=1,this},r.get=function(t,n){return t&&0<(t=this.K(t)).length?String(t[0]):n},r.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],n=this.a.L(),e=0;e<n.length;e++){var i=n[e],r=encodeURIComponent(String(i));i=this.K(i);for(var a=0;a<i.length;a++){var o=r;""!==i[a]&&(o+="="+encodeURIComponent(String(i[a]))),t.push(o)}}return this.c=t.join("&")};var de=function(){return function(t,n){this.b=t,this.a=n}}();function be(t){this.g=t||me,s.PerformanceNavigationTiming?t=0<(t=s.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(s.ia&&s.ia.ya&&s.ia.ya()&&s.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var me=10;function we(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Te(t){return t.b?1:t.a?t.a.size:0}function Ee(t,n){return t.b?t.b==n:!!t.a&&t.a.has(n)}function Se(t,n){t.a?t.a.add(n):t.b=n}function Ce(t,n){t.b&&t.b==n?t.b=null:t.a&&t.a.has(n)&&t.a.delete(n)}function xe(t){var n,e;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var a=i(t.a.values()),o=a.next();!o.done;o=a.next()){var s=o.value;r=r.concat(s.s)}}catch(h){n={error:h}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(n)throw n.error}}return r}return I(t.c)}function Ie(){}function Oe(){this.a=new Ie}function Pe(t,n,e){var i=e||"";try{Un(t,function(t,e){var r=t;u(t)&&(r=Mt(t)),n.push(i+e+"="+encodeURIComponent(r))})}catch(r){throw n.push(i+"type="+encodeURIComponent("_badmap")),r}}function Ae(t,n){var e=new Qt;if(s.Image){var i=new Image;i.onload=d(Re,e,i,"TestLoadImage: loaded",!0,n),i.onerror=d(Re,e,i,"TestLoadImage: error",!1,n),i.onabort=d(Re,e,i,"TestLoadImage: abort",!1,n),i.ontimeout=d(Re,e,i,"TestLoadImage: timeout",!1,n),s.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else n(!1)}function Re(t,n,e,i,r){try{n.onload=null,n.onerror=null,n.onabort=null,n.ontimeout=null,r(i)}catch(a){}}be.prototype.cancel=function(){var t,n;if(this.c=xe(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var e=i(this.a.values()),r=e.next();!r.done;r=e.next()){r.value.cancel()}}catch(a){t={error:a}}finally{try{r&&!r.done&&(n=e.return)&&n.call(e)}finally{if(t)throw t.error}}this.a.clear()}},Ie.prototype.stringify=function(t){return s.JSON.stringify(t,void 0)},Ie.prototype.parse=function(t){return s.JSON.parse(t,void 0)};var je=s.JSON.parse;function Me(t){At.call(this),this.headers=new Bn,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Le,this.D=this.F=!1}m(Me,At);var Le="",_e=/^https?$/i,Xe=["POST","PUT"];function ke(t){return F&&Q(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function De(t){return"content-type"==t.toLowerCase()}function He(t,n){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=n,t.h=5,Ne(t),Be(t)}function Ne(t){t.u||(t.u=!0,Rt(t,"complete"),Rt(t,"error"))}function Ue(t){if(t.b&&void 0!==o&&(!t.s[1]||4!=Ke(t)||2!=t.W()))if(t.l&&4==Ke(t))Gt(t.za,0,t);else if(Rt(t,"readystatechange"),4==Ke(t)){t.b=!1;try{var n,e=t.W();t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(n=i)){var r;if(r=0===e){var a=String(t.B).match(Yn)[1]||null;if(!a&&s.self&&s.self.location){var h=s.self.location.protocol;a=h.substr(0,h.length-1)}r=!_e.test(a?a.toLowerCase():"")}n=r}if(n)Rt(t,"complete"),Rt(t,"success");else{t.h=6;try{var l=2<Ke(t)?t.a.statusText:""}catch(e){l=""}t.f=l+" ["+t.W()+"]",Ne(t)}}finally{Be(t)}}}function Be(t,n){if(t.a){Fe(t);var e=t.a,i=t.s[0]?h:null;t.a=null,t.s=null,n||Rt(t,"ready");try{e.onreadystatechange=i}catch(r){}}}function Fe(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(s.clearTimeout(t.m),t.m=null)}function Ke(t){return t.a?t.a.readyState:0}function Ye(t){var n="";return _(t,function(t,e){n+=e,n+=":",n+=t,n+="\r\n"}),n}function We(t,n,e){t:{for(i in e){var i=!1;break t}i=!0}i||(e=Ye(e),"string"==typeof t?null!=e&&encodeURIComponent(String(e)):Zn(t,n,e))}function Ge(t,n,e){return e&&e.internalChannelParams&&e.internalChannelParams[t]||n}function Je(t){this.pa=0,this.g=[],this.c=new Qt,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Ge("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Ge("baseRetryDelayMs",5e3,t),this.Ra=Ge("retryDelaySeedMs",1e4,t),this.Ma=Ge("forwardChannelMaxRetries",2,t),this.ma=Ge("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new be(t&&t.concurrentRequestLimit),this.ka=new Oe,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Ve(t){if($e(t),3==t.v){var n=t.R++,e=Jn(t.B);Zn(e,"SID",t.J),Zn(e,"RID",n),Zn(e,"TYPE","terminate"),ni(t,e),(n=new xn(t,t.c,n,void 0)).H=2,n.i=Qn(Jn(e)),e=!1,s.navigator&&s.navigator.sendBeacon&&(e=s.navigator.sendBeacon(n.i.toString(),"")),!e&&s.Image&&((new Image).src=n.i,e=!0),e||(n.a=pi(n.g,null),n.a.ba(n.i)),n.u=b(),Ln(n)}ci(t)}function qe(t){t.a&&(ai(t),t.a.cancel(),t.a=null)}function $e(t){qe(t),t.j&&(s.clearTimeout(t.j),t.j=null),si(t),t.b.cancel(),t.h&&("number"==typeof t.h&&s.clearTimeout(t.h),t.h=null)}function ze(t,n){t.g.push(new de(t.Oa++,n)),3==t.v&&Ze(t)}function Ze(t){we(t.b)||t.h||(t.h=!0,Nt(t.Ba,t),t.u=0)}function Qe(t,n){return!(Te(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.g=n.s.concat(t.g),!0):!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma))&&(t.h=vn(y(t.Ba,t,n),li(t,t.u)),t.u++,!0))}function ti(t,n){var e;e=n?n.f:t.R++;var i=Jn(t.B);Zn(i,"SID",t.J),Zn(i,"RID",e),Zn(i,"AID",t.P),ni(t,i),t.i&&t.l&&We(i,t.i,t.l),e=new xn(t,t.c,e,t.u+1),null===t.i&&(e.B=t.l),n&&(t.g=n.s.concat(t.g)),n=ei(t,e,1e3),e.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Se(t.b,e),An(e,i,n)}function ni(t,n){t.f&&Un({},function(t,e){Zn(n,e,t)})}function ei(t,n,e){e=Math.min(t.g.length,e);var i=t.f?y(t.f.Ja,t.f,t):null;t:for(var r=t.g,a=-1;;){var o=["count="+e];-1==a?0<e?(a=r[0].b,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,h=0;h<e;h++){var l=r[h].b,u=r[h].a;if(0>(l-=a))a=Math.max(0,r[h].b-100),s=!1;else try{Pe(u,o,"req"+l+"_")}catch(c){i&&i(u)}}if(s){i=o.join("&");break t}}return t=t.g.splice(0,e),n.s=t,i}function ii(t){t.a||t.j||(t.T=1,Nt(t.Aa,t),t.o=0)}function ri(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=vn(y(t.Aa,t),li(t,t.o)),t.o++,!0)}function ai(t){null!=t.s&&(s.clearTimeout(t.s),t.s=null)}function oi(t){t.a=new xn(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var n=Jn(t.la);Zn(n,"RID","rpc"),Zn(n,"SID",t.J),Zn(n,"CI",t.H?"0":"1"),Zn(n,"AID",t.P),ni(t,n),Zn(n,"TYPE","xmlhttp"),t.i&&t.l&&We(n,t.i,t.l),t.D&&t.a.setTimeout(t.D);var e=t.a;t=t.ga,e.H=1,e.i=Qn(Jn(n)),e.j=null,e.I=!0,Rn(e,t)}function si(t){null!=t.m&&(s.clearTimeout(t.m),t.m=null)}function hi(t,n){var e=null;if(t.a==n){si(t),ai(t),t.a=null;var i=2}else{if(!Ee(t.b,n))return;e=n.s,Ce(t.b,n),i=1}if(t.I=n.N,0!=t.v)if(n.b)if(1==i){e=n.j?n.j.length:0,n=b()-n.u;var r=t.u;Rt(i=hn(),new pn(i,e,n,r)),Ze(t)}else ii(t);else if(3==(r=n.h)||0==r&&0<t.I||!(1==i&&Qe(t,n)||2==i&&ri(t)))switch(e&&0<e.length&&(n=t.b,n.c=n.c.concat(e)),r){case 1:ui(t,5);break;case 4:ui(t,10);break;case 3:ui(t,6);break;default:ui(t,2)}}function li(t,n){var e=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(e*=2),e*n}function ui(t,n){if(t.c.info("Error code "+n),2==n){var e=null;t.f&&(e=null);var i=y(t.Ya,t);e||(e=new Gn("//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||Vn(e,"https"),Qn(e)),Ae(e.toString(),i)}else fn(2);t.v=0,t.f&&t.f.ra(n),ci(t),$e(t)}function ci(t){t.v=0,t.I=-1,t.f&&(0==xe(t.b).length&&0==t.g.length||(t.b.c.length=0,I(t.g),t.g.length=0),t.f.qa())}function fi(t,n,e){var i=te(e);if(""!=i.c)n&&qn(i,n+"."+i.c),$n(i,i.h);else{var r=s.location;i=ne(r.protocol,n?n+"."+r.hostname:r.hostname,+r.port,e)}return t.V&&_(t.V,function(t,n){Zn(i,n,t)}),n=t.A,e=t.na,n&&e&&Zn(i,n,e),Zn(i,"VER",t.ha),ni(t,i),i}function pi(t,n){if(n&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(n=new Me(t.Na)).F=t.C,n}function vi(){}function gi(){if(F&&!(10<=Number(nt)))throw Error("Environmental error: no available transport.")}function yi(t,n){At.call(this),this.a=new Je(n),this.o=t,this.b=n&&n.messageUrlParams||null,t=n&&n.messageHeaders||null,n&&n.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=n&&n.initMessageHeaders||null,n&&n.messageContentType&&(t?t["X-WebChannel-Content-Type"]=n.messageContentType:t={"X-WebChannel-Content-Type":n.messageContentType}),n&&n.a&&(t?t["X-WebChannel-Client-Profile"]=n.a:t={"X-WebChannel-Client-Profile":n.a}),this.a.O=t,(t=n&&n.httpHeadersOverwriteParam)&&!O(t)&&(this.a.i=t),this.m=n&&n.supportsCrossDomainXhr||!1,this.l=n&&n.sendRawJson||!1,(n=n&&n.httpSessionIdParam)&&!O(n)&&(this.a.A=n,null!==(t=this.b)&&n in t&&(n in(t=this.b)&&delete t[n])),this.f=new mi(this)}function di(t){En.call(this);var n=t.__sm__;if(n){t:{for(var e in n){t=e;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==n&&t in n?n[t]:void 0):this.data=n}else this.data=t}function bi(){Sn.call(this),this.status=1}function mi(t){this.a=t}(r=Me.prototype).ba=function(t,n,e,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);n=n?n.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?bn(this.H):bn(wn),this.a.onreadystatechange=y(this.za,this);try{this.A=!0,this.a.open(n,String(t),!0),this.A=!1}catch(a){return void He(this,a)}t=e||"";var r=new Bn(this.headers);i&&Un(i,function(t,n){r.set(n,t)}),i=C(r.L()),e=s.FormData&&t instanceof s.FormData,!(0<=E(Xe,n))||i||e||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach(function(t,n){this.a.setRequestHeader(n,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fe(this),0<this.o&&((this.D=ke(this.a))?(this.a.timeout=this.o,this.a.ontimeout=y(this.xa,this)):this.m=Gt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(a){He(this,a)}},r.xa=function(){void 0!==o&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Rt(this,"timeout"),this.abort(8))},r.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Rt(this,"complete"),Rt(this,"abort"),Be(this))},r.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Be(this,!0)),Me.X.G.call(this)},r.za=function(){this.j||(this.A||this.l||this.g?Ue(this):this.Ua())},r.Ua=function(){Ue(this)},r.W=function(){try{return 2<Ke(this)?this.a.status:-1}catch(t){return-1}},r.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},r.Pa=function(t){if(this.a){var n=this.a.responseText;return t&&0==n.indexOf(t)&&(n=n.substring(t.length)),je(n)}},r.ua=function(){return this.h},r.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(r=Je.prototype).ha=8,r.v=1,r.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var n,e=new xn(this,this.c,t,void 0),i=this.l;if(this.O&&(i?D(i=X(i),this.O):i=this.O),null===this.i&&(e.B=i),this.da)t:{for(var r=n=0;r<this.g.length;r++){var a=this.g[r];if(void 0===(a="__data__"in a.a&&"string"==typeof(a=a.a.__data__)?a.length:void 0))break;if(4096<(n+=a)){n=r;break t}if(4096===n||r===this.g.length-1){n=r+1;break t}}n=1e3}else n=1e3;n=ei(this,e,n),Zn(r=Jn(this.B),"RID",t),Zn(r,"CVER",22),this.A&&Zn(r,"X-HTTP-Session-Id",this.A),ni(this,r),this.i&&i&&We(r,this.i,i),Se(this.b,e),this.Ia&&Zn(r,"TYPE","init"),this.da?(Zn(r,"$req",n),Zn(r,"SID","null"),e.U=!0,An(e,r,null)):An(e,r,n),this.v=2}}else 3==this.v&&(t?ti(this,t):0==this.g.length||we(this.b)||ti(this))},r.Aa=function(){if(this.j=null,oi(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=vn(y(this.Ta,this),t)}},r.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,fn(10),qe(this),oi(this))},r.Sa=function(){null!=this.m&&(this.m=null,qe(this),ri(this),fn(19))},r.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),fn(2)):(this.c.info("Failed to ping google.com"),fn(1))},(r=vi.prototype).ta=function(){},r.sa=function(){},r.ra=function(){},r.qa=function(){},r.Ja=function(){},gi.prototype.a=function(t,n){return new yi(t,n)},m(yi,At),yi.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,n=this.o,e=this.b||void 0;fn(0),t.fa=n,t.V=e||{},t.H=t.S,t.B=fi(t,null,t.fa),Ze(t)},yi.prototype.close=function(){Ve(this.a)},yi.prototype.h=function(t){if("string"==typeof t){var n={};n.__data__=t,ze(this.a,n)}else this.l?((n={}).__data__=Mt(t),ze(this.a,n)):ze(this.a,t)},yi.prototype.G=function(){this.a.f=null,delete this.f,Ve(this.a),delete this.a,yi.X.G.call(this)},m(di,En),m(bi,Sn),m(mi,vi),mi.prototype.ta=function(){Rt(this.a,"a")},mi.prototype.sa=function(t){Rt(this.a,new di(t))},mi.prototype.ra=function(t){Rt(this.a,new bi(t))},mi.prototype.qa=function(){Rt(this.a,"b")},gi.prototype.createWebChannel=gi.prototype.a,yi.prototype.send=yi.prototype.h,yi.prototype.open=yi.prototype.g,yi.prototype.close=yi.prototype.close,gn.NO_ERROR=0,gn.TIMEOUT=8,gn.HTTP_ERROR=6,yn.COMPLETE="complete",mn.EventType=Tn,Tn.OPEN="a",Tn.CLOSE="b",Tn.ERROR="c",Tn.MESSAGE="d",At.prototype.listen=At.prototype.va,Me.prototype.listenOnce=Me.prototype.wa,Me.prototype.getLastError=Me.prototype.Qa,Me.prototype.getLastErrorCode=Me.prototype.ua,Me.prototype.getStatus=Me.prototype.W,Me.prototype.getResponseJson=Me.prototype.Pa,Me.prototype.getResponseText=Me.prototype.$,Me.prototype.send=Me.prototype.ba;var wi=function(){return new gi};exports.createWebChannelTransport=wi;var Ti=function(){return hn()};exports.getStatEventTarget=Ti;var Ei=gn;exports.ErrorCode=Ei;var Si=yn;exports.EventType=Si;var Ci=on;exports.Event=Ci;var xi={gb:0,jb:1,kb:2,Db:3,Ib:4,Fb:5,Gb:6,Eb:7,Cb:8,Hb:9,PROXY:10,NOPROXY:11,Ab:12,wb:13,xb:14,vb:15,yb:16,zb:17,bb:18,ab:19,cb:20};exports.Stat=xi;var Ii=mn;exports.WebChannel=Ii;var Oi=Me;exports.XhrIo=Oi;var Pi={createWebChannelTransport:wi,getStatEventTarget:Ti,ErrorCode:Ei,EventType:Si,Event:Ci,Stat:xi,WebChannel:Ii,XhrIo:Oi},Ai=Pi;exports.default=Ai;
},{}],"NG2Q":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"A6C1":[function(require,module,exports) {
var process = require("process");
var t=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.__PRIVATE_registerFirestore=vc;var e=require("tslib"),n=s(require("@firebase/app")),r=require("@firebase/logger"),i=require("@firebase/util"),o=require("@firebase/webchannel-wrapper"),u=require("@firebase/component");function s(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},h=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),f=function(){function t(t){this.uid=t}return t.prototype.u=function(){return null!=this.uid},t.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();f.UNAUTHENTICATED=new f(null),f.l=new f("google-credentials-uid"),f._=new f("first-party-uid");var l=new r.Logger("@firebase/firestore");function p(){return l.logLevel}function d(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(l.logLevel<=r.LogLevel.DEBUG){var o=n.map(g);l.debug.apply(l,(0,e.__spreadArrays)(["Firestore (8.1.1): "+t],o))}}function v(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(l.logLevel<=r.LogLevel.ERROR){var o=n.map(g);l.error.apply(l,(0,e.__spreadArrays)(["Firestore (8.1.1): "+t],o))}}function y(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(l.logLevel<=r.LogLevel.WARN){var o=n.map(g);l.warn.apply(l,(0,e.__spreadArrays)(["Firestore (8.1.1): "+t],o))}}function g(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function m(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.1.1) INTERNAL ASSERTION FAILED: "+t;throw v(e),new Error(e)}function _(t,e){t||m()}function w(t,e){return t}var b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},I=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return(0,e.__extends)(n,t),n}(Error),E=function(t,e){this.user=e,this.type="OAuth",this.T={},this.T.Authorization="Bearer "+t},T=function(){function t(){this.I=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.m=function(){},t.prototype.A=function(t){this.I=t,t(f.UNAUTHENTICATED)},t.prototype.R=function(){this.I=null},t}(),N=function(){function t(t){var e=this;this.P=null,this.currentUser=f.UNAUTHENTICATED,this.g=!1,this.V=0,this.I=null,this.forceRefresh=!1,this.P=function(){e.V++,e.currentUser=e.p(),e.g=!0,e.I&&e.I(e.currentUser)},this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.V,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.V!==e?(d("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(_("string"==typeof n.accessToken),new E(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.m=function(){this.forceRefresh=!0},t.prototype.A=function(t){this.I=t,this.g&&t(this.currentUser)},t.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.I=null},t.prototype.p=function(){var t=this.auth&&this.auth.getUid();return _(null===t||"string"==typeof t),new f(t)},t}(),A=function(){function t(t,e){this.v=t,this.S=e,this.type="FirstParty",this.user=f._}return Object.defineProperty(t.prototype,"T",{get:function(){var t={"X-Goog-AuthUser":this.S},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),x=function(){function t(t,e){this.v=t,this.S=e}return t.prototype.getToken=function(){return Promise.resolve(new A(this.v,this.S))},t.prototype.A=function(t){t(f._)},t.prototype.R=function(){},t.prototype.m=function(){},t}();function D(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var k=function(){function t(){}return t.D=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=D(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function O(t,e){return t<e?-1:t>e?1:0}function S(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function P(t){return t+"\0"}var C=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new I(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new I(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new I(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new I(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.C=function(t){return this.seconds===t.seconds?O(this.nanoseconds,t.nanoseconds):O(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),R=function(){function t(t){this.timestamp=t}return t.N=function(e){return new t(e)},t.min=function(){return new t(new C(0,0))},t.prototype.F=function(t){return this.timestamp.C(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.M=function(){return this.timestamp},t}(),V=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&m(),void 0===n?n=t.length-e:n>t.length-e&&m(),this.segments=t,this.offset=e,this.k=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.$(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.L(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.B=function(t){return t=void 0===t?1:t,this.L(this.segments,this.offset+t,this.length-t)},t.prototype.q=function(){return this.L(this.segments,this.offset,this.length-1)},t.prototype.U=function(){return this.segments[this.offset]},t.prototype.K=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.W=function(){return 0===this.length},t.prototype.j=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.G=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},t.$=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),L=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype.L=function(t,e,r){return new n(t,e,r)},n.prototype.J=function(){return this.H().join("/")},n.prototype.toString=function(){return this.J()},n.Y=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=[],i=0,o=t;i<o.length;i++){var u=o[i];if(u.indexOf("//")>=0)throw new I(b.INVALID_ARGUMENT,"Invalid segment ("+u+"). Paths must not contain // in them.");r.push.apply(r,u.split("/").filter(function(t){return t.length>0}))}return new n(r)},n.X=function(){return new n([])},n}(V),U=/^[_a-zA-Z][_a-zA-Z0-9]*$/,q=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype.L=function(t,e,r){return new n(t,e,r)},n.Z=function(t){return U.test(t)},n.prototype.J=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),n.Z(t)||(t="`"+t+"`"),t}).join(".")},n.prototype.toString=function(){return this.J()},n.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},n.et=function(){return new n(["__name__"])},n.nt=function(t){for(var e=[],r="",i=0,o=function(){if(0===r.length)throw new I(b.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(r),r=""},u=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new I(b.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new I(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===s?(u=!u,i++):"."!==s||u?(r+=s,i++):(o(),i++)}if(o(),u)throw new I(b.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new n(e)},n.X=function(){return new n([])},n}(V),M=function(){function t(t){this.path=t}return t.st=function(e){return new t(L.Y(e))},t.it=function(e){return new t(L.Y(e).B(5))},t.prototype.rt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===L.$(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.$=function(t,e){return L.$(t.path,e.path)},t.ot=function(t){return t.length%2==0},t.ct=function(e){return new t(new L(e.slice()))},t}();function j(t){return null==t}function F(t){return 0===t&&1/t==-1/0}function z(t){return"number"==typeof t&&Number.isInteger(t)&&!F(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var B=function(t,e,n,r,i,o,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=u,this.ut=null};function G(t,e,n,r,i,o,u){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),new B(t,e,n,r,i,o,u)}function K(t){var e=w(t);if(null===e.ut){var n=e.path.J();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.J()+t.op.toString()+jt(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.J()+t.dir}(t)}).join(","),j(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Bn(e.startAt)),e.endAt&&(n+="|ub:",n+=Bn(e.endAt)),e.ut=n}return e.ut}function W(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Hn(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Lt(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Kn(t.startAt,e.startAt)&&Kn(t.endAt,e.endAt)}function Q(t){return M.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var H=function(){function t(t){this.at=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.at,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},t.prototype.ht=function(){return 2*this.at.length},t.prototype.F=function(t){return O(this.at,t.at)},t.prototype.isEqual=function(t){return this.at===t.at},t}();H.lt=new H("");var Y,$,J=function(){function t(t,e,n,r,i,o,u){void 0===i&&(i=R.min()),void 0===o&&(o=R.min()),void 0===u&&(u=H.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u}return t.prototype.dt=function(e){return new t(this.target,this.targetId,this._t,e,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.wt=function(e,n){return new t(this.target,this.targetId,this._t,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Et=function(e){return new t(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,e,this.resumeToken)},t}(),X=function(t){this.count=t};function Z(t){switch(t){case b.OK:return m();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0;default:return m()}}function tt(t){if(void 0===t)return v("GRPC error has no .code"),b.UNKNOWN;switch(t){case Y.OK:return b.OK;case Y.CANCELLED:return b.CANCELLED;case Y.UNKNOWN:return b.UNKNOWN;case Y.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Y.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Y.INTERNAL:return b.INTERNAL;case Y.UNAVAILABLE:return b.UNAVAILABLE;case Y.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Y.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Y.NOT_FOUND:return b.NOT_FOUND;case Y.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Y.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Y.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Y.ABORTED:return b.ABORTED;case Y.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Y.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Y.DATA_LOSS:return b.DATA_LOSS;default:return m()}}($=Y||(Y={}))[$.OK=0]="OK",$[$.CANCELLED=1]="CANCELLED",$[$.UNKNOWN=2]="UNKNOWN",$[$.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$[$.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$[$.NOT_FOUND=5]="NOT_FOUND",$[$.ALREADY_EXISTS=6]="ALREADY_EXISTS",$[$.PERMISSION_DENIED=7]="PERMISSION_DENIED",$[$.UNAUTHENTICATED=16]="UNAUTHENTICATED",$[$.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$[$.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$[$.ABORTED=10]="ABORTED",$[$.OUT_OF_RANGE=11]="OUT_OF_RANGE",$[$.UNIMPLEMENTED=12]="UNIMPLEMENTED",$[$.INTERNAL=13]="INTERNAL",$[$.UNAVAILABLE=14]="UNAVAILABLE",$[$.DATA_LOSS=15]="DATA_LOSS";var et=function(){function t(t,e){this.$=t,this.root=e||rt.EMPTY}return t.prototype.Tt=function(e,n){return new t(this.$,this.root.Tt(e,n,this.$).copy(null,null,rt.It,null,null))},t.prototype.remove=function(e){return new t(this.$,this.root.remove(e,this.$).copy(null,null,rt.It,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.$(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.W=function(){return this.root.W()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.At=function(){return this.root.At()},t.prototype.Rt=function(){return this.root.Rt()},t.prototype.Pt=function(t){return this.root.Pt(t)},t.prototype.forEach=function(t){this.Pt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Pt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.gt=function(t){return this.root.gt(t)},t.prototype.yt=function(){return new nt(this.root,null,this.$,!1)},t.prototype.Vt=function(t){return new nt(this.root,t,this.$,!1)},t.prototype.vt=function(){return new nt(this.root,null,this.$,!0)},t.prototype.bt=function(t){return new nt(this.root,t,this.$,!0)},t}(),nt=function(){function t(t,e,n,r){this.St=r,this.Dt=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}return t.prototype.Ct=function(){var t=this.Dt.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.W();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.W();)this.Dt.push(t),t=t.left;return e},t.prototype.Nt=function(){return this.Dt.length>0},t.prototype.xt=function(){if(0===this.Dt.length)return null;var t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}},t}(),rt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.W=function(){return!1},t.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},t.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},t.prototype.min=function(){return this.left.W()?this:this.left.min()},t.prototype.At=function(){return this.min().key},t.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},t.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},t.prototype.Ot=function(){if(this.left.W())return t.EMPTY;var e=this;return e.left.Mt()||e.left.left.Mt()||(e=e.kt()),(e=e.copy(null,null,null,e.left.Ot(),null)).Ft()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.W()||i.left.Mt()||i.left.left.Mt()||(i=i.kt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Mt()&&(i=i.$t()),i.right.W()||i.right.Mt()||i.right.left.Mt()||(i=i.Lt()),0===n(e,i.key)){if(i.right.W())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Ot())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Ft()},t.prototype.Mt=function(){return this.color},t.prototype.Ft=function(){var t=this;return t.right.Mt()&&!t.left.Mt()&&(t=t.Bt()),t.left.Mt()&&t.left.left.Mt()&&(t=t.$t()),t.left.Mt()&&t.right.Mt()&&(t=t.qt()),t},t.prototype.kt=function(){var t=this.qt();return t.right.left.Mt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t},t.prototype.Lt=function(){var t=this.qt();return t.left.left.Mt()&&(t=(t=t.$t()).qt()),t},t.prototype.Bt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.$t=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ut=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},t.prototype.Qt=function(){if(this.Mt()&&this.left.Mt())throw m();if(this.right.Mt())throw m();var t=this.left.Qt();if(t!==this.right.Qt())throw m();return t+(this.Mt()?0:1)},t}();rt.EMPTY=null,rt.RED=!0,rt.It=!1,rt.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw m()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Tt=function(t,e,n){return new rt(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.W=function(){return!0},t.prototype.Pt=function(t){return!1},t.prototype.gt=function(t){return!1},t.prototype.At=function(){return null},t.prototype.Rt=function(){return null},t.prototype.Mt=function(){return!1},t.prototype.Ut=function(){return!0},t.prototype.Qt=function(){return 0},t}());var it=function(){function t(t){this.$=t,this.data=new et(this.$)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.At()},t.prototype.last=function(){return this.data.Rt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Pt(function(e,n){return t(e),!1})},t.prototype.Kt=function(t,e){for(var n=this.data.Vt(t[0]);n.Nt();){var r=n.Ct();if(this.$(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Wt=function(t,e){var n;for(n=void 0!==e?this.data.Vt(e):this.data.yt();n.Nt();)if(!t(n.Ct().key))return},t.prototype.jt=function(t){var e=this.data.Vt(t);return e.Nt()?e.Ct().key:null},t.prototype.yt=function(){return new ot(this.data.yt())},t.prototype.Vt=function(t){return new ot(this.data.Vt(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.W=function(){return this.data.W()},t.prototype.Gt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.yt(),r=e.data.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(0!==this.$(i,o))return!1}return!0},t.prototype.H=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.$);return n.data=e,n},t}(),ot=function(){function t(t){this.zt=t}return t.prototype.Ct=function(){return this.zt.Ct().key},t.prototype.Nt=function(){return this.zt.Nt()},t}(),ut=new et(M.$);function st(){return ut}function at(){return st()}var ct=new et(M.$);function ht(){return ct}var ft=new et(M.$),lt=new it(M.$);function pt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=lt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var dt=new it(O);function vt(){return dt}var yt=function(){function t(t){this.$=t?function(e,n){return t(e,n)||M.$(e.key,n.key)}:function(t,e){return M.$(t.key,e.key)},this.Ht=ht(),this.Jt=new et(this.$)}return t.Yt=function(e){return new t(e.$)},t.prototype.has=function(t){return null!=this.Ht.get(t)},t.prototype.get=function(t){return this.Ht.get(t)},t.prototype.first=function(){return this.Jt.At()},t.prototype.last=function(){return this.Jt.Rt()},t.prototype.W=function(){return this.Jt.W()},t.prototype.indexOf=function(t){var e=this.Ht.get(t);return e?this.Jt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Jt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Jt.Pt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Jt.yt(),r=e.Jt.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.$=this.$,r.Ht=e,r.Jt=n,r},t}(),gt=function(){function t(){this.Xt=new et(M.$)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);n?0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):m():this.Xt=this.Xt.Tt(e,t)},t.prototype.Zt=function(){var t=[];return this.Xt.Pt(function(e,n){t.push(n)}),t},t}(),mt=function(){function t(t,e,n,r,i,o,u,s){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=o,this.ne=u,this.se=s}return t.ie=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,yt.Yt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.ee.W()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&Dn(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),_t=function(){function t(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}return t.ae=function(e,n){var r=new Map;return r.set(e,wt.he(e,n)),new t(R.min(),r,vt(),st(),pt())},t}(),wt=function(){function t(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}return t.he=function(e,n){return new t(H.lt,n,pt(),pt(),pt())},t}(),bt=function(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r},It=function(t,e){this.targetId=t,this.Te=e},Et=function(t,e,n,r){void 0===n&&(n=H.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Tt=function(){function t(){this.Ie=0,this.me=xt(),this.Ae=H.lt,this.Re=!1,this.Pe=!0}return Object.defineProperty(t.prototype,"le",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ge",{get:function(){return 0!==this.Ie},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ye",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),t.prototype.Ve=function(t){t.ht()>0&&(this.Pe=!0,this.Ae=t)},t.prototype.pe=function(){var t=pt(),e=pt(),n=pt();return this.me.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:m()}}),new wt(this.Ae,this.Re,t,e,n)},t.prototype.ve=function(){this.Pe=!1,this.me=xt()},t.prototype.be=function(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)},t.prototype.Se=function(t){this.Pe=!0,this.me=this.me.remove(t)},t.prototype.De=function(){this.Ie+=1},t.prototype.Ce=function(){this.Ie-=1},t.prototype.Ne=function(){this.Pe=!0,this.Re=!0},t}(),Nt=function(){function t(t){this.xe=t,this.Fe=new Map,this.Oe=st(),this.Me=At(),this.ke=new it(O)}return t.prototype.$e=function(t){for(var e=0,n=t.we;e<n.length;e++){var r=n[e];t.Ee instanceof dn?this.Le(r,t.Ee):t.Ee instanceof vn&&this.Be(r,t.key,t.Ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var u=o[i];this.Be(u,t.key,t.Ee)}},t.prototype.qe=function(t){var e=this;this.Ue(t,function(n){var r=e.Qe(n);switch(t.state){case 0:e.Ke(n)&&r.Ve(t.resumeToken);break;case 1:r.Ce(),r.ge||r.ve(),r.Ve(t.resumeToken);break;case 2:r.Ce(),r.ge||e.removeTarget(n);break;case 3:e.Ke(n)&&(r.Ne(),r.Ve(t.resumeToken));break;case 4:e.Ke(n)&&(e.We(n),r.Ve(t.resumeToken));break;default:m()}})},t.prototype.Ue=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Fe.forEach(function(t,r){n.Ke(r)&&e(r)})},t.prototype.je=function(t){var e=t.targetId,n=t.Te.count,r=this.Ge(e);if(r){var i=r.target;if(Q(i))if(0===n){var o=new M(i.path);this.Be(e,o,new vn(o,R.min()))}else _(1===n);else this.ze(e)!==n&&(this.We(e),this.ke=this.ke.add(e))}},t.prototype.He=function(t){var e=this,n=new Map;this.Fe.forEach(function(r,i){var o=e.Ge(i);if(o){if(r.le&&Q(o.target)){var u=new M(o.target.path);null!==e.Oe.get(u)||e.Je(i,u)||e.Be(i,u,new vn(u,t))}r.ye&&(n.set(i,r.pe()),r.ve())}});var r=pt();this.Me.forEach(function(t,n){var i=!0;n.Wt(function(t){var n=e.Ge(t);return!n||2===n._t||(i=!1,!1)}),i&&(r=r.add(t))});var i=new _t(t,n,this.ke,this.Oe,r);return this.Oe=st(),this.Me=At(),this.ke=new it(O),i},t.prototype.Le=function(t,e){if(this.Ke(t)){var n=this.Je(t,e.key)?2:0;this.Qe(t).be(e.key,n),this.Oe=this.Oe.Tt(e.key,e),this.Me=this.Me.Tt(e.key,this.Ye(e.key).add(t))}},t.prototype.Be=function(t,e,n){if(this.Ke(t)){var r=this.Qe(t);this.Je(t,e)?r.be(e,1):r.Se(e),this.Me=this.Me.Tt(e,this.Ye(e).delete(t)),n&&(this.Oe=this.Oe.Tt(e,n))}},t.prototype.removeTarget=function(t){this.Fe.delete(t)},t.prototype.ze=function(t){var e=this.Qe(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size},t.prototype.De=function(t){this.Qe(t).De()},t.prototype.Qe=function(t){var e=this.Fe.get(t);return e||(e=new Tt,this.Fe.set(t,e)),e},t.prototype.Ye=function(t){var e=this.Me.get(t);return e||(e=new it(O),this.Me=this.Me.Tt(t,e)),e},t.prototype.Ke=function(t){var e=null!==this.Ge(t);return e||d("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ge=function(t){var e=this.Fe.get(t);return e&&e.ge?null:this.xe.Ze(t)},t.prototype.We=function(t){var e=this;this.Fe.set(t,new Tt),this.xe.Xe(t).forEach(function(n){e.Be(t,n,null)})},t.prototype.Je=function(t,e){return this.xe.Xe(t).has(e)},t}();function At(){return new et(M.$)}function xt(){return new et(M.$)}function Dt(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function kt(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ot(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function St(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Pt(t){var e=t.mapValue.fields.__previous_value__;return St(e)?Pt(e):e}function Ct(t){var e=zt(t.mapValue.fields.__local_write_time__.timestampValue);return new C(e.seconds,e.nanos)}var Rt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?St(t)?4:10:m()}function Lt(t,e){var n=Vt(t);if(n!==Vt(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ct(t).isEqual(Ct(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=zt(t.timestampValue),r=zt(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Gt(t.bytesValue).isEqual(Gt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Bt(t.geoPointValue.latitude)===Bt(e.geoPointValue.latitude)&&Bt(t.geoPointValue.longitude)===Bt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Bt(t.integerValue)===Bt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Bt(t.doubleValue),r=Bt(e.doubleValue);return n===r?F(n)===F(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return S(t.arrayValue.values||[],e.arrayValue.values||[],Lt);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Dt(n)!==Dt(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Lt(n[i],r[i])))return!1;return!0}(t,e);default:return m()}}function Ut(t,e){return void 0!==(t.values||[]).find(function(t){return Lt(t,e)})}function qt(t,e){var n=Vt(t),r=Vt(e);if(n!==r)return O(n,r);switch(n){case 0:return 0;case 1:return O(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Bt(t.integerValue||t.doubleValue),r=Bt(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Mt(t.timestampValue,e.timestampValue);case 4:return Mt(Ct(t),Ct(e));case 5:return O(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Gt(t),r=Gt(e);return n.F(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=O(n[i],r[i]);if(0!==o)return o}return O(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=O(Bt(t.latitude),Bt(e.latitude));return 0!==n?n:O(Bt(t.longitude),Bt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=qt(n[i],r[i]);if(o)return o}return O(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var u=0;u<r.length&&u<o.length;++u){var s=O(r[u],o[u]);if(0!==s)return s;var a=qt(n[r[u]],i[o[u]]);if(0!==a)return a}return O(r.length,o.length)}(t.mapValue,e.mapValue);default:throw m()}}function Mt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return O(t,e);var n=zt(t),r=zt(e),i=O(n.seconds,r.seconds);return 0!==i?i:O(n.nanos,r.nanos)}function jt(t){return Ft(t)}function Ft(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=zt(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Gt(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,M.it(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Ft(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Ft(t.fields[o])}return e+"}"}(t.mapValue):m();var e,n}function zt(t){if(_(!!t),"string"==typeof t){var e=0,n=Rt.exec(t);if(_(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Bt(t.seconds),nanos:Bt(t.nanos)}}function Bt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Gt(t){return"string"==typeof t?H.fromBase64String(t):H.fromUint8Array(t)}function Kt(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function Wt(t){return!!t&&"integerValue"in t}function Qt(t){return!!t&&"arrayValue"in t}function Ht(t){return!!t&&"nullValue"in t}function Yt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $t(t){return!!t&&"mapValue"in t}var Jt={asc:"ASCENDING",desc:"DESCENDING"},Xt={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Zt=function(t,e){this.t=t,this.tn=e};function te(t){return{integerValue:""+t}}function ee(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:F(e)?"-0":e}}function ne(t,e){return z(e)?te(e):ee(t,e)}function re(t,e){return t.tn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ie(t,e){return t.tn?e.toBase64():e.toUint8Array()}function oe(t,e){return re(t,e.M())}function ue(t){return _(!!t),R.N(function(t){var e=zt(t);return new C(e.seconds,e.nanos)}(t))}function se(t,e){return function(t){return new L(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).J()}function ae(t){var e=L.Y(t);return _(Se(e)),e}function ce(t,e){return se(t.t,e.path)}function he(t,e){var n=ae(e);if(n.get(1)!==t.t.projectId)throw new I(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new I(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new M(de(n))}function fe(t,e){return se(t.t,e)}function le(t){var e=ae(t);return 4===e.length?L.X():de(e)}function pe(t){return new L(["projects",t.t.projectId,"databases",t.t.database]).J()}function de(t){return _(t.length>4&&"documents"===t.get(4)),t.B(5)}function ve(t,e,n){return{name:ce(t,e),fields:n.proto.mapValue.fields}}function ye(t,e){var n;if(e instanceof en)n={update:ve(t,e.key,e.value)};else if(e instanceof an)n={delete:ce(t,e.key)};else if(e instanceof nn)n={update:ve(t,e.key,e.data),updateMask:Oe(e.en)};else if(e instanceof on)n={transform:{document:ce(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Le)return{fieldPath:e.field.J(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ue)return{fieldPath:e.field.J(),appendMissingElements:{values:n.elements}};if(n instanceof Me)return{fieldPath:e.field.J(),removeAllFromArray:{values:n.elements}};if(n instanceof Fe)return{fieldPath:e.field.J(),increment:n.nn};throw m()}(0,t)})}};else{if(!(e instanceof cn))return m();n={verify:ce(t,e.key)}}return e.rn.sn||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:oe(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:m()}(t,e.rn)),n}function ge(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Qe.updateTime(ue(t.updateTime)):void 0!==t.exists?Qe.exists(t.exists):Qe.on()}(e.currentDocument):Qe.on();if(e.update){e.update.name;var r=he(t,e.update.name),i=new hn({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){var e=t.fieldPaths||[];return new Ge(e.map(function(t){return q.nt(t)}))}(e.updateMask);return new nn(r,i,o,n)}return new en(r,i,n)}if(e.delete){var u=he(t,e.delete);return new an(u,n)}if(e.transform){var s=he(t,e.transform.document),a=e.transform.fieldTransforms.map(function(e){return function(t,e){var n=null;if("setToServerValue"in e)_("REQUEST_TIME"===e.setToServerValue),n=new Le;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Ue(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Me(i)}else"increment"in e?n=new Fe(t,e.increment):m();var o=q.nt(e.fieldPath);return new Ke(o,n)}(t,e)});return _(!0===n.exists),new on(s,a)}if(e.verify){var c=he(t,e.verify);return new cn(c,n)}return m()}function me(t,e){return{documents:[fe(t,e.path)]}}function _e(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=fe(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=fe(t,r.q()),n.structuredQuery.from=[{collectionId:r.K()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Yt(t.value))return{unaryFilter:{field:Ae(t.field),op:"IS_NAN"}};if(Ht(t.value))return{unaryFilter:{field:Ae(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Yt(t.value))return{unaryFilter:{field:Ae(t.field),op:"IS_NOT_NAN"}};if(Ht(t.value))return{unaryFilter:{field:Ae(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ae(t.field),op:Ne(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:Ae(t.field),direction:Te(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var u=function(t,e){return t.tn||j(e)?e:{value:e}}(t,e.limit);return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Ie(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ie(e.endAt)),n}function we(t){var e=le(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){_(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var u=[];n.where&&(u=be(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(t){return function(t){return new Wn(xe(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var c=null;n.limit&&(c=function(t){var e;return j(e="object"==a(t)?t.value:t)?null:e}(n.limit));var h=null;n.startAt&&(h=Ee(n.startAt));var f=null;return n.endAt&&(f=Ee(n.endAt)),mn(e,i,s,u,c,"F",h,f)}function be(t){return t?void 0!==t.unaryFilter?[ke(t)]:void 0!==t.fieldFilter?[De(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return be(t)}).reduce(function(t,e){return t.concat(e)}):m():[]}function Ie(t){return{before:t.before,values:t.position}}function Ee(t){var e=!!t.before,n=t.values||[];return new zn(n,e)}function Te(t){return Jt[t]}function Ne(t){return Xt[t]}function Ae(t){return{fieldPath:t.J()}}function xe(t){return q.nt(t.fieldPath)}function De(t){return Cn.create(xe(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return m()}}(t.fieldFilter.op),t.fieldFilter.value)}function ke(t){switch(t.unaryFilter.op){case"IS_NAN":var e=xe(t.unaryFilter.field);return Cn.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=xe(t.unaryFilter.field);return Cn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=xe(t.unaryFilter.field);return Cn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=xe(t.unaryFilter.field);return Cn.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return m()}}function Oe(t){var e=[];return t.fields.forEach(function(t){return e.push(t.J())}),{fieldPaths:e}}function Se(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Pe=function(){this.cn=void 0};function Ce(t,e,n){return t instanceof Le?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ue?qe(t,e):t instanceof Me?je(t,e):function(t,e){var n=Ve(t,e),r=ze(n)+ze(t.nn);return Wt(n)&&Wt(t.nn)?te(r):ee(t.serializer,r)}(t,e)}function Re(t,e,n){return t instanceof Ue?qe(t,e):t instanceof Me?je(t,e):n}function Ve(t,e){return t instanceof Fe?Wt(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Le=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n}(Pe),Ue=function(t){function n(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,e.__extends)(n,t),n}(Pe);function qe(t,e){for(var n=Be(e),r=function(t){n.some(function(e){return Lt(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Me=function(t){function n(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,e.__extends)(n,t),n}(Pe);function je(t,e){for(var n=Be(e),r=function(t){n=n.filter(function(e){return!Lt(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Fe=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.nn=n,r}return(0,e.__extends)(n,t),n}(Pe);function ze(t){return Bt(t.integerValue||t.doubleValue)}function Be(t){return Qt(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ge=function(){function t(t){this.fields=t,t.sort(q.$)}return t.prototype.un=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].j(t))return!0;return!1},t.prototype.isEqual=function(t){return S(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),Ke=function(t,e){this.field=t,this.transform=e},We=function(t,e){this.version=t,this.transformResults=e},Qe=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.on=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"sn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function He(t,e){return void 0!==t.updateTime?e instanceof dn&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof dn}var Ye=function(){};function $e(t,e,n){return t instanceof en?function(t,e,n){return new dn(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof nn?function(t,e,n){if(!He(t.rn,e))return new yn(t.key,n.version);var r=rn(t,e);return new dn(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof on?function(t,e,n){if(_(null!=n.transformResults),!He(t.rn,e))return new yn(t.key,n.version);var r=un(t,e),i=function(t,e,n){var r=[];_(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],u=o.transform,s=null;e instanceof dn&&(s=e.field(o.field)),r.push(Re(u,s,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,u=sn(t,r.data(),i);return new dn(t.key,o,u,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new vn(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Je(t,e,n,r){return t instanceof en?function(t,e){if(!He(t.rn,e))return e;var n=tn(e);return new dn(t.key,n,t.value,{an:!0})}(t,e):t instanceof nn?function(t,e){if(!He(t.rn,e))return e;var n=tn(e),r=rn(t,e);return new dn(t.key,n,r,{an:!0})}(t,e):t instanceof on?function(t,e,n,r){if(!He(t.rn,e))return e;var i=un(t,e),o=function(t,e,n,r){for(var i=[],o=0,u=t;o<u.length;o++){var s=u[o],a=s.transform,c=null;n instanceof dn&&(c=n.field(s.field)),null===c&&r instanceof dn&&(c=r.field(s.field)),i.push(Ce(a,c,e))}return i}(t.fieldTransforms,n,e,r),u=sn(t,i.data(),o);return new dn(t.key,i.version,u,{an:!0})}(t,e,r,n):function(t,e){return He(t.rn,e)?new vn(t.key,R.min()):e}(t,e)}function Xe(t,e){return t instanceof on?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],u=e instanceof dn?e.field(o.field):void 0,s=Ve(o.transform,u||null);null!=s&&(n=null==n?(new fn).set(o.field,s):n.set(o.field,s))}return n?n.hn():null}(t,e):null}function Ze(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||S(t.fieldTransforms,t.fieldTransforms,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ue&&e instanceof Ue||t instanceof Me&&e instanceof Me?S(t.elements,e.elements,Lt):t instanceof Fe&&e instanceof Fe?Lt(t.nn,e.nn):t instanceof Le&&e instanceof Le}(t.transform,e.transform)}(t,e)}))}function tn(t){return t instanceof dn?t.version:R.min()}var en=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.rn=r,i.type=0,i}return(0,e.__extends)(n,t),n}(Ye),nn=function(t){function n(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.en=r,o.rn=i,o.type=1,o}return(0,e.__extends)(n,t),n}(Ye);function rn(t,e){return function(t,e){var n=new fn(e);return t.en.fields.forEach(function(e){if(!e.W()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.hn()}(t,e instanceof dn?e.data():hn.empty())}var on=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.rn=Qe.exists(!0),r}return(0,e.__extends)(n,t),n}(Ye);function un(t,e){return e}function sn(t,e,n){for(var r=new fn(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.hn()}var an=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=3,r}return(0,e.__extends)(n,t),n}(Ye),cn=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=4,r}return(0,e.__extends)(n,t),n}(Ye),hn=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!$t(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.K()])||null},t.prototype.isEqual=function(t){return Lt(this.proto,t.proto)},t}(),fn=function(){function t(t){void 0===t&&(t=hn.empty()),this.ln=t,this._n=new Map}return t.prototype.set=function(t,e){return this.fn(t,e),this},t.prototype.delete=function(t){return this.fn(t,null),this},t.prototype.fn=function(t,e){for(var n=this._n,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Vt(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.K(),e)},t.prototype.hn=function(){var t=this.dn(q.X(),this._n);return null!=t?new hn(t):this.ln},t.prototype.dn=function(t,e){var n=this,r=!1,i=this.ln.field(t),o=$t(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var u=n.dn(t.child(i),e);null!=u&&(o[i]=u,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function ln(t){var e=[];return kt(t.fields||{},function(t,n){var r=new q([t]);if($t(n)){var i=ln(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,u=i;o<u.length;o++){var s=u[o];e.push(r.child(s))}}else e.push(r)}),new Ge(e)}var pn=function(t,e){this.key=t,this.version=e},dn=function(t){function n(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).wn=r,o.an=!!i.an,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return(0,e.__extends)(n,t),n.prototype.field=function(t){return this.wn.field(t)},n.prototype.data=function(){return this.wn},n.prototype.En=function(){return this.wn.proto},n.prototype.isEqual=function(t){return t instanceof n&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)},n.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.wn.toString()+", {hasLocalMutations: "+this.an+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return this.an||this.hasCommittedMutations},enumerable:!1,configurable:!0}),n}(pn),vn=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return(0,e.__extends)(n,t),n.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),n.prototype.isEqual=function(t){return t instanceof n&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},n}(pn),yn=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),n.prototype.isEqual=function(t){return t instanceof n&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},n}(pn),gn=function(t,e,n,r,i,o,u,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===u&&(u=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=u,this.endAt=s,this.In=null,this.mn=null,this.startAt,this.endAt};function mn(t,e,n,r,i,o,u,s){return new gn(t,e,n,r,i,o,u,s)}function _n(t){return new gn(t)}function wn(t){return!j(t.limit)&&"F"===t.limitType}function bn(t){return!j(t.limit)&&"L"===t.limitType}function In(t){return t.Tn.length>0?t.Tn[0].field:null}function En(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.An())return r.field}return null}function Tn(t){return null!==t.collectionGroup}function Nn(t){var e=w(t);if(null===e.In){e.In=[];var n=En(e),r=In(e);if(null!==n&&null===r)n.tt()||e.In.push(new Wn(n)),e.In.push(new Wn(q.et(),"asc"));else{for(var i=!1,o=0,u=e.Tn;o<u.length;o++){var s=u[o];e.In.push(s),s.field.tt()&&(i=!0)}if(!i){var a=e.Tn.length>0?e.Tn[e.Tn.length-1].dir:"asc";e.In.push(new Wn(q.et(),a))}}}return e.In}function An(t){var e=w(t);if(!e.mn)if("F"===e.limitType)e.mn=G(e.path,e.collectionGroup,Nn(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Nn(e);r<i.length;r++){var o=i[r],u="desc"===o.dir?"asc":"desc";n.push(new Wn(o.field,u))}var s=e.endAt?new zn(e.endAt.position,!e.endAt.before):null,a=e.startAt?new zn(e.startAt.position,!e.startAt.before):null;e.mn=G(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.mn}function xn(t,e,n){return new gn(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Dn(t,e){return W(An(t),An(e))&&t.limitType===e.limitType}function kn(t){return K(An(t))+"|lt:"+t.limitType}function On(t){return"Query(target="+function(t){var e=t.path.J();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.J()+" "+e.op+" "+jt(e.value);var e}).join(", ")+"]"),j(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.J()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Bn(t.startAt)),t.endAt&&(e+=", endAt: "+Bn(t.endAt)),"Target("+e+")"}(An(t))+"; limitType="+t.limitType+")"}function Sn(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.rt(t.collectionGroup)&&t.path.j(n):M.ot(t.path)?t.path.isEqual(n):t.path.G(n)}(t,e)&&function(t,e){for(var n=0,r=t.Tn;n<r.length;n++){var i=r[n];if(!i.field.tt()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Gn(t.startAt,Nn(t),e)||t.endAt&&Gn(t.endAt,Nn(t),e))}(t,e)}function Pn(t){return function(e,n){for(var r=!1,i=0,o=Nn(t);i<o.length;i++){var u=o[i],s=Qn(u,e,n);if(0!==s)return s;r=r||u.field.tt()}return 0}}var Cn=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return(0,e.__extends)(n,t),n.create=function(t,e,r){return t.tt()?"in"===e||"not-in"===e?this.Rn(t,e,r):new Rn(t,e,r):"array-contains"===e?new qn(t,r):"in"===e?new Mn(t,r):"not-in"===e?new jn(t,r):"array-contains-any"===e?new Fn(t,r):new n(t,e,r)},n.Rn=function(t,e,n){return"in"===e?new Vn(t,n):new Ln(t,n)},n.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Pn(qt(e,this.value)):null!==e&&Vt(this.value)===Vt(e)&&this.Pn(qt(e,this.value))},n.prototype.Pn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return m()}},n.prototype.An=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},n}(function(){}),Rn=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=M.it(r.referenceValue),i}return(0,e.__extends)(n,t),n.prototype.matches=function(t){var e=M.$(t.key,this.key);return this.Pn(e)},n}(Cn),Vn=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Un("in",n),r}return(0,e.__extends)(n,t),n.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},n}(Cn),Ln=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Un("not-in",n),r}return(0,e.__extends)(n,t),n.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},n}(Cn);function Un(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return M.it(t.referenceValue)})}var qn=function(t){function n(e,n){return t.call(this,e,"array-contains",n)||this}return(0,e.__extends)(n,t),n.prototype.matches=function(t){var e=t.field(this.field);return Qt(e)&&Ut(e.arrayValue,this.value)},n}(Cn),Mn=function(t){function n(e,n){return t.call(this,e,"in",n)||this}return(0,e.__extends)(n,t),n.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Ut(this.value.arrayValue,e)},n}(Cn),jn=function(t){function n(e,n){return t.call(this,e,"not-in",n)||this}return(0,e.__extends)(n,t),n.prototype.matches=function(t){if(Ut(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Ut(this.value.arrayValue,e)},n}(Cn),Fn=function(t){function n(e,n){return t.call(this,e,"array-contains-any",n)||this}return(0,e.__extends)(n,t),n.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Qt(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Ut(e.value.arrayValue,t)})},n}(Cn),zn=function(t,e){this.position=t,this.before=e};function Bn(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return jt(t)}).join(",")}function Gn(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],u=t.position[i];if(r=o.field.tt()?M.$(M.it(u.referenceValue),n.key):qt(u,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Kn(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Lt(t.position[n],e.position[n]))return!1;return!0}var Wn=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Qn(t,e,n){var r=t.field.tt()?M.$(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?qt(r,i):m()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return m()}}function Hn(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Yn=function(){function t(t,e,n,r){this.batchId=t,this.gn=e,this.baseMutations=n,this.mutations=r}return t.prototype.yn=function(t,e,n){for(var r=n.Vn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=$e(o,e,r[i]))}return e},t.prototype.pn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Je(i,e,e,this.gn))}for(var o=e,u=0,s=this.mutations;u<s.length;u++){var a=s[u];a.key.isEqual(t)&&(e=Je(a,e,o,this.gn))}return e},t.prototype.vn=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.pn(r.key,t.get(r.key));i&&(n=n.Tt(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},pt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&S(this.mutations,t.mutations,function(t,e){return Ze(t,e)})&&S(this.baseMutations,t.baseMutations,function(t,e){return Ze(t,e)})},t}(),$n=function(){function t(t,e,n,r){this.batch=t,this.bn=e,this.Vn=n,this.Sn=r}return t.from=function(e,n,r){_(e.mutations.length===r.length);for(var i=ft,o=e.mutations,u=0;u<o.length;u++)i=i.Tt(o[u].key,r[u].version);return new t(e,n,r,i)},t}(),Jn=function(){function t(t,e){this.Dn=t,this.Cn=e,this.Nn={}}return t.prototype.get=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[0],s=o[1];if(this.Cn(u,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Cn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){kt(this.Nn,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[0],s=o[1];t(u,s)}})},t.prototype.W=function(){return Ot(this.Nn)},t}(),Xn=function(){function t(t){var e=this;this.xn=null,this.Fn=null,this.result=void 0,this.error=void 0,this.On=!1,this.Mn=!1,t(function(t){e.On=!0,e.result=t,e.xn&&e.xn(t)},function(t){e.On=!0,e.error=t,e.Fn&&e.Fn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Mn&&m(),this.Mn=!0,this.On?this.error?this.kn(n,this.error):this.$n(e,this.result):new t(function(t,i){r.xn=function(n){r.$n(e,n).next(t,i)},r.Fn=function(e){r.kn(n,e).next(t,i)}})},t.prototype.Ln=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Bn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.$n=function(e,n){return e?this.Bn(function(){return e(n)}):t.resolve(n)},t.prototype.kn=function(e,n){return e?this.Bn(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.qn=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Un=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.qn(r)},t}(),Zn=function(){function t(){this.Qn=new Jn(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Kn=!1}return t.prototype.Wn=function(t){var e=this.Qn.get(t);return e?e.readTime:R.min()},t.prototype.jn=function(t,e){this.Gn(),this.Qn.set(t.key,{zn:t,readTime:e})},t.prototype.Hn=function(t,e){void 0===e&&(e=null),this.Gn(),this.Qn.set(t,{zn:null,readTime:e})},t.prototype.Jn=function(t,e){this.Gn();var n=this.Qn.get(e);return void 0!==n?Xn.resolve(n.zn):this.Yn(t,e)},t.prototype.getEntries=function(t,e){return this.Xn(t,e)},t.prototype.apply=function(t){return this.Gn(),this.Kn=!0,this.Zn(t)},t.prototype.Gn=function(){},t}(),tr=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})};function er(t){return new Zt(t,!0)}function nr(t){return function(t,e){if("object"!=a(t)||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var rr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ir=function(){function t(){this.ts=[]}return t.prototype.es=function(t){this.ts.push(t)},t.prototype.ns=function(){this.ts.forEach(function(t){return t()})},t}(),or=function(){function t(t,e,n){this.ss=t,this.rs=e,this.os=n}return t.prototype.cs=function(t,e){var n=this;return this.rs.us(t,e).next(function(r){return n.hs(t,e,r)})},t.prototype.hs=function(t,e,n){return this.ss.Jn(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].pn(e,t);return t})},t.prototype.ls=function(t,e,n){var r=at();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].pn(t,e);r=r.Tt(t,e)}),r},t.prototype._s=function(t,e){var n=this;return this.ss.getEntries(t,e).next(function(e){return n.fs(t,e)})},t.prototype.fs=function(t,e){var n=this;return this.rs.ds(t,e).next(function(r){var i=n.ls(t,e,r),o=st();return i.forEach(function(t,e){e||(e=new vn(t,R.min())),o=o.Tt(t,e)}),o})},t.prototype.ws=function(t,e,n){return function(t){return M.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Es(t,e.path):Tn(e)?this.Ts(t,e,n):this.Is(t,e,n)},t.prototype.Es=function(t,e){return this.cs(t,new M(e)).next(function(t){var e=ht();return t instanceof dn&&(e=e.Tt(t.key,t)),e})},t.prototype.Ts=function(t,e,n){var r=this,i=e.collectionGroup,o=ht();return this.os.As(t,i).next(function(u){return Xn.forEach(u,function(u){var s=function(t,e){return new gn(e,null,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,u.child(i));return r.Is(t,s,n).next(function(t){t.forEach(function(t,e){o=o.Tt(t,e)})})}).next(function(){return o})})},t.prototype.Is=function(t,e,n){var r,i,o=this;return this.ss.ws(t,e,n).next(function(n){return r=n,o.rs.Rs(t,e)}).next(function(e){return i=e,o.Ps(t,i,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],u=0,s=o.mutations;u<s.length;u++){var a=s[u],c=a.key,h=r.get(c),f=Je(a,h,h,o.gn);r=f instanceof dn?r.Tt(c,f):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){Sn(e,n)||(r=r.remove(t))}),r})},t.prototype.Ps=function(t,e,n){for(var r=pt(),i=0,o=e;i<o.length;i++)for(var u=0,s=o[i].mutations;u<s.length;u++){var a=s[u];a instanceof nn&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ss.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof dn&&(c=c.Tt(t,e))}),c})},t}(),ur=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.gs=n,this.ys=r}return t.Vs=function(e,n){for(var r=pt(),i=pt(),o=0,u=n.docChanges;o<u.length;o++){var s=u[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),sr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ps=function(t){return n.vs(t)},this.bs=function(t){return e.Ss(t)})}return t.prototype.vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.bs&&this.bs(t),t},t}();sr.Ds=-1;var ar=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Cs=t,this.Ns=e,this.xs=n,this.Fs=r,this.Os=i,this.Ms=0,this.ks=null,this.$s=Date.now(),this.reset()}return t.prototype.reset=function(){this.Ms=0},t.prototype.Ls=function(){this.Ms=this.Os},t.prototype.Bs=function(t){var e=this;this.cancel();var n=Math.floor(this.Ms+this.qs()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);i>0&&d("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ms+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ks=this.Cs.Us(this.Ns,i,function(){return e.$s=Date.now(),t()}),this.Ms*=this.Fs,this.Ms<this.xs&&(this.Ms=this.xs),this.Ms>this.Os&&(this.Ms=this.Os)},t.prototype.Qs=function(){null!==this.ks&&(this.ks.Ks(),this.ks=null)},t.prototype.cancel=function(){null!==this.ks&&(this.ks.cancel(),this.ks=null)},t.prototype.qs=function(){return(Math.random()-.5)*this.Ms},t}(),cr=function(){function n(t,e,r){this.name=t,this.version=e,this.Ws=r,12.2===n.js((0,i.getUA)())&&v("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return n.delete=function(t){return d("SimpleDb","Removing database:",t),vr(window.indexedDB.deleteDatabase(t)).Ln()},n.Gs=function(){if("undefined"==typeof indexedDB)return!1;if(n.zs())return!0;var t=(0,i.getUA)(),e=n.js(t),r=0<e&&e<10,o=n.Hs(t),u=0<o&&o<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||u)},n.zs=function(){var e;return void 0!==t&&"YES"===(null===(e=t.env)||void 0===e?void 0:e.Js)},n.Ys=function(t,e){return t.store(e)},n.js=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},n.Hs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},n.prototype.Xs=function(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n,r=this;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return this.db?[3,2]:(d("SimpleDb","Opening database:",this.name),n=this,[4,new Promise(function(e,n){var i=indexedDB.open(r.name,r.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){n(new fr(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var r=e.target.error;"VersionError"===r.name?n(new I(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new fr(t,r))},i.onupgradeneeded=function(t){d("SimpleDb",'Database "'+r.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;r.Ws.createOrUpgrade(e,i.transaction,t.oldVersion,r.version).next(function(){d("SimpleDb","Database upgrade to version "+r.version+" complete")})}})]);case 1:n.db=e.sent(),e.label=2;case 2:return[2,(this.Zs&&(this.db.onversionchange=function(t){return r.Zs(t)}),this.db)]}})})},n.prototype.ti=function(t){this.Zs=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},n.prototype.runTransaction=function(t,n,r,i){return(0,e.__awaiter)(this,void 0,void 0,function(){var o,u,s,c,h;return(0,e.__generator)(this,function(f){switch(f.label){case 0:o="readonly"===n,u=0,s=function(){var n,s,a,h,f;return(0,e.__generator)(this,function(e){switch(e.label){case 0:++u,e.label=1;case 1:return e.trys.push([1,4,,5]),[4,c.Xs(t)];case 2:return c.db=e.sent(),n=pr.open(c.db,t,o?"readonly":"readwrite",r),s=i(n).catch(function(t){return n.abort(t),Xn.reject(t)}).Ln(),a={},s.catch(function(){}),[4,n.ei];case 3:return[2,(a.value=(e.sent(),s),a)];case 4:return h=e.sent(),f="FirebaseError"!==h.name&&u<3,d("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),c.close(),f?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}})},c=this,f.label=1;case 1:return[5,s()];case 2:if("object"==a(h=f.sent()))return[2,h.value];f.label=3;case 3:return[3,1];case 4:return[2]}})})},n.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},n}(),hr=function(){function t(t){this.ni=t,this.si=!1,this.ii=null}return Object.defineProperty(t.prototype,"On",{get:function(){return this.si},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ri",{get:function(){return this.ii},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ni=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.si=!0},t.prototype.oi=function(t){this.ii=t},t.prototype.delete=function(){return vr(this.ni.delete())},t}(),fr=function(t){function n(e,n){var r=this;return(r=t.call(this,b.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return(0,e.__extends)(n,t),n}(I);function lr(t){return"IndexedDbTransactionError"===t.name}var pr=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ci=new tr,this.transaction.oncomplete=function(){n.ci.resolve()},this.transaction.onabort=function(){e.error?n.ci.reject(new fr(t,e.error)):n.ci.resolve()},this.transaction.onerror=function(e){var r=gr(e.target.error);n.ci.reject(new fr(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new fr(n,e)}},Object.defineProperty(t.prototype,"ei",{get:function(){return this.ci.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ci.reject(t),this.aborted||(d("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new dr(e)},t}(),dr=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(d("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(d("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),vr(n)},t.prototype.add=function(t){return d("SimpleDb","ADD",this.store.name,t,t),vr(this.store.add(t))},t.prototype.get=function(t){var e=this;return vr(this.store.get(t)).next(function(n){return void 0===n&&(n=null),d("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return d("SimpleDb","DELETE",this.store.name,t),vr(this.store.delete(t))},t.prototype.count=function(){return d("SimpleDb","COUNT",this.store.name),vr(this.store.count())},t.prototype.ui=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ai(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.hi=function(t,e){d("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.li=!1;var r=this.cursor(n);return this.ai(r,function(t,e,n){return n.delete()})},t.prototype._i=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ai(r,e)},t.prototype.fi=function(t){var e=this.cursor({});return new Xn(function(n,r){e.onerror=function(t){var e=gr(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.ai=function(t,e){var n=[];return new Xn(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new hr(i),u=e(i.primaryKey,i.value,o);if(u instanceof Xn){var s=u.catch(function(t){return o.done(),Xn.reject(t)});n.push(s)}o.On?r():null===o.ri?i.continue():i.continue(o.ri)}else r()}}).next(function(){return Xn.qn(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function vr(t){return new Xn(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=gr(t.target.error);n(e)}})}var yr=!1;function gr(t){var e=cr.js((0,i.getUA)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new I("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return yr||(yr=!0,setTimeout(function(){throw r},0)),r}}return t}function mr(){return"undefined"!=typeof window?window:null}function _r(){return"undefined"!=typeof document?document:null}var wr=function(){function t(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new tr,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch(function(t){})}return t.Ii=function(e,n,r,i,o){var u=new t(e,n,Date.now()+r,i,o);return u.start(r),u},t.prototype.start=function(t){var e=this;this.mi=setTimeout(function(){return e.Ai()},t)},t.prototype.Ks=function(){return this.Ai()},t.prototype.cancel=function(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new I(b.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Ai=function(){var t=this;this.di.Ri(function(){return null!==t.mi?(t.clearTimeout(),t.op().then(function(e){return t.Ti.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)},t}(),br=function(){function t(){var t=this;this.Pi=Promise.resolve(),this.gi=[],this.yi=!1,this.Vi=[],this.pi=null,this.vi=!1,this.bi=[],this.Si=new ar(this,"async_queue_retry"),this.Di=function(){var e=_r();e&&d("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Si.Qs()};var e=_r();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Di)}return Object.defineProperty(t.prototype,"Ci",{get:function(){return this.yi},enumerable:!1,configurable:!0}),t.prototype.Ri=function(t){this.enqueue(t)},t.prototype.Ni=function(t){this.xi(),this.Fi(t)},t.prototype.Oi=function(){if(!this.yi){this.yi=!0;var t=_r();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di)}},t.prototype.enqueue=function(t){return this.xi(),this.yi?new Promise(function(t){}):this.Fi(t)},t.prototype.Mi=function(t){var e=this;this.Ri(function(){return e.gi.push(t),e.ki()})},t.prototype.ki=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t,n=this;return(0,e.__generator)(this,function(e){switch(e.label){case 0:if(0===this.gi.length)return[3,5];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.gi[0]()];case 2:return e.sent(),this.gi.shift(),this.Si.reset(),[3,4];case 3:if(!lr(t=e.sent()))throw t;return d("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.gi.length>0&&this.Si.Bs(function(){return n.ki()}),e.label=5;case 5:return[2]}})})},t.prototype.Fi=function(t){var e=this,n=this.Pi.then(function(){return e.vi=!0,t().catch(function(t){throw e.pi=t,e.vi=!1,v("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.vi=!1,t})});return this.Pi=n,n},t.prototype.Us=function(t,e,n){var r=this;this.xi(),this.bi.indexOf(t)>-1&&(e=0);var i=wr.Ii(this,t,e,n,function(t){return r.$i(t)});return this.Vi.push(i),i},t.prototype.xi=function(){this.pi&&m()},t.prototype.Li=function(){},t.prototype.Bi=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,t=this.Pi];case 1:e.sent(),e.label=2;case 2:if(t!==this.Pi)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.qi=function(t){for(var e=0,n=this.Vi;e<n.length;e++)if(n[e].Ns===t)return!0;return!1},t.prototype.Ui=function(t){var e=this;return this.Bi().then(function(){e.Vi.sort(function(t,e){return t.wi-e.wi});for(var n=0,r=e.Vi;n<r.length;n++){var i=r[n];if(i.Ks(),"all"!==t&&i.Ns===t)break}return e.Bi()})},t.prototype.Qi=function(t){this.bi.push(t)},t.prototype.$i=function(t){var e=this.Vi.indexOf(t);this.Vi.splice(e,1)},t}();function Ir(t,e){if(v("AsyncQueue",e+": "+t),lr(t))return new I(b.UNAVAILABLE,e+": "+t);throw t}function Er(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],u=O(n,i);return 0===u?O(r,o):u}var Tr=function(){function t(t){this.Ki=t,this.buffer=new it(Er),this.Wi=0}return t.prototype.ji=function(){return++this.Wi},t.prototype.Gi=function(t){var e=[t,this.ji()];if(this.buffer.size<this.Ki)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Er(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Nr={zi:!1,Hi:0,Ji:0,Yi:0},Ar=function(){function t(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}return t.er=function(e){return new t(e,t.nr,t.sr)},t}();Ar.nr=10,Ar.sr=1e3,Ar.ir=new Ar(41943040,Ar.nr,Ar.sr),Ar.rr=new Ar(-1,0,0);var xr=function(){function t(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}return t.prototype.start=function(t){-1!==this.cr.params.Xi&&this.hr(t)},t.prototype.stop=function(){this.ar&&(this.ar.cancel(),this.ar=null)},Object.defineProperty(t.prototype,"lr",{get:function(){return null!==this.ar},enumerable:!1,configurable:!0}),t.prototype.hr=function(t){var n=this,r=this.ur?3e5:6e4;d("LruGarbageCollector","Garbage collection scheduled in "+r+"ms"),this.ar=this.di.Us("lru_garbage_collection",r,function(){return(0,e.__awaiter)(n,void 0,void 0,function(){var n;return(0,e.__generator)(this,function(e){switch(e.label){case 0:this.ar=null,this.ur=!0,e.label=1;case 1:return e.trys.push([1,3,,7]),[4,t._r(this.cr)];case 2:return e.sent(),[3,7];case 3:return lr(n=e.sent())?(d("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n),[3,6]):[3,4];case 4:return[4,to(n)];case 5:e.sent(),e.label=6;case 6:return[3,7];case 7:return[4,this.hr(t)];case 8:return e.sent(),[2]}})})})},t}(),Dr=function(){function t(t,e){this.dr=t,this.params=e}return t.prototype.wr=function(t,e){return this.dr.Er(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.Tr=function(t,e){var n=this;if(0===e)return Xn.resolve(sr.Ds);var r=new Tr(e);return this.dr.Ue(t,function(t){return r.Gi(t.sequenceNumber)}).next(function(){return n.dr.Ir(t,function(t){return r.Gi(t)})}).next(function(){return r.maxValue})},t.prototype.mr=function(t,e,n){return this.dr.mr(t,e,n)},t.prototype.Ar=function(t,e){return this.dr.Ar(t,e)},t.prototype.Rr=function(t,e){var n=this;return-1===this.params.Xi?(d("LruGarbageCollector","Garbage collection skipped; disabled"),Xn.resolve(Nr)):this.Pr(t).next(function(r){return r<n.params.Xi?(d("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Xi),Nr):n.gr(t,e)})},t.prototype.Pr=function(t){return this.dr.Pr(t)},t.prototype.gr=function(t,e){var n,i,o,u,s,a,c,h=this,f=Date.now();return this.wr(t,this.params.Zi).next(function(e){return e>h.params.tr?(d("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.tr+" from "+e),i=h.params.tr):i=e,u=Date.now(),h.Tr(t,i)}).next(function(r){return n=r,s=Date.now(),h.mr(t,n,e)}).next(function(e){return o=e,a=Date.now(),h.Ar(t,n)}).next(function(t){return c=Date.now(),p()<=r.LogLevel.DEBUG&&d("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(u-f)+"ms\n\tDetermined least recently used "+i+" in "+(s-u)+"ms\n\tRemoved "+o+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),Xn.resolve({zi:!0,Hi:i,Ji:o,Yi:t})})},t}();function kr(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Sr(e)),e=Or(t.get(n),e);return Sr(e)}function Or(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Sr(t){return t+""}function Pr(t){var e=t.length;if(_(e>=2),2===e)return _(""===t.charAt(0)&&""===t.charAt(1)),L.X();for(var n=e-2,r=[],i="",o=0;o<e;){var u=t.indexOf("",o);switch((u<0||u>n)&&m(),t.charAt(u+1)){case"":var s=t.substring(o,u),a=void 0;0===i.length?a=s:(a=i+=s,i=""),r.push(a);break;case"":i+=t.substring(o,u),i+="\0";break;case"":i+=t.substring(o,u+1);break;default:m()}o=u+2}return new L(r)}var Cr=function(t){this.yr=t};function Rr(t,e){if(e.document)return function(t,e,n){var r=he(t,e.name),i=ue(e.updateTime),o=new hn({mapValue:{fields:e.fields}});return new dn(r,i,o,{hasCommittedMutations:!!n})}(t.yr,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=M.ct(e.noDocument.path),r=Mr(e.noDocument.readTime);return new vn(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=M.ct(e.unknownDocument.path),o=Mr(e.unknownDocument.version);return new yn(i,o)}return m()}function Vr(t,e,n){var r=Lr(n),i=e.key.path.q().H();if(e instanceof dn){var o=function(t,e){return{name:ce(t,e.key),fields:e.En().mapValue.fields,updateTime:re(t,e.version.M())}}(t.yr,e),u=e.hasCommittedMutations;return new li(null,null,o,u,r,i)}if(e instanceof vn){var s=e.key.path.H(),a=qr(e.version),c=e.hasCommittedMutations;return new li(null,new hi(s,a),null,c,r,i)}if(e instanceof yn){var h=e.key.path.H(),f=qr(e.version);return new li(new fi(h,f),null,null,!0,r,i)}return m()}function Lr(t){var e=t.M();return[e.seconds,e.nanoseconds]}function Ur(t){var e=new C(t[0],t[1]);return R.N(e)}function qr(t){var e=t.M();return new oi(e.seconds,e.nanoseconds)}function Mr(t){var e=new C(t.seconds,t.nanoseconds);return R.N(e)}function jr(t,e){var n=(e.baseMutations||[]).map(function(e){return ge(t.yr,e)}),r=e.mutations.map(function(e){return ge(t.yr,e)}),i=C.fromMillis(e.localWriteTimeMs);return new Yn(e.batchId,i,n,r)}function Fr(t){var e,n,r=Mr(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Mr(t.lastLimboFreeSnapshotVersion):R.min();return void 0!==t.query.documents?(_(1===(n=t.query).documents.length),e=An(_n(le(n.documents[0])))):e=function(t){return An(we(t))}(t.query),new J(e,t.targetId,0,t.lastListenSequenceNumber,r,i,H.fromBase64String(t.resumeToken))}function zr(t,e){var n,r=qr(e.ft),i=qr(e.lastLimboFreeSnapshotVersion);n=Q(e.target)?me(t.yr,e.target):_e(t.yr,e.target);var o=e.resumeToken.toBase64();return new di(e.targetId,K(e.target),r,o,e.sequenceNumber,i,n)}function Br(t){var e=we({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?xn(e,e.limit,"L"):e}var Gr=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Vr=r,this.pr={}}return t.vr=function(e,n,r,i){return _(""!==e.uid),new t(e.u()?e.uid:"",n,r,i)},t.prototype.br=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Qr(t)._i({index:ai.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Sr=function(t,e,n,r){var i=this,o=Hr(t),u=Qr(t);return u.add({}).next(function(s){_("number"==typeof s);for(var a=new Yn(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return ye(t.yr,e)}),i=n.mutations.map(function(e){return ye(t.yr,e)});return new ai(e,n.batchId,n.gn.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new it(function(t,e){return O(t.J(),e.J())}),l=0,p=r;l<p.length;l++){var d=p[l],v=ci.key(i.userId,d.key.path,s);f=f.add(d.key.path.q()),h.push(u.put(c)),h.push(o.put(v,ci.PLACEHOLDER))}return f.forEach(function(e){h.push(i.os.Dr(t,e))}),t.es(function(){i.pr[s]=a.keys()}),Xn.qn(h).next(function(){return a})})},t.prototype.Cr=function(t,e){var n=this;return Qr(t).get(e).next(function(t){return t?(_(t.userId===n.userId),jr(n.serializer,t)):null})},t.prototype.Nr=function(t,e){var n=this;return this.pr[e]?Xn.resolve(this.pr[e]):this.Cr(t,e).next(function(t){if(t){var r=t.keys();return n.pr[e]=r,r}return null})},t.prototype.Fr=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Qr(t)._i({index:ai.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(_(e.batchId>=r),o=jr(n.serializer,e)),i.done()}).next(function(){return o})},t.prototype.Or=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Qr(t)._i({index:ai.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.Mr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Qr(t).ui(ai.userMutationsIndex,n).next(function(t){return t.map(function(t){return jr(e.serializer,t)})})},t.prototype.us=function(t,e){var n=this,r=ci.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Hr(t)._i({range:i},function(r,i,u){var s=r[0],a=r[1],c=r[2],h=Pr(a);if(s===n.userId&&e.path.isEqual(h))return Qr(t).get(c).next(function(t){if(!t)throw m();_(t.userId===n.userId),o.push(jr(n.serializer,t))});u.done()}).next(function(){return o})},t.prototype.ds=function(t,e){var n=this,r=new it(O),i=[];return e.forEach(function(e){var o=ci.prefixForPath(n.userId,e.path),u=IDBKeyRange.lowerBound(o),s=Hr(t)._i({range:u},function(t,i,o){var u=t[0],s=t[1],a=t[2],c=Pr(s);u===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()});i.push(s)}),Xn.qn(i).next(function(){return n.kr(t,r)})},t.prototype.Rs=function(t,e){var n=this,r=e.path,i=r.length+1,o=ci.prefixForPath(this.userId,r),u=IDBKeyRange.lowerBound(o),s=new it(O);return Hr(t)._i({range:u},function(t,e,o){var u=t[0],a=t[1],c=t[2],h=Pr(a);u===n.userId&&r.j(h)?h.length===i&&(s=s.add(c)):o.done()}).next(function(){return n.kr(t,s)})},t.prototype.kr=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Qr(t).get(e).next(function(t){if(null===t)throw m();_(t.userId===n.userId),r.push(jr(n.serializer,t))}))}),Xn.qn(i).next(function(){return r})},t.prototype.$r=function(t,e){var n=this;return Wr(t.Lr,this.userId,e).next(function(r){return t.es(function(){n.Br(e.batchId)}),Xn.forEach(r,function(e){return n.Vr.qr(t,e)})})},t.prototype.Br=function(t){delete this.pr[t]},t.prototype.Ur=function(t){var e=this;return this.br(t).next(function(n){if(!n)return Xn.resolve();var r=IDBKeyRange.lowerBound(ci.prefixForUser(e.userId)),i=[];return Hr(t)._i({range:r},function(t,n,r){if(t[0]===e.userId){var o=Pr(t[1]);i.push(o)}else r.done()}).next(function(){_(0===i.length)})})},t.prototype.Qr=function(t,e){return Kr(t,this.userId,e)},t.prototype.Kr=function(t){var e=this;return Yr(t).get(this.userId).next(function(t){return t||new si(e.userId,-1,"")})},t}();function Kr(t,e,n){var r=ci.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),u=!1;return Hr(t)._i({range:o,li:!0},function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(u=!0),r.done()}).next(function(){return u})}function Wr(t,e,n){var r=t.store(ai.store),i=t.store(ci.store),o=[],u=IDBKeyRange.only(n.batchId),s=0,a=r._i({range:u},function(t,e,n){return s++,n.delete()});o.push(a.next(function(){_(1===s)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=ci.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Xn.qn(o).next(function(){return c})}function Qr(t){return Vi.Ys(t,ai.store)}function Hr(t){return Vi.Ys(t,ci.store)}function Yr(t){return Vi.Ys(t,si.store)}var $r=function(){function t(t,e){this.serializer=t,this.os=e}return t.prototype.jn=function(t,e,n){return Zr(t).put(ti(e),n)},t.prototype.Hn=function(t,e){var n=Zr(t),r=ti(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Wr(t,r)})},t.prototype.Jn=function(t,e){var n=this;return Zr(t).get(ti(e)).next(function(t){return n.jr(t)})},t.prototype.Gr=function(t,e){var n=this;return Zr(t).get(ti(e)).next(function(t){var e=n.jr(t);return e?{zn:e,size:ei(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=at();return this.zr(t,e,function(t,e){var i=n.jr(e);r=r.Tt(t,i)}).next(function(){return r})},t.prototype.Hr=function(t,e){var n=this,r=at(),i=new et(M.$);return this.zr(t,e,function(t,e){var o=n.jr(e);o?(r=r.Tt(t,o),i=i.Tt(t,ei(e))):(r=r.Tt(t,null),i=i.Tt(t,0))}).next(function(){return{Jr:r,Yr:i}})},t.prototype.zr=function(t,e,n){if(e.W())return Xn.resolve();var r=IDBKeyRange.bound(e.first().path.H(),e.last().path.H()),i=e.yt(),o=i.Ct();return Zr(t)._i({range:r},function(t,e,r){for(var u=M.ct(t);o&&M.$(o,u)<0;)n(o,null),o=i.Ct();o&&o.isEqual(u)&&(n(o,e),o=i.Nt()?i.Ct():null),o?r.oi(o.path.H()):r.done()}).next(function(){for(;o;)n(o,null),o=i.Nt()?i.Ct():null})},t.prototype.ws=function(t,e,n){var r=this,i=ht(),o=e.path.length+1,u={};if(n.isEqual(R.min())){var s=e.path.H();u.range=IDBKeyRange.lowerBound(s)}else{var a=e.path.H(),c=Lr(n);u.range=IDBKeyRange.lowerBound([a,c],!0),u.index=li.collectionReadTimeIndex}return Zr(t)._i(u,function(t,n,u){if(t.length===o){var s=Rr(r.serializer,n);e.path.j(s.key.path)?s instanceof dn&&Sn(e,s)&&(i=i.Tt(s.key,s)):u.done()}}).next(function(){return i})},t.prototype.Xr=function(t){return new Jr(this,!!t&&t.Zr)},t.prototype.eo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Xr(t).get(pi.key).next(function(t){return _(!!t),t})},t.prototype.Wr=function(t,e){return Xr(t).put(pi.key,e)},t.prototype.jr=function(t){if(t){var e=Rr(this.serializer,t);return e instanceof vn&&e.version.isEqual(R.min())?null:e}return null},t}(),Jr=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).no=e,r.Zr=n,r.so=new Jn(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return(0,e.__extends)(n,t),n.prototype.Zn=function(t){var e=this,n=[],r=0,i=new it(function(t,e){return O(t.J(),e.J())});return this.Qn.forEach(function(o,u){var s=e.so.get(o);if(u.zn){var a=Vr(e.no.serializer,u.zn,e.Wn(o));i=i.add(o.path.q());var c=ei(a);r+=c-s,n.push(e.no.jn(t,o,a))}else if(r-=s,e.Zr){var h=Vr(e.no.serializer,new vn(o,R.min()),e.Wn(o));n.push(e.no.jn(t,o,h))}else n.push(e.no.Hn(t,o))}),i.forEach(function(r){n.push(e.no.os.Dr(t,r))}),n.push(this.no.updateMetadata(t,r)),Xn.qn(n)},n.prototype.Yn=function(t,e){var n=this;return this.no.Gr(t,e).next(function(t){return null===t?(n.so.set(e,0),null):(n.so.set(e,t.size),t.zn)})},n.prototype.Xn=function(t,e){var n=this;return this.no.Hr(t,e).next(function(t){var e=t.Jr;return t.Yr.forEach(function(t,e){n.so.set(t,e)}),e})},n}(Zn);function Xr(t){return Vi.Ys(t,pi.store)}function Zr(t){return Vi.Ys(t,li.store)}function ti(t){return t.path.H()}function ei(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw m();e=t.noDocument}return JSON.stringify(e).length}var ni=function(){function t(){this.io=new ri}return t.prototype.Dr=function(t,e){return this.io.add(e),Xn.resolve()},t.prototype.As=function(t,e){return Xn.resolve(this.io.getEntries(e))},t}(),ri=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.K(),n=t.q(),r=this.index[e]||new it(L.$),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.K(),n=t.q(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new it(L.$)).H()},t}(),ii=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;_(n<r&&n>=0&&r<=11);var o=new pr("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(ui.store)}(t),function(t){t.createObjectStore(si.store,{keyPath:si.keyPath}),t.createObjectStore(ai.store,{keyPath:ai.keyPath,autoIncrement:!0}).createIndex(ai.userMutationsIndex,ai.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ci.store)}(t),mi(t),function(t){t.createObjectStore(li.store)}(t));var u=Xn.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(vi.store),t.deleteObjectStore(di.store),t.deleteObjectStore(yi.store)}(t),mi(t)),u=u.next(function(){return t=o.store(yi.store),e=new yi(0,0,R.min().M(),0),t.put(yi.key,e);var t,e})),n<4&&r>=4&&(0!==n&&(u=u.next(function(){return function(t,e){return e.store(ai.store).ui().next(function(n){t.deleteObjectStore(ai.store),t.createObjectStore(ai.store,{keyPath:ai.keyPath,autoIncrement:!0}).createIndex(ai.userMutationsIndex,ai.userMutationsKeyPath,{unique:!0});var r=e.store(ai.store),i=n.map(function(t){return r.put(t)});return Xn.qn(i)})}(t,o)})),u=u.next(function(){!function(t){t.createObjectStore(_i.store,{keyPath:_i.keyPath})}(t)})),n<5&&r>=5&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),n<6&&r>=6&&(u=u.next(function(){return function(t){t.createObjectStore(pi.store)}(t),i.addDocumentGlobal(o)})),n<7&&r>=7&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),n<8&&r>=8&&(u=u.next(function(){return i.createCollectionParentIndex(t,o)})),n<9&&r>=9&&(u=u.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(li.store);e.createIndex(li.readTimeIndex,li.readTimeIndexPath,{unique:!1}),e.createIndex(li.collectionReadTimeIndex,li.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),n<11&&r>=11&&(u=u.next(function(){!function(t){t.createObjectStore(wi.store,{keyPath:wi.keyPath})}(t),function(t){t.createObjectStore(bi.store,{keyPath:bi.keyPath})}(t)})),u},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(li.store)._i(function(t,n){e+=ei(n)}).next(function(){var n=new pi(e);return t.store(pi.store).put(pi.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(si.store),r=t.store(ai.store);return n.ui().next(function(n){return Xn.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ui(ai.userMutationsIndex,i).next(function(r){return Xn.forEach(r,function(r){_(r.userId===n.userId);var i=jr(e.serializer,r);return Wr(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(vi.store),n=t.store(li.store);return t.store(yi.store).get(yi.key).next(function(t){var r=[];return n._i(function(n,i){var o=new L(n),u=[0,kr(o)];r.push(e.get(u).next(function(n){return n?Xn.resolve():function(n){return e.put(new vi(0,kr(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return Xn.qn(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(gi.store,{keyPath:gi.keyPath});var n=e.store(gi.store),r=new ri,i=function(t){if(r.add(t)){var e=t.K(),i=t.q();return n.put({collectionId:e,parent:kr(i)})}};return e.store(li.store)._i({li:!0},function(t,e){var n=new L(t);return i(n.q())}).next(function(){return e.store(ci.store)._i({li:!0},function(t,e){t[0];var n=t[1],r=(t[2],Pr(n));return i(r.q())})})},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(di.store);return n._i(function(t,r){var i=Fr(r),o=zr(e.serializer,i);return n.put(o)})},t}(),oi=function(t,e){this.seconds=t,this.nanoseconds=e},ui=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};ui.store="owner",ui.key="owner";var si=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};si.store="mutationQueues",si.keyPath="userId";var ai=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};ai.store="mutations",ai.keyPath="batchId",ai.userMutationsIndex="userMutationsIndex",ai.userMutationsKeyPath=["userId","batchId"];var ci=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,kr(e)]},t.key=function(t,e,n){return[t,kr(e),n]},t}();ci.store="documentMutations",ci.PLACEHOLDER=new ci;var hi=function(t,e){this.path=t,this.readTime=e},fi=function(t,e){this.path=t,this.version=e},li=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};li.store="remoteDocuments",li.readTimeIndex="readTimeIndex",li.readTimeIndexPath="readTime",li.collectionReadTimeIndex="collectionReadTimeIndex",li.collectionReadTimeIndexPath=["parentPath","readTime"];var pi=function(t){this.byteSize=t};pi.store="remoteDocumentGlobal",pi.key="remoteDocumentGlobalKey";var di=function(t,e,n,r,i,o,u){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=u};di.store="targets",di.keyPath="targetId",di.queryTargetsIndexName="queryTargetsIndex",di.queryTargetsKeyPath=["canonicalId","targetId"];var vi=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};vi.store="targetDocuments",vi.keyPath=["targetId","path"],vi.documentTargetsIndex="documentTargetsIndex",vi.documentTargetsKeyPath=["path","targetId"];var yi=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};yi.key="targetGlobalKey",yi.store="targetGlobal";var gi=function(t,e){this.collectionId=t,this.parent=e};function mi(t){t.createObjectStore(vi.store,{keyPath:vi.keyPath}).createIndex(vi.documentTargetsIndex,vi.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(di.store,{keyPath:di.keyPath}).createIndex(di.queryTargetsIndexName,di.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(yi.store)}gi.store="collectionParents",gi.keyPath=["collectionId","parent"];var _i=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};_i.store="clientMetadata",_i.keyPath="clientId";var wi=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};wi.store="bundles",wi.keyPath="bundleId";var bi=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};bi.store="namedQueries",bi.keyPath="name";var Ii=(0,e.__spreadArrays)((0,e.__spreadArrays)((0,e.__spreadArrays)((0,e.__spreadArrays)([si.store,ai.store,ci.store,li.store,di.store,ui.store,yi.store,vi.store],[_i.store]),[pi.store]),[gi.store]),[wi.store,bi.store]),Ei=function(){function t(t){this.serializer=t}return t.prototype.ro=function(t,e){return Ti(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:Mr(e.createTime),version:e.version};var e})},t.prototype.oo=function(t,e){return Ti(t).put({bundleId:(n=e).id,createTime:qr(ue(n.createTime)),version:n.version});var n},t.prototype.co=function(t,e){return Ni(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:Br(e.bundledQuery),readTime:Mr(e.readTime)};var e})},t.prototype.uo=function(t,e){return Ni(t).put(function(t){return{name:t.name,readTime:qr(ue(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Ti(t){return Vi.Ys(t,wi.store)}function Ni(t){return Vi.Ys(t,bi.store)}var Ai=function(){function t(){this.ao=new ri}return t.prototype.Dr=function(t,e){var n=this;if(!this.ao.has(e)){var r=e.K(),i=e.q();t.es(function(){n.ao.add(e)});var o={collectionId:r,parent:kr(i)};return xi(t).put(o)}return Xn.resolve()},t.prototype.As=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[P(e),""],!1,!0);return xi(t).ui(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Pr(o.parent))}return n})},t}();function xi(t){return Vi.Ys(t,gi.store)}var Di=function(){function t(t){this.ho=t}return t.prototype.next=function(){return this.ho+=2,this.ho},t.lo=function(){return new t(0)},t._o=function(){return new t(-1)},t}(),ki=function(){function t(t,e){this.Vr=t,this.serializer=e}return t.prototype.fo=function(t){var e=this;return this.wo(t).next(function(n){var r=new Di(n.highestTargetId);return n.highestTargetId=r.next(),e.Eo(t,n).next(function(){return n.highestTargetId})})},t.prototype.To=function(t){return this.wo(t).next(function(t){return R.N(new C(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.Io=function(t){return this.wo(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.mo=function(t,e,n){var r=this;return this.wo(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.M()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Eo(t,i)})},t.prototype.Ao=function(t,e){var n=this;return this.Ro(t,e).next(function(){return n.wo(t).next(function(r){return r.targetCount+=1,n.Po(e,r),n.Eo(t,r)})})},t.prototype.yo=function(t,e){return this.Ro(t,e)},t.prototype.Vo=function(t,e){var n=this;return this.po(t,e.targetId).next(function(){return Oi(t).delete(e.targetId)}).next(function(){return n.wo(t)}).next(function(e){return _(e.targetCount>0),e.targetCount-=1,n.Eo(t,e)})},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return Oi(t)._i(function(u,s){var a=Fr(s);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Vo(t,a)))}).next(function(){return Xn.qn(o)}).next(function(){return i})},t.prototype.Ue=function(t,e){return Oi(t)._i(function(t,n){var r=Fr(n);e(r)})},t.prototype.wo=function(t){return Si(t).get(yi.key).next(function(t){return _(null!==t),t})},t.prototype.Eo=function(t,e){return Si(t).put(yi.key,e)},t.prototype.Ro=function(t,e){return Oi(t).put(zr(this.serializer,e))},t.prototype.Po=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.vo=function(t){return this.wo(t).next(function(t){return t.targetCount})},t.prototype.bo=function(t,e){var n=K(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Oi(t)._i({range:r,index:di.queryTargetsIndexName},function(t,n,r){var o=Fr(n);W(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.So=function(t,e,n){var r=this,i=[],o=Pi(t);return e.forEach(function(e){var u=kr(e.path);i.push(o.put(new vi(n,u))),i.push(r.Vr.Do(t,n,e))}),Xn.qn(i)},t.prototype.Co=function(t,e,n){var r=this,i=Pi(t);return Xn.forEach(e,function(e){var o=kr(e.path);return Xn.qn([i.delete([n,o]),r.Vr.No(t,n,e)])})},t.prototype.po=function(t,e){var n=Pi(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.xo=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Pi(t),i=pt();return r._i({range:n,li:!0},function(t,e,n){var r=Pr(t[1]),o=new M(r);i=i.add(o)}).next(function(){return i})},t.prototype.Qr=function(t,e){var n=kr(e.path),r=IDBKeyRange.bound([n],[P(n)],!1,!0),i=0;return Pi(t)._i({index:vi.documentTargetsIndex,li:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Ze=function(t,e){return Oi(t).get(e).next(function(t){return t?Fr(t):null})},t}();function Oi(t){return Vi.Ys(t,di.store)}function Si(t){return Vi.Ys(t,yi.store)}function Pi(t){return Vi.Ys(t,vi.store)}var Ci="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ri=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).Lr=e,r.Fo=n,r}return(0,e.__extends)(n,t),n}(ir),Vi=function(){function t(e,n,r,i,o,u,s,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Cs=o,this.window=u,this.document=s,this.Oo=c,this.Mo=h,this.ko=null,this.$o=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Lo=null,this.inForeground=!1,this.Bo=null,this.qo=null,this.Uo=Number.NEGATIVE_INFINITY,this.Qo=function(t){return Promise.resolve()},!t.Gs())throw new I(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Vr=new qi(this,i),this.Ko=n+"main",this.serializer=new Cr(a),this.Wo=new cr(this.Ko,11,new ii(this.serializer)),this.jo=new ki(this.Vr,this.serializer),this.os=new Ai,this.ss=function(t,e){return new $r(t,e)}(this.serializer,this.os),this.Go=new Ei(this.serializer),this.window&&this.window.localStorage?this.zo=this.window.localStorage:(this.zo=null,!1===h&&v("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Ys=function(t,e){if(t instanceof Ri)return cr.Ys(t.Lr,e);throw m()},t.prototype.start=function(){var t=this;return this.Ho().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new I(b.FAILED_PRECONDITION,Ci);return t.Jo(),t.Yo(),t.Xo(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.jo.Io(e)})}).then(function(e){t.ko=new sr(e,t.Oo)}).then(function(){t.$o=!0}).catch(function(e){return t.Wo&&t.Wo.close(),Promise.reject(e)})},t.prototype.Zo=function(t){var n=this;return this.Qo=function(r){return(0,e.__awaiter)(n,void 0,void 0,function(){return(0,e.__generator)(this,function(e){return this.lr?[2,t(r)]:[2]})})},t(this.isPrimary)},t.prototype.tc=function(t){var n=this;this.Wo.ti(function(r){return(0,e.__awaiter)(n,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return null===r.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.ec=function(t){var n=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){return(0,e.__generator)(this,function(t){switch(t.label){case 0:return this.lr?[4,this.Ho()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Ho=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Ui(e).put(new _i(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.nc(e).next(function(e){e||(t.isPrimary=!1,t.Cs.Mi(function(){return t.Qo(!1)}))})}).next(function(){return t.sc(e)}).next(function(n){return t.isPrimary&&!n?t.ic(e).next(function(){return!1}):!!n&&t.rc(e).next(function(){return!0})})}).catch(function(e){if(lr(e))return d("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return d("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Cs.Mi(function(){return t.Qo(e)}),t.isPrimary=e})},t.prototype.nc=function(t){var e=this;return Li(t).get(ui.key).next(function(t){return Xn.resolve(e.oc(t))})},t.prototype.cc=function(t){return Ui(t).delete(this.clientId)},t.prototype.uc=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){var n,r,i,o,u=this;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return!this.isPrimary||this.ac(this.Uo,18e5)?[3,2]:(this.Uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var n=t.Ys(e,_i.store);return n.ui().next(function(t){var e=u.hc(t,18e5),r=t.filter(function(t){return-1===e.indexOf(t)});return Xn.forEach(r,function(t){return n.delete(t.clientId)}).next(function(){return r})})}).catch(function(){return[]})]);case 1:if(n=e.sent(),this.zo)for(r=0,i=n;r<i.length;r++)o=i[r],this.zo.removeItem(this.lc(o.clientId));e.label=2;case 2:return[2]}})})},t.prototype.Xo=function(){var t=this;this.qo=this.Cs.Us("client_metadata_refresh",4e3,function(){return t.Ho().then(function(){return t.uc()}).then(function(){return t.Xo()})})},t.prototype.oc=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.sc=function(t){var e=this;return this.Mo?Xn.resolve(!0):Li(t).get(ui.key).next(function(n){if(null!==n&&e.ac(n.leaseTimestampMs,5e3)&&!e._c(n.ownerId)){if(e.oc(n)&&e.networkEnabled)return!0;if(!e.oc(n)){if(!n.allowTabSynchronization)throw new I(b.FAILED_PRECONDITION,Ci);return!1}}return!(!e.networkEnabled||!e.inForeground)||Ui(t).ui().next(function(t){return void 0===e.hc(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&d("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.fc=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return this.$o=!1,this.dc(),this.qo&&(this.qo.cancel(),this.qo=null),this.wc(),this.Ec(),[4,this.Wo.runTransaction("shutdown","readwrite",[ui.store,_i.store],function(e){var n=new Ri(e,sr.Ds);return t.ic(n).next(function(){return t.cc(n)})})];case 1:return e.sent(),this.Wo.close(),this.Tc(),[2]}})})},t.prototype.hc=function(t,e){var n=this;return t.filter(function(t){return n.ac(t.updateTimeMs,e)&&!n._c(t.clientId)})},t.prototype.Ic=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return Ui(e).ui().next(function(e){return t.hc(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),t.prototype.mc=function(t){return Gr.vr(t,this.serializer,this.os,this.Vr)},t.prototype.Ac=function(){return this.jo},t.prototype.Rc=function(){return this.ss},t.prototype.Pc=function(){return this.os},t.prototype.gc=function(){return this.Go},t.prototype.runTransaction=function(t,e,n){var r=this;d("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Wo.runTransaction(t,o,Ii,function(o){return i=new Ri(o,r.ko?r.ko.next():sr.Ds),"readwrite-primary"===e?r.nc(i).next(function(t){return!!t||r.sc(i)}).next(function(e){if(!e)throw v("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Cs.Mi(function(){return r.Qo(!1)}),new I(b.FAILED_PRECONDITION,rr);return n(i)}).next(function(t){return r.rc(i).next(function(){return t})}):r.yc(i).next(function(){return n(i)})}).then(function(t){return i.ns(),t})},t.prototype.yc=function(t){var e=this;return Li(t).get(ui.key).next(function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e._c(t.ownerId)&&!e.oc(t)&&!(e.Mo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new I(b.FAILED_PRECONDITION,Ci)})},t.prototype.rc=function(t){var e=new ui(this.clientId,this.allowTabSynchronization,Date.now());return Li(t).put(ui.key,e)},t.Gs=function(){return cr.Gs()},t.prototype.ic=function(t){var e=this,n=Li(t);return n.get(ui.key).next(function(t){return e.oc(t)?(d("IndexedDbPersistence","Releasing primary lease."),n.delete(ui.key)):Xn.resolve()})},t.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(v("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Jo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bo=function(){t.Cs.Ri(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ho()})},this.document.addEventListener("visibilitychange",this.Bo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.wc=function(){this.Bo&&(this.document.removeEventListener("visibilitychange",this.Bo),this.Bo=null)},t.prototype.Yo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Lo=function(){e.dc(),e.Cs.Ri(function(){return e.fc()})},this.window.addEventListener("unload",this.Lo))},t.prototype.Ec=function(){this.Lo&&(this.window.removeEventListener("unload",this.Lo),this.Lo=null)},t.prototype._c=function(t){var e;try{var n=null!==(null===(e=this.zo)||void 0===e?void 0:e.getItem(this.lc(t)));return d("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return v("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.dc=function(){if(this.zo)try{this.zo.setItem(this.lc(this.clientId),String(Date.now()))}catch(t){v("Failed to set zombie client id.",t)}},t.prototype.Tc=function(){if(this.zo)try{this.zo.removeItem(this.lc(this.clientId))}catch(t){}},t.prototype.lc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Li(t){return Vi.Ys(t,ui.store)}function Ui(t){return Vi.Ys(t,_i.store)}var qi=function(){function t(t,e){this.db=t,this.cr=new Dr(this,e)}return t.prototype.Er=function(t){var e=this.Vc(t);return this.db.Ac().vo(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Vc=function(t){var e=0;return this.Ir(t,function(t){e++}).next(function(){return e})},t.prototype.Ue=function(t,e){return this.db.Ac().Ue(t,e)},t.prototype.Ir=function(t,e){return this.vc(t,function(t,n){return e(n)})},t.prototype.Do=function(t,e,n){return Mi(t,n)},t.prototype.No=function(t,e,n){return Mi(t,n)},t.prototype.mr=function(t,e,n){return this.db.Ac().mr(t,e,n)},t.prototype.qr=function(t,e){return Mi(t,e)},t.prototype.bc=function(t,e){return function(t,e){var n=!1;return Yr(t).fi(function(r){return Kr(t,r,e).next(function(t){return t&&(n=!0),Xn.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Ar=function(t,e){var n=this,r=this.db.Rc().Xr(),i=[],o=0;return this.vc(t,function(u,s){if(s<=e){var a=n.bc(t,u).next(function(e){if(!e)return o++,r.Jn(t,u).next(function(){return r.Hn(u),Pi(t).delete([0,kr(u.path)])})});i.push(a)}}).next(function(){return Xn.qn(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.dt(t.Fo);return this.db.Ac().yo(t,n)},t.prototype.Sc=function(t,e){return Mi(t,e)},t.prototype.vc=function(t,e){var n,r=Pi(t),i=sr.Ds;return r._i({index:vi.documentTargetsIndex},function(t,r){var o=t[0],u=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==sr.Ds&&e(new M(Pr(n)),i),i=s,n=u):i=sr.Ds}).next(function(){i!==sr.Ds&&e(new M(Pr(n)),i)})},t.prototype.Pr=function(t){return this.db.Rc().eo(t)},t}();function Mi(t,e){return Pi(t).put(function(t,e){return new vi(0,kr(t.path),e)}(e,t.Fo))}function ji(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Fi=function(){function t(t,e,n,r){this.persistence=t,this.Dc=e,this.serializer=r,this.Cc=new et(O),this.Nc=new Jn(function(t){return K(t)},W),this.xc=R.min(),this.rs=t.mc(n),this.Fc=t.Rc(),this.jo=t.Ac(),this.Oc=new or(this.Fc,this.rs,this.persistence.Pc()),this.Go=t.gc(),this.Dc.Mc(this.Oc)}return t.prototype._r=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.Rr(n,e.Cc)})},t}();function zi(t,e,n,r){return new Fi(t,e,n,r)}function Bi(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o,u;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r=w(t),i=r.rs,o=r.Oc,[4,r.persistence.runTransaction("Handle user change","readonly",function(t){var e;return r.rs.Mr(t).next(function(u){return e=u,i=r.persistence.mc(n),o=new or(r.Fc,i,r.persistence.Pc()),i.Mr(t)}).next(function(n){for(var r=[],i=[],u=pt(),s=0,a=e;s<a.length;s++){var c=a[s];r.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];u=u.add(l.key)}}for(var p=0,d=n;p<d.length;p++){var v=d[p];i.push(v.batchId);for(var y=0,g=v.mutations;y<g.length;y++){var m=g[y];u=u.add(m.key)}}return o._s(t,u).next(function(t){return{kc:t,$c:r,Lc:i}})})})];case 1:return u=e.sent(),[2,(r.rs=i,r.Oc=o,r.Dc.Mc(r.Oc),u)]}})})}function Gi(t,e){var n=w(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Fc.Xr({Zr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),u=Xn.resolve();return o.forEach(function(t){u=u.next(function(){return r.Jn(e,t)}).next(function(e){var o=e,u=n.Sn.get(t);_(null!==u),(!o||o.version.F(u)<0)&&(o=i.yn(t,o,n))&&r.jn(o,n.bn)})}),u.next(function(){return t.rs.$r(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.rs.Ur(t)}).next(function(){return n.Oc._s(t,r)})})}function Ki(t){var e=w(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.jo.To(t)})}function Wi(t,e){var n=w(t),r=e.ft,i=n.Cc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Fc.Xr({Zr:!0});i=n.Cc;var u=[];e.re.forEach(function(e,o){var s=i.get(o);if(s){u.push(n.jo.Co(t,e.de,o).next(function(){return n.jo.So(t,e._e,o)}));var a=e.resumeToken;if(a.ht()>0){var c=s.wt(a,r).dt(t.Fo);i=i.Tt(o,c),function(t,e,n){return _(e.resumeToken.ht()>0),0===t.resumeToken.ht()||e.ft.O()-t.ft.O()>=3e8||n._e.size+n.fe.size+n.de.size>0}(s,c,e)&&u.push(n.jo.yo(t,c))}}});var s=st();if(e.ce.forEach(function(r,i){e.ue.has(r)&&u.push(n.persistence.Vr.Sc(t,r))}),u.push(function(t,e,n,r,i){var o=pt();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var i=st();return n.forEach(function(n,o){var u=t.get(n),s=r;o instanceof vn&&o.version.isEqual(R.min())?(e.Hn(n,s),i=i.Tt(n,o)):null==u||o.version.F(u.version)>0||0===o.version.F(u.version)&&u.hasPendingWrites?(e.jn(o,s),i=i.Tt(n,o)):d("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",o.version)}),i})}(t,o,e.ce,r).next(function(t){s=t})),!r.isEqual(R.min())){var a=n.jo.To(t).next(function(e){return n.jo.mo(t,t.Fo,r)});u.push(a)}return Xn.qn(u).next(function(){return o.apply(t)}).next(function(){return n.Oc.fs(t,s)})}).then(function(t){return n.Cc=i,t})}function Qi(t,e){var n=w(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.rs.Fr(t,e)})}function Hi(t,e){var n=w(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.jo.bo(t,e).next(function(i){return i?(r=i,Xn.resolve(r)):n.jo.fo(t).next(function(i){return r=new J(e,i,0,t.Fo),n.jo.Ao(t,r).next(function(){return r})})})}).then(function(t){var r=n.Cc.get(t.targetId);return(null===r||t.ft.F(r.ft)>0)&&(n.Cc=n.Cc.Tt(t.targetId,t),n.Nc.set(e,t.targetId)),t})}function Yi(t,n,r){return(0,e.__awaiter)(this,void 0,void 0,function(){var i,o,u,s;return(0,e.__generator)(this,function(e){switch(e.label){case 0:i=w(t),o=i.Cc.get(n),u=r?"readwrite":"readwrite-primary",e.label=1;case 1:return e.trys.push([1,4,,5]),r?[3,3]:[4,i.persistence.runTransaction("Release target",u,function(t){return i.persistence.Vr.removeTarget(t,o)})];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:if(!lr(s=e.sent()))throw s;return d("LocalStore","Failed to update sequence numbers for target "+n+": "+s),[3,5];case 5:return i.Cc=i.Cc.remove(n),i.Nc.delete(o.target),[2]}})})}function $i(t,e,n){var r=w(t),i=R.min(),o=pt();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=w(t),i=r.Nc.get(n);return void 0!==i?Xn.resolve(r.Cc.get(i)):r.jo.bo(e,n)}(r,t,An(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.jo.xo(t,e.targetId).next(function(t){o=t})}).next(function(){return r.Dc.ws(t,e,n?i:R.min(),n?o:pt())}).next(function(t){return{documents:t,Bc:o}})})}function Ji(t,e){var n=w(t),r=w(n.jo),i=n.Cc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ze(t,e).next(function(t){return t?t.target:null})})}function Xi(t){var e=w(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=w(t),i=st(),o=Lr(n),u=Zr(e),s=IDBKeyRange.lowerBound(o,!0);return u._i({index:li.readTimeIndex,range:s},function(t,e){var n=Rr(r.serializer,e);i=i.Tt(n.key,n),o=e.readTime}).next(function(){return{qc:i,readTime:Ur(o)}})}(e.Fc,t,e.xc)}).then(function(t){var n=t.qc,r=t.readTime;return e.xc=r,n})}function Zi(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n;return(0,e.__generator)(this,function(e){return[2,(n=w(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Zr(t),n=R.min();return e._i({index:li.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=Ur(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){n.xc=t})]})})}function to(t){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){if(t.code!==b.FAILED_PRECONDITION||t.message!==rr)throw t;return d("LocalStore","Unexpectedly lost primary lease"),[2]})})}var eo=function(){function t(t,e,n,r,i,o){this.Cs=t,this.Uc=n,this.Qc=r,this.Kc=i,this.listener=o,this.state=0,this.Wc=0,this.jc=null,this.stream=null,this.Si=new ar(t,e)}return t.prototype.Gc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.zc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Hc()},t.prototype.stop=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(t){switch(t.label){case 0:return this.Gc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Jc=function(){this.state=0,this.Si.reset()},t.prototype.Yc=function(){var t=this;this.zc()&&null===this.jc&&(this.jc=this.Cs.Us(this.Uc,6e4,function(){return t.Xc()}))},t.prototype.Zc=function(t){this.tu(),this.stream.send(t)},t.prototype.Xc=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(t){return this.zc()?[2,this.close(0)]:[2]})})},t.prototype.tu=function(){this.jc&&(this.jc.cancel(),this.jc=null)},t.prototype.close=function(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return this.tu(),this.Si.cancel(),this.Wc++,3!==t?this.Si.reset():n&&n.code===b.RESOURCE_EXHAUSTED?(v(n.toString()),v("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):n&&n.code===b.UNAUTHENTICATED&&this.Kc.m(),null!==this.stream&&(this.eu(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.nu(n)];case 1:return e.sent(),[2]}})})},t.prototype.eu=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.su(this.Wc),n=this.Wc;this.Kc.getToken().then(function(e){t.Wc===n&&t.iu(e)},function(n){e(function(){var e=new I(b.UNKNOWN,"Fetching auth token failed: "+n.message);return t.ru(e)})})},t.prototype.iu=function(t){var e=this,n=this.su(this.Wc);this.stream=this.ou(t),this.stream.cu(function(){n(function(){return e.state=2,e.listener.cu()})}),this.stream.nu(function(t){n(function(){return e.ru(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Hc=function(){var t=this;this.state=4,this.Si.Bs(function(){return(0,e.__awaiter)(t,void 0,void 0,function(){return(0,e.__generator)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.ru=function(t){return d("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.su=function(t){var e=this;return function(n){e.Cs.Ri(function(){return e.Wc===t?n():(d("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),no=function(t){function n(e,n,r,i,o){var u=this;return(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,u}return(0,e.__extends)(n,t),n.prototype.ou=function(t){return this.Qc.uu("Listen",t)},n.prototype.onMessage=function(t){this.Si.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:m()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.tn?(_(void 0===e||"string"==typeof e),H.fromBase64String(e||"")):(_(void 0===e||e instanceof Uint8Array),H.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),u=e.targetChange.cause,s=u&&function(t){var e=void 0===t.code?b.UNKNOWN:tt(t.code);return new I(e,t.message||"")}(u);n=new Et(r,i,o,s||null)}else if("documentChange"in e){e.documentChange;var a=e.documentChange;a.document,a.document.name,a.document.updateTime;var c=he(t,a.document.name),h=ue(a.document.updateTime),f=new hn({mapValue:{fields:a.document.fields}}),l=new dn(c,h,f,{}),p=a.targetIds||[],d=a.removedTargetIds||[];n=new bt(p,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var y=he(t,v.document),g=v.readTime?ue(v.readTime):R.min(),w=new vn(y,g),E=v.removedTargetIds||[];n=new bt([],E,w.key,w)}else if("documentRemove"in e){e.documentRemove;var T=e.documentRemove;T.document;var N=he(t,T.document),A=T.removedTargetIds||[];n=new bt([],A,N,null)}else{if(!("filter"in e))return m();e.filter;var x=e.filter;x.targetId;var D=x.count||0,k=new X(D),O=x.targetId;n=new It(O,k)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return R.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?R.min():e.readTime?ue(e.readTime):R.min()}(t);return this.listener.au(e,n)},n.prototype.hu=function(t){var e={};e.database=pe(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=Q(r)?{documents:me(t,r)}:{query:_e(t,r)}).targetId=e.targetId,e.resumeToken.ht()>0?n.resumeToken=ie(t,e.resumeToken):e.ft.F(R.min())>0&&(n.readTime=re(t,e.ft.M())),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return m()}}(0,e._t);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.Zc(e)},n.prototype.lu=function(t){var e={};e.database=pe(this.serializer),e.removeTarget=t,this.Zc(e)},n}(eo),ro=function(t){function n(e,n,r,i,o){var u=this;return(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,u._u=!1,u}return(0,e.__extends)(n,t),Object.defineProperty(n.prototype,"fu",{get:function(){return this._u},enumerable:!1,configurable:!0}),n.prototype.start=function(){this._u=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},n.prototype.eu=function(){this._u&&this.du([])},n.prototype.ou=function(t){return this.Qc.uu("Write",t)},n.prototype.onMessage=function(t){if(_(!!t.streamToken),this.lastStreamToken=t.streamToken,this._u){this.Si.reset();var e=function(t,e){return t&&t.length>0?(_(void 0!==e),t.map(function(t){return function(t,e){var n=t.updateTime?ue(t.updateTime):ue(e);n.isEqual(R.min())&&(n=ue(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new We(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=ue(t.commitTime);return this.listener.wu(n,e)}return _(!t.writeResults||0===t.writeResults.length),this._u=!0,this.listener.Eu()},n.prototype.Tu=function(){var t={};t.database=pe(this.serializer),this.Zc(t)},n.prototype.du=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return ye(e.serializer,t)})};this.Zc(n)},n}(eo),io=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Qc=n,i.serializer=r,i.Iu=!1,i}return(0,e.__extends)(n,t),n.prototype.mu=function(){if(this.Iu)throw new I(b.FAILED_PRECONDITION,"The client has already been terminated.")},n.prototype.Au=function(t,e,n){var r=this;return this.mu(),this.credentials.getToken().then(function(i){return r.Qc.Au(t,e,n,i)}).catch(function(t){throw t.code===b.UNAUTHENTICATED&&r.credentials.m(),t})},n.prototype.Ru=function(t,e,n){var r=this;return this.mu(),this.credentials.getToken().then(function(i){return r.Qc.Ru(t,e,n,i)}).catch(function(t){throw t.code===b.UNAUTHENTICATED&&r.credentials.m(),t})},n.prototype.terminate=function(){this.Iu=!1},n}(function(){}),oo=function(){function t(t,e){this.di=t,this.Pu=e,this.state="Unknown",this.gu=0,this.yu=null,this.Vu=!0}return t.prototype.pu=function(){var t=this;0===this.gu&&(this.vu("Unknown"),this.yu=this.di.Us("online_state_timeout",1e4,function(){return t.yu=null,t.bu("Backend didn't respond within 10 seconds."),t.vu("Offline"),Promise.resolve()}))},t.prototype.Su=function(t){"Online"===this.state?this.vu("Unknown"):(this.gu++,this.gu>=1&&(this.Du(),this.bu("Connection failed 1 times. Most recent error: "+t.toString()),this.vu("Offline")))},t.prototype.set=function(t){this.Du(),this.gu=0,"Online"===t&&(this.Vu=!1),this.vu(t)},t.prototype.vu=function(t){t!==this.state&&(this.state=t,this.Pu(t))},t.prototype.bu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vu?(v(e),this.Vu=!1):d("OnlineStateTracker",e)},t.prototype.Du=function(){null!==this.yu&&(this.yu.cancel(),this.yu=null)},t}(),uo=function(t,n,r,i,o){var u=this;this.Cu=t,this.Nu=n,this.di=r,this.xu={},this.Fu=[],this.Ou=new Map,this.Mu=new Set,this.ku=[],this.$u=o,this.$u.Lu(function(t){r.Ri(function(){return(0,e.__awaiter)(u,void 0,void 0,function(){return(0,e.__generator)(this,function(t){switch(t.label){case 0:return yo(this)?(d("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return(n=w(t)).Mu.add(4),[4,ao(n)];case 1:return e.sent(),n.Bu.set("Unknown"),n.Mu.delete(4),[4,so(n)];case 2:return e.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bu=new oo(r,i)};function so(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,e.__generator)(this,function(e){switch(e.label){case 0:if(!yo(t))return[3,4];n=0,r=t.ku,e.label=1;case 1:return n<r.length?[4,(0,r[n])(!0)]:[3,4];case 2:e.sent(),e.label=3;case 3:return n++,[3,1];case 4:return[2]}})})}function ao(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,e.__generator)(this,function(e){switch(e.label){case 0:n=0,r=t.ku,e.label=1;case 1:return n<r.length?[4,(0,r[n])(!1)]:[3,4];case 2:e.sent(),e.label=3;case 3:return n++,[3,1];case 4:return[2]}})})}function co(t,e){var n=w(t);n.Ou.has(e.targetId)||(n.Ou.set(e.targetId,e),vo(n)?po(n):So(n).zc()&&fo(n,e))}function ho(t,e){var n=w(t),r=So(n);n.Ou.delete(e),r.zc()&&lo(n,e),0===n.Ou.size&&(r.zc()?r.Yc():yo(n)&&n.Bu.set("Unknown"))}function fo(t,e){t.qu.De(e.targetId),So(t).hu(e)}function lo(t,e){t.qu.De(e),So(t).lu(e)}function po(t){t.qu=new Nt({Xe:function(e){return t.xu.Xe(e)},Ze:function(e){return t.Ou.get(e)||null}}),So(t).start(),t.Bu.pu()}function vo(t){return yo(t)&&!So(t).Gc()&&t.Ou.size>0}function yo(t){return 0===w(t).Mu.size}function go(t){t.qu=void 0}function mo(t){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){return t.Ou.forEach(function(e,n){fo(t,e)}),[2]})})}function _o(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){return go(t),vo(t)?(t.Bu.Su(n),po(t)):t.Bu.set("Unknown"),[2]})})}function wo(t,n,r){return(0,e.__awaiter)(this,void 0,void 0,function(){var i,o,u;return(0,e.__generator)(this,function(s){switch(s.label){case 0:if(t.Bu.set("Online"),!(n instanceof Et&&2===n.state&&n.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o,u;return(0,e.__generator)(this,function(e){switch(e.label){case 0:r=n.cause,i=0,o=n.targetIds,e.label=1;case 1:return i<o.length?(u=o[i],t.Ou.has(u)?[4,t.xu.Uu(u,r)]:[3,3]):[3,5];case 2:e.sent(),t.Ou.delete(u),t.qu.removeTarget(u),e.label=3;case 3:e.label=4;case 4:return i++,[3,1];case 5:return[2]}})})}(t,n)];case 2:return s.sent(),[3,5];case 3:return i=s.sent(),d("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),i),[4,bo(t,i)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(n instanceof bt?t.qu.$e(n):n instanceof It?t.qu.je(n):t.qu.qe(n),r.isEqual(R.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Ki(t.Cu)];case 8:return o=s.sent(),r.F(o)>=0?[4,function(t,e){var n=t.qu.He(e);return n.re.forEach(function(n,r){if(n.resumeToken.ht()>0){var i=t.Ou.get(r);i&&t.Ou.set(r,i.wt(n.resumeToken,e))}}),n.oe.forEach(function(e){var n=t.Ou.get(e);if(n){t.Ou.set(e,n.wt(H.lt,n.ft)),lo(t,e);var r=new J(n.target,e,1,n.sequenceNumber);fo(t,r)}}),t.xu.Qu(n)}(t,r)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return d("RemoteStore","Failed to raise snapshot:",u=s.sent()),[4,bo(t,u)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function bo(t,n,r){return(0,e.__awaiter)(this,void 0,void 0,function(){var i=this;return(0,e.__generator)(this,function(o){switch(o.label){case 0:if(!lr(n))throw n;return t.Mu.add(1),[4,ao(t)];case 1:return o.sent(),t.Bu.set("Offline"),r||(r=function(){return Ki(t.Cu)}),t.di.Mi(function(){return(0,e.__awaiter)(i,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return d("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return e.sent(),t.Mu.delete(1),[4,so(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function Io(t,e){return e().catch(function(n){return bo(t,n,e)})}function Eo(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n,r,i,o,u;return(0,e.__generator)(this,function(e){switch(e.label){case 0:n=w(t),r=Po(n),i=n.Fu.length>0?n.Fu[n.Fu.length-1].batchId:-1,e.label=1;case 1:if(!function(t){return yo(t)&&t.Fu.length<10}(n))return[3,7];e.label=2;case 2:return e.trys.push([2,4,,6]),[4,Qi(n.Cu,i)];case 3:return null===(o=e.sent())?(0===n.Fu.length&&r.Yc(),[3,7]):(i=o.batchId,function(t,e){t.Fu.push(e);var n=Po(t);n.zc()&&n.fu&&n.du(e.mutations)}(n,o),[3,6]);case 4:return u=e.sent(),[4,bo(n,u)];case 5:return e.sent(),[3,6];case 6:return[3,1];case 7:return To(n)&&No(n),[2]}})})}function To(t){return yo(t)&&!Po(t).Gc()&&t.Fu.length>0}function No(t){Po(t).start()}function Ao(t){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){return Po(t).Tu(),[2]})})}function xo(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n,r,i,o;return(0,e.__generator)(this,function(e){for(n=Po(t),r=0,i=t.Fu;r<i.length;r++)o=i[r],n.du(o.mutations);return[2]})})}function Do(t,n,r){return(0,e.__awaiter)(this,void 0,void 0,function(){var i,o;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return i=t.Fu.shift(),o=$n.from(i,n,r),[4,Io(t,function(){return t.xu.Ku(o)})];case 1:return e.sent(),[4,Eo(t)];case 2:return e.sent(),[2]}})})}function ko(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(r){switch(r.label){case 0:return n&&Po(t).fu?[4,function(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return Z(i=n.code)&&i!==b.ABORTED?(r=t.Fu.shift(),Po(t).Jc(),[4,Io(t,function(){return t.xu.Wu(r.batchId,n)})]):[3,3];case 1:return e.sent(),[4,Eo(t)];case 2:e.sent(),e.label=3;case 3:return[2]}})})}(t,n)]:[3,2];case 1:r.sent(),r.label=2;case 2:return To(t)&&No(t),[2]}})})}function Oo(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r=w(t),n?(r.Mu.delete(2),[4,so(r)]):[3,2];case 1:return e.sent(),[3,5];case 2:return n?[3,4]:(r.Mu.add(2),[4,ao(r)]);case 3:e.sent(),r.Bu.set("Unknown"),e.label=4;case 4:e.label=5;case 5:return[2]}})})}function So(t){var n=this;return t.ju||(t.ju=function(t,e,n){var r=w(t);return r.mu(),new no(e,r.Qc,r.credentials,r.serializer,n)}(t.Nu,t.di,{cu:mo.bind(null,t),nu:_o.bind(null,t),au:wo.bind(null,t)}),t.ku.push(function(r){return(0,e.__awaiter)(n,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r?(t.ju.Jc(),vo(t)?po(t):t.Bu.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.ju.stop()];case 2:e.sent(),go(t),e.label=3;case 3:return[2]}})})})),t.ju}function Po(t){var n=this;return t.Gu||(t.Gu=function(t,e,n){var r=w(t);return r.mu(),new ro(e,r.Qc,r.credentials,r.serializer,n)}(t.Nu,t.di,{cu:Ao.bind(null,t),nu:ko.bind(null,t),Eu:xo.bind(null,t),wu:Do.bind(null,t)}),t.ku.push(function(r){return(0,e.__awaiter)(n,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r?(t.Gu.Jc(),[4,Eo(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Gu.stop()];case 3:e.sent(),t.Fu.length>0&&(d("RemoteStore","Stopping write stream with "+t.Fu.length+" pending writes"),t.Fu=[]),e.label=4;case 4:return[2]}})})})),t.Gu}var Co=function(){this.zu=void 0,this.listeners=[]},Ro=function(){this.queries=new Jn(function(t){return kn(t)},Dn),this.onlineState="Unknown",this.Hu=new Set};function Vo(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o,u,s,a,c;return(0,e.__generator)(this,function(e){switch(e.label){case 0:if(r=w(t),i=n.query,o=!1,(u=r.queries.get(i))||(o=!0,u=new Co),!o)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),s=u,[4,r.Ju(i)];case 2:return s.zu=e.sent(),[3,4];case 3:return a=e.sent(),c=Ir(a,"Initialization of query '"+On(n.query)+"' failed"),[2,void n.onError(c)];case 4:return r.queries.set(i,u),u.listeners.push(n),n.Yu(r.onlineState),u.zu&&n.Xu(u.zu)&&Mo(r),[2]}})})}function Lo(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o,u,s;return(0,e.__generator)(this,function(e){return r=w(t),i=n.query,o=!1,(u=r.queries.get(i))&&(s=u.listeners.indexOf(n))>=0&&(u.listeners.splice(s,1),o=0===u.listeners.length),o?[2,(r.queries.delete(i),r.Zu(i))]:[2]})})}function Uo(t,e){for(var n=w(t),r=!1,i=0,o=e;i<o.length;i++){var u=o[i],s=u.query,a=n.queries.get(s);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].Xu(u)&&(r=!0);a.zu=u}}r&&Mo(n)}function qo(t,e,n){var r=w(t),i=r.queries.get(e);if(i)for(var o=0,u=i.listeners;o<u.length;o++)u[o].onError(n);r.queries.delete(e)}function Mo(t){t.Hu.forEach(function(t){t.next()})}var jo=function(){function t(t,e,n){this.query=t,this.ta=e,this.ea=!1,this.na=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new mt(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}var o=!1;return this.ea?this.sa(t)&&(this.ta.next(t),o=!0):this.ia(t,this.onlineState)&&(this.ra(t),o=!0),this.na=t,o},t.prototype.onError=function(t){this.ta.error(t)},t.prototype.Yu=function(t){this.onlineState=t;var e=!1;return this.na&&!this.ea&&this.ia(this.na,t)&&(this.ra(this.na),e=!0),e},t.prototype.ia=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.oa&&n||t.docs.W()&&"Offline"!==e)},t.prototype.sa=function(t){if(t.docChanges.length>0)return!0;var e=this.na&&this.na.hasPendingWrites!==t.hasPendingWrites;return!(!t.ne&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.ra=function(t){t=mt.ie(t.query,t.docs,t.ee,t.fromCache),this.ea=!0,this.ta.next(t)},t}(),Fo=function(){function t(){this.ca=new it(zo.ua),this.aa=new it(zo.ha)}return t.prototype.W=function(){return this.ca.W()},t.prototype.Do=function(t,e){var n=new zo(t,e);this.ca=this.ca.add(n),this.aa=this.aa.add(n)},t.prototype.la=function(t,e){var n=this;t.forEach(function(t){return n.Do(t,e)})},t.prototype.No=function(t,e){this._a(new zo(t,e))},t.prototype.fa=function(t,e){var n=this;t.forEach(function(t){return n.No(t,e)})},t.prototype.da=function(t){var e=this,n=new M(new L([])),r=new zo(n,t),i=new zo(n,t+1),o=[];return this.aa.Kt([r,i],function(t){e._a(t),o.push(t.key)}),o},t.prototype.wa=function(){var t=this;this.ca.forEach(function(e){return t._a(e)})},t.prototype._a=function(t){this.ca=this.ca.delete(t),this.aa=this.aa.delete(t)},t.prototype.Ea=function(t){var e=new M(new L([])),n=new zo(e,t),r=new zo(e,t+1),i=pt();return this.aa.Kt([n,r],function(t){i=i.add(t.key)}),i},t.prototype.Qr=function(t){var e=new zo(t,0),n=this.ca.jt(e);return null!==n&&t.isEqual(n.key)},t}(),zo=function(){function t(t,e){this.key=t,this.Ta=e}return t.ua=function(t,e){return M.$(t.key,e.key)||O(t.Ta,e.Ta)},t.ha=function(t,e){return O(t.Ta,e.Ta)||M.$(t.key,e.key)},t}();function Bo(t,e){return"firestore_clients_"+t+"_"+e}function Go(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.u()&&(r+="_"+e.uid),r}function Ko(t,e){return"firestore_targets_"+t+"_"+e}var Wo=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Ia=function(e,n,r){var i=JSON.parse(r),o="object"==a(i)&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==a(i.error)),u=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(u=new I(i.error.code,i.error.message)),o?new t(e,n,i.state,u):(v("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Qo=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Ia=function(e,n){var r=JSON.parse(n),i="object"==a(r)&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==a(r.error)),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new I(r.error.code,r.error.message)),i?new t(e,r.state,o):(v("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Ho=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Ia=function(e,n){for(var r=JSON.parse(n),i="object"==a(r)&&r.activeTargetIds instanceof Array,o=vt(),u=0;i&&u<r.activeTargetIds.length;++u)i=z(r.activeTargetIds[u]),o=o.add(r.activeTargetIds[u]);return i?new t(e,o):(v("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Yo=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Ia=function(e){var n=JSON.parse(e);return"object"==a(n)&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(v("SharedClientState","Failed to parse online state: "+e),null)},t}(),$o=function(){function t(){this.activeTargetIds=vt()}return t.prototype.Aa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Ra=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ma=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Jo=function(){function t(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.Pa=r,this.ga=null,this.Pu=null,this.ps=null,this.ya=this.Va.bind(this),this.pa=new et(O),this.lr=!1,this.va=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ba=Bo(this.persistenceKey,this.Pa),this.Sa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.pa=this.pa.Tt(this.Pa,new $o),this.Da=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ca=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Na=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.xa=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Fa=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.ya)}return t.Gs=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,o,u,s,a,c,h,f,l=this;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,this.ga.Ic()];case 1:for(t=e.sent(),n=0,r=t;n<r.length;n++)(i=r[n])!==this.Pa&&(o=this.getItem(Bo(this.persistenceKey,i)))&&(u=Ho.Ia(i,o))&&(this.pa=this.pa.Tt(u.clientId,u));for(this.Oa(),(s=this.storage.getItem(this.xa))&&(a=this.Ma(s))&&this.ka(a),c=0,h=this.va;c<h.length;c++)f=h[c],this.Va(f);return this.va=[],this.window.addEventListener("unload",function(){return l.fc()}),this.lr=!0,[2]}})})},t.prototype.Ss=function(t){this.setItem(this.Sa,JSON.stringify(t))},t.prototype.$a=function(){return this.La(this.pa)},t.prototype.Ba=function(t){var e=!1;return this.pa.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.qa=function(t){this.Ua(t,"pending")},t.prototype.Qa=function(t,e,n){this.Ua(t,e,n),this.Ka(t)},t.prototype.Wa=function(t){var e="not-current";if(this.Ba(t)){var n=this.storage.getItem(Ko(this.persistenceKey,t));if(n){var r=Qo.Ia(t,n);r&&(e=r.state)}}return this.ja.Aa(t),this.Oa(),e},t.prototype.Ga=function(t){this.ja.Ra(t),this.Oa()},t.prototype.za=function(t){return this.ja.activeTargetIds.has(t)},t.prototype.Ha=function(t){this.removeItem(Ko(this.persistenceKey,t))},t.prototype.Ja=function(t,e,n){this.Ya(t,e,n)},t.prototype.Xa=function(t,e,n){var r=this;e.forEach(function(t){r.Ka(t)}),this.currentUser=t,n.forEach(function(t){r.qa(t)})},t.prototype.Za=function(t){this.th(t)},t.prototype.eh=function(){this.nh()},t.prototype.fc=function(){this.lr&&(this.window.removeEventListener("storage",this.ya),this.removeItem(this.ba),this.lr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return d("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){d("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){d("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Va=function(t){var n=this,r=t;if(r.storageArea===this.storage){if(d("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ba)return void v("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Cs.Mi(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){var t,n,i,o,u,s;return(0,e.__generator)(this,function(e){if(this.lr){if(null!==r.key)if(this.Da.test(r.key)){if(null==r.newValue)return t=this.sh(r.key),[2,this.ih(t,null)];if(n=this.rh(r.key,r.newValue))return[2,this.ih(n.clientId,n)]}else if(this.Ca.test(r.key)){if(null!==r.newValue&&(i=this.oh(r.key,r.newValue)))return[2,this.uh(i)]}else if(this.Na.test(r.key)){if(null!==r.newValue&&(o=this.ah(r.key,r.newValue)))return[2,this.hh(o)]}else if(r.key===this.xa){if(null!==r.newValue&&(u=this.Ma(r.newValue)))return[2,this.ka(u)]}else if(r.key===this.Sa)(s=function(t){var e=sr.Ds;if(null!=t)try{var n=JSON.parse(t);_("number"==typeof n),e=n}catch(t){v("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(r.newValue))!==sr.Ds&&this.ps(s);else if(r.key===this.Fa)return[2,this.ga.lh()]}else this.va.push(r);return[2]})})})}},Object.defineProperty(t.prototype,"ja",{get:function(){return this.pa.get(this.Pa)},enumerable:!1,configurable:!0}),t.prototype.Oa=function(){this.setItem(this.ba,this.ja.ma())},t.prototype.Ua=function(t,e,n){var r=new Wo(this.currentUser,t,e,n),i=Go(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ma())},t.prototype.Ka=function(t){var e=Go(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.th=function(t){var e={clientId:this.Pa,onlineState:t};this.storage.setItem(this.xa,JSON.stringify(e))},t.prototype.Ya=function(t,e,n){var r=Ko(this.persistenceKey,t),i=new Qo(t,e,n);this.setItem(r,i.ma())},t.prototype.nh=function(){this.setItem(this.Fa,"value-not-used")},t.prototype.sh=function(t){var e=this.Da.exec(t);return e?e[1]:null},t.prototype.rh=function(t,e){var n=this.sh(t);return Ho.Ia(n,e)},t.prototype.oh=function(t,e){var n=this.Ca.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Wo.Ia(new f(i),r,e)},t.prototype.ah=function(t,e){var n=this.Na.exec(t),r=Number(n[1]);return Qo.Ia(r,e)},t.prototype.Ma=function(t){return Yo.Ia(t)},t.prototype.uh=function(t){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.ga._h(t.batchId,t.state,t.error)]:(d("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.hh=function(t){return this.ga.fh(t.targetId,t.state,t.error)},t.prototype.ih=function(t,e){var n=this,r=e?this.pa.Tt(t,e):this.pa.remove(t),i=this.La(this.pa),o=this.La(r),u=[],s=[];return o.forEach(function(t){i.has(t)||u.push(t)}),i.forEach(function(t){o.has(t)||s.push(t)}),this.ga.dh(u,s).then(function(){n.pa=r})},t.prototype.ka=function(t){this.pa.get(t.clientId)&&this.Pu(t.onlineState)},t.prototype.La=function(t){var e=vt();return t.forEach(function(t,n){e=e.Gt(n.activeTargetIds)}),e},t}(),Xo=function(){function t(){this.wh=new $o,this.Eh={},this.Pu=null,this.ps=null}return t.prototype.qa=function(t){},t.prototype.Qa=function(t,e,n){},t.prototype.Wa=function(t){return this.wh.Aa(t),this.Eh[t]||"not-current"},t.prototype.Ja=function(t,e,n){this.Eh[t]=e},t.prototype.Ga=function(t){this.wh.Ra(t)},t.prototype.za=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.Ha=function(t){delete this.Eh[t]},t.prototype.$a=function(){return this.wh.activeTargetIds},t.prototype.Ba=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.start=function(){return this.wh=new $o,Promise.resolve()},t.prototype.Xa=function(t,e,n){},t.prototype.Za=function(t){},t.prototype.fc=function(){},t.prototype.Ss=function(t){},t.prototype.eh=function(){},t}(),Zo=function(t){this.key=t},tu=function(t){this.key=t},eu=function(){function t(t,e){this.query=t,this.Th=e,this.Ih=null,this.le=!1,this.mh=pt(),this.ee=pt(),this.Ah=Pn(t),this.Rh=new yt(this.Ah)}return Object.defineProperty(t.prototype,"Ph",{get:function(){return this.Th},enumerable:!1,configurable:!0}),t.prototype.gh=function(t,e){var n=this,r=e?e.yh:new gt,i=e?e.Rh:this.Rh,o=e?e.ee:this.ee,u=i,s=!1,a=wn(this.query)&&i.size===this.query.limit?i.last():null,c=bn(this.query)&&i.size===this.query.limit?i.first():null;if(t.Pt(function(t,e){var h=i.get(t),f=e instanceof dn?e:null;f&&(f=Sn(n.query,f)?f:null);var l=!!h&&n.ee.has(h.key),p=!!f&&(f.an||n.ee.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Vh(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.Ah(f,a)>0||c&&n.Ah(f,c)<0)&&(s=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(s=!0)),d&&(f?(u=u.add(f),o=p?o.add(t):o.delete(t)):(u=u.delete(t),o=o.delete(t)))}),wn(this.query)||bn(this.query))for(;u.size>this.query.limit;){var h=wn(this.query)?u.last():u.first();u=u.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Rh:u,yh:r,ph:s,ee:o}},t.prototype.Vh=function(t,e){return t.an&&e.hasCommittedMutations&&!e.an},t.prototype.Zn=function(t,e,n){var r=this,i=this.Rh;this.Rh=t.Rh,this.ee=t.ee;var o=t.yh.Zt();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return m()}};return n(t)-n(e)}(t.type,e.type)||r.Ah(t.doc,e.doc)}),this.bh(n);var u=e?this.Sh():[],s=0===this.mh.size&&this.le?1:0,a=s!==this.Ih;return this.Ih=s,0!==o.length||a?{snapshot:new mt(this.query,t.Rh,i,o,t.ee,0===s,a,!1),Dh:u}:{Dh:u}},t.prototype.Yu=function(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({Rh:this.Rh,yh:new gt,ee:this.ee,ph:!1},!1)):{Dh:[]}},t.prototype.Ch=function(t){return!this.Th.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).an},t.prototype.bh=function(t){var e=this;t&&(t._e.forEach(function(t){return e.Th=e.Th.add(t)}),t.fe.forEach(function(t){}),t.de.forEach(function(t){return e.Th=e.Th.delete(t)}),this.le=t.le)},t.prototype.Sh=function(){var t=this;if(!this.le)return[];var e=this.mh;this.mh=pt(),this.Rh.forEach(function(e){t.Ch(e.key)&&(t.mh=t.mh.add(e.key))});var n=[];return e.forEach(function(e){t.mh.has(e)||n.push(new tu(e))}),this.mh.forEach(function(t){e.has(t)||n.push(new Zo(t))}),n},t.prototype.Nh=function(t){this.Th=t.Bc,this.mh=pt();var e=this.gh(t.documents);return this.Zn(e,!0)},t.prototype.xh=function(){return mt.ie(this.query,this.Rh,this.ee,0===this.Ih)},t}(),nu=function(t,e,n){this.query=t,this.targetId=e,this.view=n},ru=function(t){this.key=t,this.Fh=!1},iu=function(){function t(t,e,n,r,i,o){this.Cu=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new Jn(function(t){return kn(t)},Dn),this.qh=new Map,this.Uh=[],this.Qh=new et(M.$),this.Kh=new Map,this.Wh=new Fo,this.jh={},this.Gh=new Map,this.zh=Di._o(),this.onlineState="Unknown",this.Hh=void 0}return Object.defineProperty(t.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),t}();function ou(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o,u,s,a;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r=Ru(t),(u=r.Bh.get(n))?(i=u.targetId,r.kh.Wa(i),o=u.view.xh(),[3,4]):[3,1];case 1:return[4,Hi(r.Cu,An(n))];case 2:return s=e.sent(),a=r.kh.Wa(s.targetId),i=s.targetId,[4,uu(r,n,i,"current"===a)];case 3:o=e.sent(),r.Jh&&co(r.Oh,s),e.label=4;case 4:return[2,o]}})})}function uu(t,n,r,i){return(0,e.__awaiter)(this,void 0,void 0,function(){var o,u,s,a,c,h;return(0,e.__generator)(this,function(f){switch(f.label){case 0:return t.Yh=function(n,r,i){return function(t,n,r,i){return(0,e.__awaiter)(this,void 0,void 0,function(){var o,u,s;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return(o=n.view.gh(r)).ph?[4,$i(t.Cu,n.query,!1).then(function(t){var e=t.documents;return n.view.gh(e,o)})]:[3,2];case 1:o=e.sent(),e.label=2;case 2:return u=i&&i.re.get(n.targetId),s=n.view.Zn(o,t.Jh,u),[2,(_u(t,n.targetId,s.Dh),s.snapshot)]}})})}(t,n,r,i)},[4,$i(t.Cu,n,!0)];case 1:return o=f.sent(),u=new eu(n,o.Bc),s=u.gh(o.documents),a=wt.he(r,i&&"Offline"!==t.onlineState),c=u.Zn(s,t.Jh,a),_u(t,r,c.Dh),h=new nu(n,r,u),[2,(t.Bh.set(n,h),t.qh.has(r)?t.qh.get(r).push(n):t.qh.set(r,[n]),c.snapshot)]}})})}function su(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r=w(t),i=r.Bh.get(n),(o=r.qh.get(i.targetId)).length>1?[2,(r.qh.set(i.targetId,o.filter(function(t){return!Dn(t,n)})),void r.Bh.delete(n))]:r.Jh?(r.kh.Ga(i.targetId),r.kh.Ba(i.targetId)?[3,2]:[4,Yi(r.Cu,i.targetId,!1).then(function(){r.kh.Ha(i.targetId),ho(r.Oh,i.targetId),gu(r,i.targetId)}).catch(to)]):[3,3];case 1:e.sent(),e.label=2;case 2:return[3,5];case 3:return gu(r,i.targetId),[4,Yi(r.Cu,i.targetId,!0)];case 4:e.sent(),e.label=5;case 5:return[2]}})})}function au(t,n,r){return(0,e.__awaiter)(this,void 0,void 0,function(){var i,o,u,s;return(0,e.__generator)(this,function(e){switch(e.label){case 0:i=Vu(t),e.label=1;case 1:return e.trys.push([1,5,,6]),[4,function(t,e){var n,r=w(t),i=C.now(),o=e.reduce(function(t,e){return t.add(e.key)},pt());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Oc._s(t,o).next(function(o){n=o;for(var u=[],s=0,a=e;s<a.length;s++){var c=a[s],h=Xe(c,n.get(c.key));null!=h&&u.push(new nn(c.key,h,ln(h.proto.mapValue),Qe.exists(!0)))}return r.rs.Sr(t,i,u,e)})}).then(function(t){var e=t.vn(n);return{batchId:t.batchId,Qn:e}})}(i.Cu,n)];case 2:return o=e.sent(),i.kh.qa(o.batchId),function(t,e,n){var r=t.jh[t.currentUser.h()];r||(r=new et(O)),r=r.Tt(e,n),t.jh[t.currentUser.h()]=r}(i,o.batchId,r),[4,Iu(i,o.Qn)];case 3:return e.sent(),[4,Eo(i.Oh)];case 4:return e.sent(),[3,6];case 5:return u=e.sent(),s=Ir(u,"Failed to persist write"),r.reject(s),[3,6];case 6:return[2]}})})}function cu(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i;return(0,e.__generator)(this,function(e){switch(e.label){case 0:r=w(t),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,Wi(r.Cu,n)];case 2:return i=e.sent(),n.re.forEach(function(t,e){var n=r.Kh.get(e);n&&(_(t._e.size+t.fe.size+t.de.size<=1),t._e.size>0?n.Fh=!0:t.fe.size>0?_(n.Fh):t.de.size>0&&(_(n.Fh),n.Fh=!1))}),[4,Iu(r,i,n)];case 3:return e.sent(),[3,6];case 4:return[4,to(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}})})}function hu(t,e,n){var r=w(t);if(r.Jh&&0===n||!r.Jh&&1===n){var i=[];r.Bh.forEach(function(t,n){var r=n.view.Yu(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=w(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Yu(e)&&(r=!0)}),r&&Mo(n)}(r.Mh,e),i.length&&r.Lh.au(i),r.onlineState=e,r.Jh&&r.kh.Za(e)}}function fu(t,n,r){return(0,e.__awaiter)(this,void 0,void 0,function(){var i,o,u,s,a,c;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return(i=w(t)).kh.Ja(n,"rejected",r),o=i.Kh.get(n),(u=o&&o.key)?(s=(s=new et(M.$)).Tt(u,new vn(u,R.min())),a=pt().add(u),c=new _t(R.min(),new Map,new it(O),s,a),[4,cu(i,c)]):[3,2];case 1:return e.sent(),i.Qh=i.Qh.remove(u),i.Kh.delete(n),bu(i),[3,4];case 2:return[4,Yi(i.Cu,n,!1).then(function(){return gu(i,n,r)}).catch(to)];case 3:e.sent(),e.label=4;case 4:return[2]}})})}function lu(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o;return(0,e.__generator)(this,function(e){switch(e.label){case 0:r=w(t),i=n.batch.batchId,e.label=1;case 1:return e.trys.push([1,4,,6]),[4,Gi(r.Cu,n)];case 2:return o=e.sent(),yu(r,i,null),vu(r,i),r.kh.Qa(i,"acknowledged"),[4,Iu(r,o)];case 3:return e.sent(),[3,6];case 4:return[4,to(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}})})}function pu(t,n,r){return(0,e.__awaiter)(this,void 0,void 0,function(){var i,o;return(0,e.__generator)(this,function(e){switch(e.label){case 0:i=w(t),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,function(t,e){var n=w(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.rs.Cr(t,e).next(function(e){return _(null!==e),r=e.keys(),n.rs.$r(t,e)}).next(function(){return n.rs.Ur(t)}).next(function(){return n.Oc._s(t,r)})})}(i.Cu,n)];case 2:return o=e.sent(),yu(i,n,r),vu(i,n),i.kh.Qa(n,"rejected",r),[4,Iu(i,o)];case 3:return e.sent(),[3,6];case 4:return[4,to(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}})})}function du(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o,u,s;return(0,e.__generator)(this,function(e){switch(e.label){case 0:yo((r=w(t)).Oh)||d("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,function(t){var e=w(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.rs.Or(t)})}(r.Cu)];case 2:return-1===(i=e.sent())?[2,void n.resolve()]:((o=r.Gh.get(i)||[]).push(n),r.Gh.set(i,o),[3,4]);case 3:return u=e.sent(),s=Ir(u,"Initialization of waitForPendingWrites() operation failed"),n.reject(s),[3,4];case 4:return[2]}})})}function vu(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function yu(t,e,n){var r=w(t),i=r.jh[r.currentUser.h()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.jh[r.currentUser.h()]=i}}function gu(t,e,n){void 0===n&&(n=null),t.kh.Ga(e);for(var r=0,i=t.qh.get(e);r<i.length;r++){var o=i[r];t.Bh.delete(o),n&&t.Lh.Xh(o,n)}t.qh.delete(e),t.Jh&&t.Wh.da(e).forEach(function(e){t.Wh.Qr(e)||mu(t,e)})}function mu(t,e){var n=t.Qh.get(e);null!==n&&(ho(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),bu(t))}function _u(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Zo?(t.Wh.Do(o.key,e),wu(t,o)):o instanceof tu?(d("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.No(o.key,e),t.Wh.Qr(o.key)||mu(t,o.key)):m()}}function wu(t,e){var n=e.key;t.Qh.get(n)||(d("SyncEngine","New document in limbo: "+n),t.Uh.push(n),bu(t))}function bu(t){for(;t.Uh.length>0&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new ru(e)),t.Qh=t.Qh.Tt(e,n),co(t.Oh,new J(An(_n(e.path)),n,2,sr.Ds))}}function Iu(t,n,r){return(0,e.__awaiter)(this,void 0,void 0,function(){var i,o,u,s;return(0,e.__generator)(this,function(a){switch(a.label){case 0:return i=w(t),o=[],u=[],s=[],i.Bh.W()?[3,3]:(i.Bh.forEach(function(t,e){s.push(i.Yh(e,n,r).then(function(t){if(t){i.Jh&&i.kh.Ja(e.targetId,t.fromCache?"not-current":"current"),o.push(t);var n=ur.Vs(e.targetId,t);u.push(n)}}))}),[4,Promise.all(s)]);case 1:return a.sent(),i.Lh.au(o),[4,function(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o,u,s,a,c,h,f;return(0,e.__generator)(this,function(e){switch(e.label){case 0:r=w(t),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return Xn.forEach(n,function(e){return Xn.forEach(e.gs,function(n){return r.persistence.Vr.Do(t,e.targetId,n)}).next(function(){return Xn.forEach(e.ys,function(n){return r.persistence.Vr.No(t,e.targetId,n)})})})})];case 2:return e.sent(),[3,4];case 3:if(!lr(i=e.sent()))throw i;return d("LocalStore","Failed to update sequence numbers: "+i),[3,4];case 4:for(o=0,u=n;o<u.length;o++)s=u[o],a=s.targetId,s.fromCache||(c=r.Cc.get(a),h=c.ft,f=c.Et(h),r.Cc=r.Cc.Tt(a,f));return[2]}})})}(i.Cu,u)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function Eu(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return(r=w(t)).currentUser.isEqual(n)?[3,3]:(d("SyncEngine","User change. New user:",n.h()),[4,Bi(r.Cu,n)]);case 1:return i=e.sent(),r.currentUser=n,function(t,e){t.Gh.forEach(function(t){t.forEach(function(t){t.reject(new I(b.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Gh.clear()}(r),r.kh.Xa(n,i.$c,i.Lc),[4,Iu(r,i.kc)];case 2:e.sent(),e.label=3;case 3:return[2]}})})}function Tu(t,e){var n=w(t),r=n.Kh.get(e);if(r&&r.Fh)return pt().add(r.key);var i=pt(),o=n.qh.get(e);if(!o)return i;for(var u=0,s=o;u<s.length;u++){var a=s[u],c=n.Bh.get(a);i=i.Gt(c.view.Ph)}return i}function Nu(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,$i((r=w(t)).Cu,n.query,!0)];case 1:return i=e.sent(),o=n.view.Nh(i),[2,(r.Jh&&_u(r,n.targetId,o.Dh),o)]}})})}function Au(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n;return(0,e.__generator)(this,function(e){return[2,Xi((n=w(t)).Cu).then(function(t){return Iu(n,t)})]})})}function xu(t,n,r,i){return(0,e.__awaiter)(this,void 0,void 0,function(){var o,u;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,function(t,e){var n=w(t),r=w(n.rs);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.Nr(t,e).next(function(e){return e?n.Oc._s(t,e):Xn.resolve(null)})})}((o=w(t)).Cu,n)];case 1:return null===(u=e.sent())?[3,6]:"pending"!==r?[3,3]:[4,Eo(o.Oh)];case 2:return e.sent(),[3,4];case 3:"acknowledged"===r||"rejected"===r?(yu(o,n,i||null),vu(o,n),function(t,e){w(w(t).rs).Br(e)}(o.Cu,n)):m(),e.label=4;case 4:return[4,Iu(o,u)];case 5:return e.sent(),[3,7];case 6:d("SyncEngine","Cannot apply mutation batch with id: "+n),e.label=7;case 7:return[2]}})})}function Du(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o,u,s,a,c,h;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return Ru(r=w(t)),Vu(r),!0!==n||!0===r.Hh?[3,3]:(i=r.kh.$a(),[4,ku(r,i.H())]);case 1:return o=e.sent(),r.Hh=!0,[4,Oo(r.Oh,!0)];case 2:for(e.sent(),u=0,s=o;u<s.length;u++)a=s[u],co(r.Oh,a);return[3,7];case 3:return!1!==n||!1===r.Hh?[3,7]:(c=[],h=Promise.resolve(),r.qh.forEach(function(t,e){r.kh.za(e)?c.push(e):h=h.then(function(){return gu(r,e),Yi(r.Cu,e,!0)}),ho(r.Oh,e)}),[4,h]);case 4:return e.sent(),[4,ku(r,c)];case 5:return e.sent(),function(t){var e=w(t);e.Kh.forEach(function(t,n){ho(e.Oh,n)}),e.Wh.wa(),e.Kh=new Map,e.Qh=new et(M.$)}(r),r.Hh=!1,[4,Oo(r.Oh,!1)];case 6:e.sent(),e.label=7;case 7:return[2]}})})}function ku(t,n,r){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o,u,s,a,c,h,f,l,p,d,v,y;return(0,e.__generator)(this,function(e){switch(e.label){case 0:r=w(t),i=[],o=[],u=0,s=n,e.label=1;case 1:return u<s.length?(a=s[u],c=void 0,(h=r.qh.get(a))&&0!==h.length?[4,Hi(r.Cu,An(h[0]))]:[3,7]):[3,13];case 2:c=e.sent(),f=0,l=h,e.label=3;case 3:return f<l.length?(p=l[f],d=r.Bh.get(p),[4,Nu(r,d)]):[3,6];case 4:(v=e.sent()).snapshot&&o.push(v.snapshot),e.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,Ji(r.Cu,a)];case 8:return y=e.sent(),[4,Hi(r.Cu,y)];case 9:return c=e.sent(),[4,uu(r,Ou(y),a,!1)];case 10:e.sent(),e.label=11;case 11:i.push(c),e.label=12;case 12:return u++,[3,1];case 13:return[2,(r.Lh.au(o),i)]}})})}function Ou(t){return mn(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Su(t){var e=w(t);return w(w(e.Cu).persistence).Ic()}function Pu(t,n,r,i){return(0,e.__awaiter)(this,void 0,void 0,function(){var o,u,s;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return(o=w(t)).Hh?(d("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!o.qh.has(n))return[3,8];switch(r){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Xi(o.Cu)];case 3:return u=e.sent(),s=_t.ae(n,"current"===r),[4,Iu(o,u,s)];case 4:return e.sent(),[3,8];case 5:return[4,Yi(o.Cu,n,!0)];case 6:return e.sent(),gu(o,n,i),[3,8];case 7:m(),e.label=8;case 8:return[2]}})})}function Cu(t,n,r){return(0,e.__awaiter)(this,void 0,void 0,function(){var i,o,u,s,a,c,h,f,l,p;return(0,e.__generator)(this,function(v){switch(v.label){case 0:if(!(i=Ru(t)).Hh)return[3,10];o=0,u=n,v.label=1;case 1:return o<u.length?(s=u[o],i.qh.has(s)?(d("SyncEngine","Adding an already active target "+s),[3,5]):[4,Ji(i.Cu,s)]):[3,6];case 2:return a=v.sent(),[4,Hi(i.Cu,a)];case 3:return c=v.sent(),[4,uu(i,Ou(a),c.targetId,!1)];case 4:v.sent(),co(i.Oh,c),v.label=5;case 5:return o++,[3,1];case 6:h=function(t){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return i.qh.has(t)?[4,Yi(i.Cu,t,!1).then(function(){ho(i.Oh,t),gu(i,t)}).catch(to)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},f=0,l=r,v.label=7;case 7:return f<l.length?(p=l[f],[5,h(p)]):[3,10];case 8:v.sent(),v.label=9;case 9:return f++,[3,7];case 10:return[2]}})})}function Ru(t){var e=w(t);return e.Oh.xu.Qu=cu.bind(null,e),e.Oh.xu.Xe=Tu.bind(null,e),e.Oh.xu.Uu=fu.bind(null,e),e.Lh.au=Uo.bind(null,e.Mh),e.Lh.Xh=qo.bind(null,e.Mh),e}function Vu(t){var e=w(t);return e.Oh.xu.Ku=lu.bind(null,e),e.Oh.xu.Wu=pu.bind(null,e),e}var Lu=function(){function t(){}return t.prototype.Mc=function(t){this.Zh=t},t.prototype.ws=function(t,e,n,i){var o=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Tn.length||1===t.Tn.length&&t.Tn[0].field.tt())}(e)||n.isEqual(R.min())?this.tl(t,e):this.Zh._s(t,i).next(function(u){var s=o.el(e,u);return(wn(e)||bn(e))&&o.ph(e.limitType,s,i,n)?o.tl(t,e):(p()<=r.LogLevel.DEBUG&&d("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),On(e)),o.Zh.ws(t,e,n).next(function(t){return s.forEach(function(e){t=t.Tt(e.key,e)}),t}))})},t.prototype.el=function(t,e){var n=new it(Pn(t));return e.forEach(function(e,r){r instanceof dn&&Sn(t,r)&&(n=n.add(r))}),n},t.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.F(r)>0)},t.prototype.tl=function(t,e){return p()<=r.LogLevel.DEBUG&&d("IndexFreeQueryEngine","Using full collection scan to execute query:",On(e)),this.Zh.ws(t,e,R.min())},t}(),Uu=function(){function t(t,e){this.os=t,this.Vr=e,this.rs=[],this.nl=1,this.sl=new it(zo.ua)}return t.prototype.br=function(t){return Xn.resolve(0===this.rs.length)},t.prototype.Sr=function(t,e,n,r){var i=this.nl;this.nl++,this.rs.length>0&&this.rs[this.rs.length-1];var o=new Yn(i,e,n,r);this.rs.push(o);for(var u=0,s=r;u<s.length;u++){var a=s[u];this.sl=this.sl.add(new zo(a.key,i)),this.os.Dr(t,a.key.path.q())}return Xn.resolve(o)},t.prototype.Cr=function(t,e){return Xn.resolve(this.il(e))},t.prototype.Fr=function(t,e){var n=e+1,r=this.rl(n),i=r<0?0:r;return Xn.resolve(this.rs.length>i?this.rs[i]:null)},t.prototype.Or=function(){return Xn.resolve(0===this.rs.length?-1:this.nl-1)},t.prototype.Mr=function(t){return Xn.resolve(this.rs.slice())},t.prototype.us=function(t,e){var n=this,r=new zo(e,0),i=new zo(e,Number.POSITIVE_INFINITY),o=[];return this.sl.Kt([r,i],function(t){var e=n.il(t.Ta);o.push(e)}),Xn.resolve(o)},t.prototype.ds=function(t,e){var n=this,r=new it(O);return e.forEach(function(t){var e=new zo(t,0),i=new zo(t,Number.POSITIVE_INFINITY);n.sl.Kt([e,i],function(t){r=r.add(t.Ta)})}),Xn.resolve(this.ol(r))},t.prototype.Rs=function(t,e){var n=e.path,r=n.length+1,i=n;M.ot(i)||(i=i.child(""));var o=new zo(new M(i),0),u=new it(O);return this.sl.Wt(function(t){var e=t.key.path;return!!n.j(e)&&(e.length===r&&(u=u.add(t.Ta)),!0)},o),Xn.resolve(this.ol(u))},t.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.il(t);null!==r&&n.push(r)}),n},t.prototype.$r=function(t,e){var n=this;_(0===this.cl(e.batchId,"removed")),this.rs.shift();var r=this.sl;return Xn.forEach(e.mutations,function(i){var o=new zo(i.key,e.batchId);return r=r.delete(o),n.Vr.qr(t,i.key)}).next(function(){n.sl=r})},t.prototype.Br=function(t){},t.prototype.Qr=function(t,e){var n=new zo(e,0),r=this.sl.jt(n);return Xn.resolve(e.isEqual(r&&r.key))},t.prototype.Ur=function(t){return this.rs.length,Xn.resolve()},t.prototype.cl=function(t,e){return this.rl(t)},t.prototype.rl=function(t){return 0===this.rs.length?0:t-this.rs[0].batchId},t.prototype.il=function(t){var e=this.rl(t);return e<0||e>=this.rs.length?null:this.rs[e]},t}(),qu=function(){function t(t,e){this.os=t,this.ul=e,this.docs=new et(M.$),this.size=0}return t.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,u=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:u,readTime:n}),this.size+=u-o,this.os.Dr(t,r.path.q())},t.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Jn=function(t,e){var n=this.docs.get(e);return Xn.resolve(n?n.zn:null)},t.prototype.getEntries=function(t,e){var n=this,r=at();return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.zn:null)}),Xn.resolve(r)},t.prototype.ws=function(t,e,n){for(var r=ht(),i=new M(e.path.child("")),o=this.docs.Vt(i);o.Nt();){var u=o.Ct(),s=u.key,a=u.value,c=a.zn,h=a.readTime;if(!e.path.j(s.path))break;h.F(n)<=0||c instanceof dn&&Sn(e,c)&&(r=r.Tt(c.key,c))}return Xn.resolve(r)},t.prototype.al=function(t,e){return Xn.forEach(this.docs,function(t){return e(t)})},t.prototype.Xr=function(t){return new Mu(this)},t.prototype.eo=function(t){return Xn.resolve(this.size)},t}(),Mu=function(t){function n(e){var n=this;return(n=t.call(this)||this).no=e,n}return(0,e.__extends)(n,t),n.prototype.Zn=function(t){var e=this,n=[];return this.Qn.forEach(function(r,i){i&&i.zn?n.push(e.no.jn(t,i.zn,e.Wn(r))):e.no.Hn(r)}),Xn.qn(n)},n.prototype.Yn=function(t,e){return this.no.Jn(t,e)},n.prototype.Xn=function(t,e){return this.no.getEntries(t,e)},n}(Zn),ju=function(){function t(t){this.persistence=t,this.hl=new Jn(function(t){return K(t)},W),this.lastRemoteSnapshotVersion=R.min(),this.highestTargetId=0,this.ll=0,this._l=new Fo,this.targetCount=0,this.fl=Di.lo()}return t.prototype.Ue=function(t,e){return this.hl.forEach(function(t,n){return e(n)}),Xn.resolve()},t.prototype.To=function(t){return Xn.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Io=function(t){return Xn.resolve(this.ll)},t.prototype.fo=function(t){return this.highestTargetId=this.fl.next(),Xn.resolve(this.highestTargetId)},t.prototype.mo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),Xn.resolve()},t.prototype.Ro=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new Di(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},t.prototype.Ao=function(t,e){return this.Ro(e),this.targetCount+=1,Xn.resolve()},t.prototype.yo=function(t,e){return this.Ro(e),Xn.resolve()},t.prototype.Vo=function(t,e){return this.hl.delete(e.target),this._l.da(e.targetId),this.targetCount-=1,Xn.resolve()},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return this.hl.forEach(function(u,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.hl.delete(u),o.push(r.po(t,s.targetId)),i++)}),Xn.qn(o).next(function(){return i})},t.prototype.vo=function(t){return Xn.resolve(this.targetCount)},t.prototype.bo=function(t,e){var n=this.hl.get(e)||null;return Xn.resolve(n)},t.prototype.So=function(t,e,n){return this._l.la(e,n),Xn.resolve()},t.prototype.Co=function(t,e,n){this._l.fa(e,n);var r=this.persistence.Vr,i=[];return r&&e.forEach(function(e){i.push(r.qr(t,e))}),Xn.qn(i)},t.prototype.po=function(t,e){return this._l.da(e),Xn.resolve()},t.prototype.xo=function(t,e){var n=this._l.Ea(e);return Xn.resolve(n)},t.prototype.Qr=function(t,e){return Xn.resolve(this._l.Qr(e))},t}(),Fu=function(){function t(t){this.serializer=t,this.dl=new Map,this.wl=new Map}return t.prototype.ro=function(t,e){return Xn.resolve(this.dl.get(e))},t.prototype.oo=function(t,e){var n;return this.dl.set(e.id,{id:(n=e).id,version:n.version,createTime:ue(n.createTime)}),Xn.resolve()},t.prototype.co=function(t,e){return Xn.resolve(this.wl.get(e))},t.prototype.uo=function(t,e){var n;return this.wl.set(e.name,{name:(n=e).name,query:Br(n.bundledQuery),readTime:ue(n.readTime)}),Xn.resolve()},t}(),zu=function(){function t(t,e){var n=this;this.El={},this.ko=new sr(0),this.$o=!1,this.$o=!0,this.Vr=t(this),this.jo=new ju(this),this.os=new ni,this.ss=function(t,e){return new qu(t,function(t){return n.Vr.Tl(t)})}(this.os),this.serializer=new Cr(e),this.Go=new Fu(this.serializer)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.fc=function(){return this.$o=!1,Promise.resolve()},Object.defineProperty(t.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),t.prototype.tc=function(){},t.prototype.ec=function(){},t.prototype.Pc=function(){return this.os},t.prototype.mc=function(t){var e=this.El[t.h()];return e||(e=new Uu(this.os,this.Vr),this.El[t.h()]=e),e},t.prototype.Ac=function(){return this.jo},t.prototype.Rc=function(){return this.ss},t.prototype.gc=function(){return this.Go},t.prototype.runTransaction=function(t,e,n){var r=this;d("MemoryPersistence","Starting transaction:",t);var i=new Bu(this.ko.next());return this.Vr.Il(),n(i).next(function(t){return r.Vr.ml(i).next(function(){return t})}).Ln().then(function(t){return i.ns(),t})},t.prototype.Al=function(t,e){return Xn.Un(Object.values(this.El).map(function(n){return function(){return n.Qr(t,e)}}))},t}(),Bu=function(t){function n(e){var n=this;return(n=t.call(this)||this).Fo=e,n}return(0,e.__extends)(n,t),n}(ir),Gu=function(){function t(t){this.persistence=t,this.Rl=new Fo,this.Pl=null}return t.gl=function(e){return new t(e)},Object.defineProperty(t.prototype,"yl",{get:function(){if(this.Pl)return this.Pl;throw m()},enumerable:!1,configurable:!0}),t.prototype.Do=function(t,e,n){return this.Rl.Do(n,e),this.yl.delete(n.toString()),Xn.resolve()},t.prototype.No=function(t,e,n){return this.Rl.No(n,e),this.yl.add(n.toString()),Xn.resolve()},t.prototype.qr=function(t,e){return this.yl.add(e.toString()),Xn.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.Rl.da(e.targetId).forEach(function(t){return n.yl.add(t.toString())});var r=this.persistence.Ac();return r.xo(t,e.targetId).next(function(t){t.forEach(function(t){return n.yl.add(t.toString())})}).next(function(){return r.Vo(t,e)})},t.prototype.Il=function(){this.Pl=new Set},t.prototype.ml=function(t){var e=this,n=this.persistence.Rc().Xr();return Xn.forEach(this.yl,function(r){var i=M.st(r);return e.Vl(t,i).next(function(t){t||n.Hn(i)})}).next(function(){return e.Pl=null,n.apply(t)})},t.prototype.Sc=function(t,e){var n=this;return this.Vl(t,e).next(function(t){t?n.yl.delete(e.toString()):n.yl.add(e.toString())})},t.prototype.Tl=function(t){return 0},t.prototype.Vl=function(t,e){var n=this;return Xn.Un([function(){return Xn.resolve(n.Rl.Qr(e))},function(){return n.persistence.Ac().Qr(t,e)},function(){return n.persistence.Al(t,e)}])},t}(),Ku=function(){function t(t){this.pl=t.pl,this.vl=t.vl}return t.prototype.cu=function(t){this.bl=t},t.prototype.nu=function(t){this.Sl=t},t.prototype.onMessage=function(t){this.Dl=t},t.prototype.close=function(){this.vl()},t.prototype.send=function(t){this.pl(t)},t.prototype.Cl=function(){this.bl()},t.prototype.Nl=function(t){this.Sl(t)},t.prototype.xl=function(t){this.Dl(t)},t}(),Wu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Qu=function(t){function n(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return(0,e.__extends)(n,t),n.prototype.Ll=function(t,e,n,r){return new Promise(function(i,u){var s=new o.XhrIo;s.listenOnce(o.EventType.COMPLETE,function(){try{switch(s.getLastErrorCode()){case o.ErrorCode.NO_ERROR:var e=s.getResponseJson();d("Connection","XHR received:",JSON.stringify(e)),i(e);break;case o.ErrorCode.TIMEOUT:d("Connection",'RPC "'+t+'" timed out'),u(new I(b.DEADLINE_EXCEEDED,"Request time out"));break;case o.ErrorCode.HTTP_ERROR:var n=s.getStatus();if(d("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=r.status.toLowerCase().replace("_","-");return Object.values(b).indexOf(e)>=0?e:b.UNKNOWN}();u(new I(a,r.message))}else u(new I(b.UNKNOWN,"Server responded with status "+s.getStatus()))}else u(new I(b.UNAVAILABLE,"Connection failed."));break;default:m()}}finally{d("Connection",'RPC "'+t+'" completed.')}});var a=JSON.stringify(r);s.send(e,"POST",a,n,15)})},n.prototype.uu=function(t,e){var n=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=(0,o.createWebChannelTransport)(),u=(0,o.getStatEventTarget)(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(s.initMessageHeaders,e),(0,i.isMobileCordova)()||(0,i.isReactNative)()||(0,i.isElectron)()||(0,i.isIE)()||(0,i.isUWP)()||(0,i.isBrowserExtension)()||(s.httpHeadersOverwriteParam="$httpHeaders");var a=n.join("");d("Connection","Creating WebChannel: "+a,s);var c=r.createWebChannel(a,s),h=!1,f=!1,l=new Ku({pl:function(t){f?d("Connection","Not sending because WebChannel is closed:",t):(h||(d("Connection","Opening WebChannel transport."),c.open(),h=!0),d("Connection","WebChannel sending:",t),c.send(t))},vl:function(){return c.close()}}),p=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return p(c,o.WebChannel.EventType.OPEN,function(){f||d("Connection","WebChannel transport opened.")}),p(c,o.WebChannel.EventType.CLOSE,function(){f||(f=!0,d("Connection","WebChannel transport closed"),l.Nl())}),p(c,o.WebChannel.EventType.ERROR,function(t){f||(f=!0,y("Connection","WebChannel transport errored:",t),l.Nl(new I(b.UNAVAILABLE,"The operation could not be completed")))}),p(c,o.WebChannel.EventType.MESSAGE,function(t){var e;if(!f){var n=t.data[0];_(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){d("Connection","WebChannel received error:",i);var o=i.status,u=function(t){var e=Y[o];if(void 0!==e)return tt(e)}(),s=i.message;void 0===u&&(u=b.INTERNAL,s="Unknown error status: "+o+" with message "+i.message),f=!0,l.Nl(new I(u,s)),c.close()}else d("Connection","WebChannel received:",n),l.xl(n)}}),p(u,o.Event.STAT_EVENT,function(t){t.stat===o.Stat.PROXY?d("Connection","Detected buffering proxy"):t.stat===o.Stat.NOPROXY&&d("Connection","Detected no buffering proxy")}),setTimeout(function(){l.Cl()},0),l},n}(function(){function t(t){this.Fl=t,this.t=t.t;var e=t.ssl?"https":"http";this.Ol=e+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.Au=function(t,e,n,r){var i=this.kl(t,e);d("RestConnection","Sending: ",i,n);var o={};return this.$l(o,r),this.Ll(t,i,o,n).then(function(t){return d("RestConnection","Received: ",t),t},function(e){throw y("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Ru=function(t,e,n,r){return this.Au(t,e,n,r)},t.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1",t["Content-Type"]="text/plain",e)for(var n in e.T)e.T.hasOwnProperty(n)&&(t[n]=e.T[n])},t.prototype.kl=function(t,e){var n=Wu[t];return this.Ol+"/v1/"+e+":"+n},t}()),Hu=function(){function t(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}return t.prototype.Lu=function(t){this.Kl.push(t)},t.prototype.fc=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},t.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},t.prototype.ql=function(){d("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},t.prototype.Ql=function(){d("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},t.Gs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Yu=function(){function t(){}return t.prototype.Lu=function(t){},t.prototype.fc=function(){},t}(),$u=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return this.serializer=er(t.Fl.t),this.kh=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Cu=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return zi(this.persistence,new Lu,t.Yl,this.serializer)},t.prototype.Gl=function(t){return new zu(Gu.gl,this.serializer)},t.prototype.jl=function(t){return new Xo},t.prototype.terminate=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.fc()];case 1:return t.sent(),[4,this.persistence.fc()];case 2:return t.sent(),[2]}})})},t}(),Ju=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return(0,e.__extends)(n,t),n.prototype.initialize=function(n){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,t.prototype.initialize.call(this,n)];case 1:return e.sent(),[4,Zi(this.Cu)];case 2:return e.sent(),[4,this.Xl.initialize(this,n)];case 3:return e.sent(),[4,Vu(this.Xl.ga)];case 4:return e.sent(),[4,Eo(this.Xl.Oh)];case 5:return e.sent(),[2]}})})},n.prototype.Jl=function(t){return zi(this.persistence,new Lu,t.Yl,this.serializer)},n.prototype.Hl=function(t){var e=this.persistence.Vr.cr;return new xr(e,t.di)},n.prototype.Gl=function(t){var e=ji(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?Ar.er(this.cacheSizeBytes):Ar.ir;return new Vi(this.synchronizeTabs,e,t.clientId,n,t.di,mr(),_r(),this.serializer,this.kh,!!this.forceOwnership)},n.prototype.jl=function(t){return new Xo},n}($u),Xu=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return(0,e.__extends)(n,t),n.prototype.initialize=function(n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i=this;return(0,e.__generator)(this,function(o){switch(o.label){case 0:return[4,t.prototype.initialize.call(this,n)];case 1:return o.sent(),r=this.Xl.ga,this.kh instanceof Jo?(this.kh.ga={_h:xu.bind(null,r),fh:Pu.bind(null,r),dh:Cu.bind(null,r),Ic:Su.bind(null,r),lh:Au.bind(null,r)},[4,this.kh.start()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[4,this.persistence.Zo(function(t){return(0,e.__awaiter)(i,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,Du(this.Xl.ga,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.lr?this.zl.start(this.Cu):t||this.zl.stop()),[2]}})})})];case 4:return o.sent(),[2]}})})},n.prototype.jl=function(t){var e=mr();if(!Jo.Gs(e))throw new I(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ji(t.Fl.t,t.Fl.persistenceKey);return new Jo(e,t.di,n,t.clientId,t.Yl)},n}(Ju),Zu=function(){function t(){}return t.prototype.initialize=function(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return this.Cu?[3,2]:(this.Cu=t.Cu,this.kh=t.kh,this.Nu=this.Zl(n),this.Oh=this.t_(n),this.Mh=this.e_(n),this.ga=this.n_(n,!t.synchronizeTabs),this.kh.Pu=function(t){return hu(r.ga,t,1)},this.Oh.xu.s_=Eu.bind(null,this.ga),[4,Oo(this.Oh,this.ga.Jh)]);case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new Ro},t.prototype.Zl=function(t){var e,n=er(t.Fl.t),r=(e=t.Fl,new Qu(e));return function(t,e,n){return new io(t,r,n)}(t.credentials,0,n)},t.prototype.t_=function(t){var e,n,r,i,o,u=this;return e=this.Cu,n=this.Nu,r=t.di,i=function(t){return hu(u.ga,t,0)},o=Hu.Gs()?new Hu:new Yu,new uo(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,u){var s=new iu(t,e,n,r,i,o);return u&&(s.Hh=!0),s}(this.Cu,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},t.prototype.terminate=function(){return function(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return n=w(t),d("RemoteStore","RemoteStore shutting down."),n.Mu.add(5),[4,ao(n)];case 1:return e.sent(),n.$u.fc(),n.Bu.set("Unknown"),[2]}})})}(this.Oh)},t}(),ts=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),es=function(t){this.o_=t};function ns(t,e,n){if(!n)throw new I(b.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function rs(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new I(b.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function is(t,e,n,r){if(!0===e&&!0===r)throw new I(b.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function os(t){if(!M.ot(t))throw new I(b.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function us(t){if(M.ot(t))throw new I(b.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function ss(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==a(t)){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":m()}function as(t,e){if(t instanceof es&&(t=t.o_),!(t instanceof e)){if(e.name===t.constructor.name)throw new I(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=ss(t);throw new I(b.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function cs(t,e){if(e<=0)throw new I(b.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var hs=function(t){this.c_=t},fs=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype.u_=function(t){if(2!==t.a_)throw 1===t.a_?t.h_(this.c_+"() can only appear at the top level of your update data"):t.h_(this.c_+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null},n.prototype.isEqual=function(t){return t instanceof n},n}(hs);function ls(t,e,n){return new va({a_:3,l_:e.settings.l_,methodName:t.c_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var ps=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype.u_=function(t){return new Ke(t.path,new Le)},n.prototype.isEqual=function(t){return t instanceof n},n}(hs),ds=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return(0,e.__extends)(n,t),n.prototype.u_=function(t){var e=ls(this,t,!0),n=this.f_.map(function(t){return ba(t,e)}),r=new Ue(n);return new Ke(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(hs),vs=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return(0,e.__extends)(n,t),n.prototype.u_=function(t){var e=ls(this,t,!0),n=this.f_.map(function(t){return ba(t,e)}),r=new Me(n);return new Ke(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(hs),ys=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).d_=n,r}return(0,e.__extends)(n,t),n.prototype.u_=function(t){var e=new Fe(t.serializer,ne(t.serializer,this.d_));return new Ke(t.path,e)},n.prototype.isEqual=function(t){return this===t},n}(hs),gs=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new I(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new I(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.E_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.E_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.w_===t.w_&&this.E_===t.E_},t.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.E_}},t.prototype.C=function(t){return O(this.w_,t.w_)||O(this.E_,t.E_)},t}(),ms=function(){function t(t){this.T_=t}return t.fromBase64String=function(e){try{return new t(H.fromBase64String(e))}catch(e){throw new I(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(H.fromUint8Array(e))},t.prototype.toBase64=function(){return this.T_.toBase64()},t.prototype.toUint8Array=function(){return this.T_.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.T_.isEqual(t.T_)},t}(),_s=new Map,ws=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new I(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new I(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,is("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),bs=function(){function t(t,e){this.I_="(lite)",this.m_=new ws({}),this.A_=!1,t instanceof h?(this.R_=t,this.P_=new T):(this.g_=t,this.R_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new I(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new h(t.options.projectId)}(t),this.P_=new N(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.g_)throw new I(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.g_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y_",{get:function(){return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"V_",{get:function(){return void 0!==this.p_},enumerable:!1,configurable:!0}),t.prototype.v_=function(t){if(this.A_)throw new I(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.m_=new ws(t),void 0!==t.credentials&&(this.P_=function(t){if(!t)return new T;switch(t.type){case"gapi":var e=t.client;return _(!("object"!=a(e)||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new x(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new I(b.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.b_=function(){return this.m_},t.prototype.S_=function(){return this.A_=!0,this.m_},t.prototype._delete=function(){return this.p_||(this.p_=this.D_()),this.p_},t.prototype.D_=function(){return t=this,(e=_s.get(t))&&(d("ComponentProvider","Removing Datastore"),_s.delete(t),e.terminate()),Promise.resolve();var t,e},t}();function Is(){if("undefined"==typeof Uint8Array)throw new I(b.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Es(){if("undefined"==typeof atob)throw new I(b.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ts=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.fromBase64String=function(t){return Es(),new n(ms.fromBase64String(t))},n.fromUint8Array=function(t){return Is(),new n(ms.fromUint8Array(t))},n.prototype.toBase64=function(){return Es(),this.o_.toBase64()},n.prototype.toUint8Array=function(){return Is(),this.o_.toUint8Array()},n.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},n.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},n}(es),Ns=function(){function t(){}return t.prototype.C_=function(t,e){switch(void 0===e&&(e="none"),Vt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Bt(t.integerValue||t.doubleValue);case 3:return this.N_(t.timestampValue);case 4:return this.x_(t,e);case 5:return t.stringValue;case 6:return this.F_(Gt(t.bytesValue));case 7:return this.O_(t.referenceValue);case 8:return this.M_(t.geoPointValue);case 9:return this.k_(t.arrayValue,e);case 10:return this.L_(t.mapValue,e);default:throw m()}},t.prototype.L_=function(t,e){var n=this,r={};return kt(t.fields||{},function(t,i){r[t]=n.C_(i,e)}),r},t.prototype.M_=function(t){return new gs(Bt(t.latitude),Bt(t.longitude))},t.prototype.k_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.C_(t,e)})},t.prototype.x_=function(t,e){switch(e){case"previous":var n=Pt(t);return null==n?null:this.C_(n,e);case"estimate":return this.N_(Ct(t));default:return null}},t.prototype.N_=function(t){var e=zt(t);return new C(e.seconds,e.nanos)},t.prototype.B_=function(t,e){var n=L.Y(t);_(Se(n));var r=new h(n.get(1),n.get(3)),i=new M(n.B(5));return r.isEqual(e)||v("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),As=function(t){function n(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,e.__extends)(n,t),n.prototype.F_=function(t){return new Ts(new ms(t))},n.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return Za.q_(e,this.firestore,null)},n}(Ns),xs=function(){function t(t,e,n,r,i){this.U_=t,this.Q_=e,this.K_=n,this.W_=r,this.j_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Gs(this.U_,this.j_,this.K_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.W_},t.prototype.data=function(){if(this.W_){if(this.j_){var t=new Ds(this.U_,this.Q_,this.K_,this.W_,null);return this.j_.fromFirestore(t)}return this.Q_.C_(this.W_.En())}},t.prototype.get=function(t){if(this.W_){var e=this.W_.data().field(ks("DocumentSnapshot.get",t));if(null!==e)return this.Q_.C_(e)}},t}(),Ds=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype.data=function(){return t.prototype.data.call(this)},n}(xs);function ks(t,e){return"string"==typeof e?xa(t,e):e instanceof es?e.o_.G_:e.G_}var Os=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new I(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.G_=new q(t)}return t.prototype.isEqual=function(t){return this.G_.isEqual(t.G_)},t}(),Ss=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n)||this).z_=new br,r.I_="name"in e?e.name:"[DEFAULT]",r}return(0,e.__extends)(n,t),n.prototype.D_=function(){return this.H_||$a(this),this.H_.terminate()},n}(bs);function Ps(t,n,r){var i=this,o=new tr;return t.di.enqueue(function(){return(0,e.__awaiter)(i,void 0,void 0,function(){var i;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,Ca(t,r)];case 1:return e.sent(),[4,Ra(t,n)];case 2:return e.sent(),o.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===b.FAILED_PRECONDITION||t.code===b.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(i=e.sent()))throw i;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i),o.reject(i),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function Cs(t){if(t.y_||t.V_)throw new I(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Rs=function(t){function n(e,n,r,i,o,u){var s=this;return(s=t.call(this,e,n,r,i,u)||this).U_=e,s.J_=e,s.metadata=o,s}return(0,e.__extends)(n,t),n.prototype.exists=function(){return t.prototype.exists.call(this)},n.prototype.data=function(t){if(void 0===t&&(t={}),this.W_){if(this.j_){var e=new Vs(this.U_,this.Q_,this.K_,this.W_,this.metadata,null);return this.j_.fromFirestore(e,t)}return this.Q_.C_(this.W_.En(),t.serverTimestamps)}},n.prototype.get=function(t,e){if(void 0===e&&(e={}),this.W_){var n=this.W_.data().field(ks("DocumentSnapshot.get",t));if(null!==n)return this.Q_.C_(n,e.serverTimestamps)}},n}(xs),Vs=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},n}(Rs),Ls=function(){function t(t,e,n,r){this.U_=t,this.Q_=e,this.Y_=r,this.metadata=new rc(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Y_.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.Y_.docs.forEach(function(r){t.call(e,new Vs(n.U_,n.Q_,r.key,r,new rc(n.Y_.ee.has(r.key),n.Y_.fromCache),n.query.j_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.Y_.se)throw new I(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.X_&&this.Z_===e||(this.X_=function(t,e){if(t.Y_.te.W()){var n=0;return t.Y_.docChanges.map(function(e){var r=new Vs(t.U_,t.Q_,e.doc.key,e.doc,new rc(t.Y_.ee.has(e.doc.key),t.Y_.fromCache),t.query.j_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}})}var r=t.Y_.te;return t.Y_.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new Vs(t.U_,t.Q_,e.doc.key,e.doc,new rc(t.Y_.ee.has(e.doc.key),t.Y_.fromCache),t.query.j_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Us(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.Z_=e),this.X_},t}();function Us(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return m()}}function qs(t,e){return t instanceof Rs&&e instanceof Rs?t.U_===e.U_&&t.K_.isEqual(e.K_)&&(null===t.W_?null===e.W_:t.W_.isEqual(e.W_))&&t.j_===e.j_:t instanceof Ls&&e instanceof Ls&&t.U_===e.U_&&ca(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Y_.isEqual(e.Y_)}var Ms=function(t){function n(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,e.__extends)(n,t),n.prototype.F_=function(t){return new ms(t)},n.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return new Gs(this.firestore,null,e)},n}(Ns);function js(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=as(t.firestore,Ss),u=ha(o);return e instanceof es&&(e=e.o_),zs(o,("string"==typeof e||e instanceof Os?_a(u,"updateDoc",t.K_,e,n,r):ma(u,"updateDoc",t.K_,e)).ef(t.K_,Qe.exists(!0)))}function Fs(t){for(var n,r,i,o=this,u=[],s=1;s<arguments.length;s++)u[s-1]=arguments[s];var c={includeMetadataChanges:!1},h=0;"object"!=a(u[h])||nr(u[h])||(c=u[h],h++);var f,l,p,d={includeMetadataChanges:c.includeMetadataChanges};if(nr(u[h])){var v=u[h];u[h]=null===(n=v.next)||void 0===n?void 0:n.bind(v),u[h+1]=null===(r=v.error)||void 0===r?void 0:r.bind(v),u[h+2]=null===(i=v.complete)||void 0===i?void 0:i.bind(v)}if(t instanceof Gs)l=as(t.firestore,Ss),p=_n(t.K_.path),f={next:function(e){u[h]&&u[h](Bs(l,t,e))},error:u[h+1],complete:u[h+2]};else{l=as(t.firestore,Ss),p=t.tf;var y=new Ms(l);f={next:function(e){u[h]&&u[h](new Ls(l,y,t,e))},error:u[h+1],complete:u[h+2]},ra(t.tf)}var g=Ya(l),m=new ts(f),_=new jo(p,m,d);return l.z_.Ri(function(){return(0,e.__awaiter)(o,void 0,void 0,function(){var t;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return t=Vo,[4,Fa(g)];case 1:return[2,t.apply(void 0,[e.sent(),_])]}})})}),function(){m.r_(),l.z_.Ri(function(){return(0,e.__awaiter)(o,void 0,void 0,function(){var t;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return t=Lo,[4,Fa(g)];case 1:return[2,t.apply(void 0,[e.sent(),_])]}})})})}}function zs(t,n){return function(t,n){var r=this,i=new tr;return t.di.Ri(function(){return(0,e.__awaiter)(r,void 0,void 0,function(){var r;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r=au,[4,ja(t)];case 1:return[2,r.apply(void 0,[e.sent(),n,i])]}})})}),i.promise}(Ya(t),n)}function Bs(t,e,n){var r=n.docs.get(e.K_),i=new Ms(t);return new Rs(t,i,e.K_,r,new rc(n.hasPendingWrites,n.fromCache),e.j_)}var Gs=function(){function t(t,e,n){this.j_=e,this.K_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"nf",{get:function(){return this.K_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.K_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new ia(this.firestore,this.j_,this.K_.path.q())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.K_)},t}(),Ks=function(){function t(t,e,n){this.j_=e,this.tf=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.tf)},t}(),Ws=function(){};function Qs(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].sf(t)}return t}var Hs=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).rf=e,i.cf=n,i.uf=r,i.type="where",i}return(0,e.__extends)(n,t),n.prototype.sf=function(t){var e=ha(t.firestore),n=function(t,e,n,r,i,o,u){var s;if(i.tt()){if("array-contains"===o||"array-contains-any"===o)throw new I(b.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){ea(u,o);for(var a=[],c=0,h=u;c<h.length;c++){var f=h[c];a.push(ta(r,t,f))}s={arrayValue:{values:a}}}else s=ta(r,t,u)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||ea(u,o),s=wa(n,"where",u,"in"===o||"not-in"===o);var l=Cn.create(i,o,s);return function(t,e){if(e.An()){var n=En(t);if(null!==n&&!n.isEqual(e.field))throw new I(b.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=In(t);null!==r&&na(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new I(b.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new I(b.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t.tf,0,e,t.firestore.R_,this.rf,this.cf,this.uf);return new Ks(t.firestore,t.j_,function(t,e){var n=t.filters.concat([e]);return new gn(t.path,t.collectionGroup,t.Tn.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.tf,n))},n}(Ws),Ys=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).rf=e,r.af=n,r.type="orderBy",r}return(0,e.__extends)(n,t),n.prototype.sf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new I(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new I(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Wn(e,n);return function(t,e){if(null===In(t)){var n=En(t);null!==n&&na(t,n,e.field)}}(t,r),r}(t.tf,this.rf,this.af);return new Ks(t.firestore,t.j_,function(t,e){var n=t.Tn.concat([e]);return new gn(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.tf,e))},n}(Ws),$s=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.hf=n,i.lf=r,i}return(0,e.__extends)(n,t),n.prototype.sf=function(t){return new Ks(t.firestore,t.j_,xn(t.tf,this.hf,this.lf))},n}(Ws),Js=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i._f=n,i.ff=r,i}return(0,e.__extends)(n,t),n.prototype.sf=function(t){var e=Zs(t,this.type,this._f,this.ff);return new Ks(t.firestore,t.j_,function(t,e){return new gn(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.tf,e))},n}(Ws),Xs=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i._f=n,i.ff=r,i}return(0,e.__extends)(n,t),n.prototype.sf=function(t){var e=Zs(t,this.type,this._f,this.ff);return new Ks(t.firestore,t.j_,function(t,e){return new gn(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.tf,e))},n}(Ws);function Zs(t,e,n,r){if(n[0]instanceof es&&(n[0]=n[0].o_),n[0]instanceof xs)return function(t,e,n,r,i){if(!r)throw new I(b.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],u=0,s=Nn(t);u<s.length;u++){var a=s[u];if(a.field.tt())o.push(Kt(e,r.key));else{var c=r.field(a.field);if(St(c))throw new I(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.J();throw new I(b.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new zn(o,i)}(t.tf,t.firestore.R_,e,n[0].W_,r);var i=ha(t.firestore);return function(t,e,n,r,i,o){var u=t.Tn;if(i.length>u.length)throw new I(b.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],c=0;c<i.length;c++){var h=i[c];if(u[c].field.tt()){if("string"!=typeof h)throw new I(b.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+a(h));if(!Tn(t)&&-1!==h.indexOf("/"))throw new I(b.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var f=t.path.child(L.Y(h));if(!M.ot(f))throw new I(b.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+f+"' is not because it contains an odd number of segments.");var l=new M(f);s.push(Kt(e,l))}else{var p=wa(n,r,h);s.push(p)}}return new zn(s,o)}(t.tf,t.firestore.R_,i,e,n,r)}function ta(t,e,n){if(n instanceof es&&(n=n.o_),"string"==typeof n){if(""===n)throw new I(b.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Tn(e)&&-1!==n.indexOf("/"))throw new I(b.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(L.Y(n));if(!M.ot(r))throw new I(b.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Kt(t,new M(r))}if(n instanceof Gs)return Kt(t,n.K_);throw new I(b.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ss(n)+".")}function ea(t,e){if(!Array.isArray(t)||0===t.length)throw new I(b.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new I(b.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function na(t,e,n){if(!n.isEqual(e))throw new I(b.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ra(t){if(bn(t)&&0===t.Tn.length)throw new I(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ia=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n,_n(r))||this).firestore=e,i.nf=r,i.type="collection",i}return(0,e.__extends)(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this.tf.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this.tf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){var t=this.nf.q();return t.W()?null:new Gs(this.firestore,null,new M(t))},enumerable:!1,configurable:!0}),n.prototype.withConverter=function(t){return new n(this.firestore,t,this.nf)},n}(Ks);function oa(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(ns("collection","path",n),t instanceof bs){var o=L.Y.apply(L,(0,e.__spreadArrays)([n],r));return us(o),new ia(t,null,o)}if(!(t instanceof Gs||t instanceof ia))throw new I(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var u=L.Y.apply(L,(0,e.__spreadArrays)([t.path],r)).child(L.Y(n));return us(u),new ia(t.firestore,null,u)}function ua(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(1===arguments.length&&(n=k.D()),ns("doc","path",n),t instanceof bs){var o=L.Y.apply(L,(0,e.__spreadArrays)([n],r));return os(o),new Gs(t,null,new M(o))}if(!(t instanceof Gs||t instanceof ia))throw new I(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var u=t.nf.child(L.Y.apply(L,(0,e.__spreadArrays)([n],r)));return os(u),new Gs(t.firestore,t instanceof ia?t.j_:null,new M(u))}var sa=function(t){function n(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,e.__extends)(n,t),n.prototype.F_=function(t){return new ms(t)},n.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return new Gs(this.firestore,null,e)},n}(Ns);function aa(t,e){return(t instanceof Gs||t instanceof ia)&&(e instanceof Gs||e instanceof ia)&&t.firestore===e.firestore&&t.path===e.path&&t.j_===e.j_}function ca(t,e){return t instanceof Ks&&e instanceof Ks&&t.firestore===e.firestore&&Dn(t.tf,e.tf)&&t.j_===e.j_}function ha(t){var e=t.S_(),n=er(t.R_);return new ya(t.R_,!!e.ignoreUndefinedProperties,n)}var fa=/^__.*__$/,la=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.ef=function(t,e){var n=[];return null!==this.en?n.push(new nn(t,this.data,this.en,e)):n.push(new en(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new on(t,this.fieldTransforms)),n},t}(),pa=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.ef=function(t,e){var n=[new nn(t,this.data,this.en,e)];return this.fieldTransforms.length>0&&n.push(new on(t,this.fieldTransforms)),n},t}();function da(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw m()}}var va=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.df(),this.fieldTransforms=i||[],this.en=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a_",{get:function(){return this.settings.a_},enumerable:!1,configurable:!0}),t.prototype.wf=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)},t.prototype.Ef=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.wf({path:n,__:!1});return r.Tf(t),r},t.prototype.If=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.wf({path:n,__:!1});return r.df(),r},t.prototype.mf=function(t){return this.wf({path:void 0,__:!0})},t.prototype.h_=function(t){return Da(t,this.settings.methodName,this.settings.Af||!1,this.path,this.settings.l_)},t.prototype.contains=function(t){return void 0!==this.en.find(function(e){return t.j(e)})||void 0!==this.fieldTransforms.find(function(e){return t.j(e.field)})},t.prototype.df=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Tf(this.path.get(t))},t.prototype.Tf=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(da(this.a_)&&fa.test(t))throw this.h_('Document fields cannot begin and end with "__"')},t}(),ya=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||er(t)}return t.prototype.Rf=function(t,e,n,r){return void 0===r&&(r=!1),new va({a_:t,methodName:e,l_:n,path:q.X(),__:!1,Af:r},this.t,this.serializer,this.ignoreUndefinedProperties)},t}();function ga(t,e,n,r,i,o){void 0===o&&(o={});var u=t.Rf(o.merge||o.mergeFields?2:0,e,n,i);Ta("Data must be an object, but it was:",u,r);var s,a,c=Ia(r,u);if(o.merge)s=new Ge(u.en),a=u.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=Na(e,l[f],n);if(!u.contains(p))throw new I(b.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");ka(h,p)||h.push(p)}s=new Ge(h),a=u.fieldTransforms.filter(function(t){return s.un(t.field)})}else s=null,a=u.fieldTransforms;return new la(new hn(c),s,a)}function ma(t,e,n,r){var i=t.Rf(1,e,n);Ta("Data must be an object, but it was:",i,r);var o=[],u=new fn;kt(r,function(t,r){var s=xa(e,t,n);r instanceof es&&(r=r.o_);var a=i.If(s);if(r instanceof fs)o.push(s);else{var c=ba(r,a);null!=c&&(o.push(s),u.set(s,c))}});var s=new Ge(o);return new pa(u.hn(),s,i.fieldTransforms)}function _a(t,e,n,r,i,o){var u=t.Rf(1,e,n),s=[Na(e,r,n)],a=[i];if(o.length%2!=0)throw new I(b.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(Na(e,o[c])),a.push(o[c+1]);for(var h=[],f=new fn,l=s.length-1;l>=0;--l)if(!ka(h,s[l])){var p=s[l],d=a[l];d instanceof es&&(d=d.o_);var v=u.If(p);if(d instanceof fs)h.push(p);else{var y=ba(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new Ge(h);return new pa(f.hn(),g,u.fieldTransforms)}function wa(t,e,n,r){return void 0===r&&(r=!1),ba(n,t.Rf(r?4:3,e))}function ba(t,e){if(t instanceof es&&(t=t.o_),Ea(t))return Ta("Unsupported field value:",e,t),Ia(t,e);if(t instanceof hs)return function(t,e){if(!da(e.a_))throw e.h_(t.c_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.c_+"() is not currently supported inside arrays");var n=t.u_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.en.push(e.path),t instanceof Array){if(e.settings.__&&4!==e.a_)throw e.h_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var u=ba(o[i],e.mf(r));null==u&&(u={nullValue:"NULL_VALUE"}),n.push(u),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof es&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ne(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=C.fromDate(t);return{timestampValue:re(e.serializer,n)}}if(t instanceof C){var r=new C(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:re(e.serializer,r)}}if(t instanceof gs)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ms)return{bytesValue:ie(e.serializer,t.T_)};if(t instanceof Gs){var i=e.t,o=t.firestore.R_;if(!o.isEqual(i))throw e.h_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:se(t.firestore.R_||e.t,t.K_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+ss(t))}(t,e)}function Ia(t,e){var n={};return Ot(t)?e.path&&e.path.length>0&&e.en.push(e.path):kt(t,function(t,r){var i=ba(r,e.Ef(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Ea(t){return!("object"!=a(t)||null===t||t instanceof Array||t instanceof Date||t instanceof C||t instanceof gs||t instanceof ms||t instanceof Gs||t instanceof hs)}function Ta(t,e,n){if(!Ea(n)||!function(t){return"object"==a(t)&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=ss(n);throw"an object"===r?e.h_(t+" a custom object"):e.h_(t+" "+r)}}function Na(t,e,n){if(e instanceof es&&(e=e.o_),e instanceof Os)return e.G_;if("string"==typeof e)return xa(t,e);throw Da("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Aa=new RegExp("[~\\*/\\[\\]]");function xa(t,n,r){if(n.search(Aa)>=0)throw Da("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,r);try{return(new(Os.bind.apply(Os,(0,e.__spreadArrays)([void 0],n.split("."))))).G_}catch(i){throw Da("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,r)}}function Da(t,e,n,r,i){var o=r&&!r.W(),u=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var a="";return(o||u)&&(a+=" (found",o&&(a+=" in field "+r),u&&(a+=" in document "+i),a+=")"),new I(b.INVALID_ARGUMENT,(s+=". ")+t+a)}function ka(t,e){return t.some(function(t){return t.isEqual(e)})}var Oa=function(){function t(t){this.Nu=t,this.Pf=new Map,this.mutations=[],this.gf=!1,this.yf=null,this.Vf=new Set}return t.prototype.pf=function(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n,r=this;return(0,e.__generator)(this,function(i){switch(i.label){case 0:if(this.vf(),this.mutations.length>0)throw new I(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o,u,s,a;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r=w(t),i=pe(r.serializer)+"/documents",o={documents:n.map(function(t){return ce(r.serializer,t)})},[4,r.Ru("BatchGetDocuments",i,o)];case 1:return u=e.sent(),s=new Map,u.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){_(!!e.found),e.found.name,e.found.updateTime;var n=he(t,e.found.name),r=ue(e.found.updateTime),i=new hn({mapValue:{fields:e.found.fields}});return new dn(n,r,i,{})}(t,e):"missing"in e?function(t,e){_(!!e.missing),_(!!e.readTime);var n=he(t,e.missing),r=ue(e.readTime);return new vn(n,r)}(t,e):m()}(r.serializer,t);s.set(e.key.toString(),e)}),a=[],[2,(n.forEach(function(t){var e=s.get(t.toString());_(!!e),a.push(e)}),a)]}})})}(this.Nu,t)];case 1:return[2,((n=i.sent()).forEach(function(t){t instanceof vn||t instanceof dn?r.bf(t):m()}),n)]}})})},t.prototype.set=function(t,e){this.write(e.ef(t,this.rn(t))),this.Vf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.ef(t,this.Sf(t)))}catch(t){this.yf=t}this.Vf.add(t.toString())},t.prototype.delete=function(t){this.write([new an(t,this.rn(t))]),this.Vf.add(t.toString())},t.prototype.commit=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t,n=this;return(0,e.__generator)(this,function(r){switch(r.label){case 0:if(this.vf(),this.yf)throw this.yf;return t=this.Pf,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,e){var r=M.st(e);n.mutations.push(new cn(r,n.rn(r)))}),[4,function(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,o;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r=w(t),i=pe(r.serializer)+"/documents",o={writes:n.map(function(t){return ye(r.serializer,t)})},[4,r.Au("Commit",i,o)];case 1:return e.sent(),[2]}})})}(this.Nu,this.mutations)];case 1:return r.sent(),this.gf=!0,[2]}})})},t.prototype.bf=function(t){var e;if(t instanceof dn)e=t.version;else{if(!(t instanceof vn))throw m();e=R.min()}var n=this.Pf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new I(b.ABORTED,"Document version changed between two reads.")}else this.Pf.set(t.key.toString(),e)},t.prototype.rn=function(t){var e=this.Pf.get(t.toString());return!this.Vf.has(t.toString())&&e?Qe.updateTime(e):Qe.on()},t.prototype.Sf=function(t){var e=this.Pf.get(t.toString());if(!this.Vf.has(t.toString())&&e){if(e.isEqual(R.min()))throw new I(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qe.updateTime(e)}return Qe.exists(!0)},t.prototype.write=function(t){this.vf(),this.mutations=this.mutations.concat(t)},t.prototype.vf=function(){},t}(),Sa=function(){function t(t,e,n,r){this.di=t,this.Nu=e,this.updateFunction=n,this.Ti=r,this.Df=5,this.Si=new ar(this.di,"transaction_retry")}return t.prototype.run=function(){this.Cf()},t.prototype.Cf=function(){var t=this;this.Si.Bs(function(){return(0,e.__awaiter)(t,void 0,void 0,function(){var t,n,r=this;return(0,e.__generator)(this,function(e){return t=new Oa(this.Nu),(n=this.Nf(t))&&n.then(function(e){r.di.Ri(function(){return t.commit().then(function(){r.Ti.resolve(e)}).catch(function(t){r.xf(t)})})}).catch(function(t){r.xf(t)}),[2]})})})},t.prototype.Nf=function(t){try{var e=this.updateFunction(t);return!j(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}},t.prototype.xf=function(t){var e=this;this.Df>0&&this.Ff(t)?(this.Df-=1,this.di.Ri(function(){return e.Cf(),Promise.resolve()})):this.Ti.reject(t)},t.prototype.Ff=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Z(e)}return!1},t}(),Pa=function(){function t(t,e,n){var r=this;this.credentials=t,this.di=e,this.Fl=n,this.user=f.UNAUTHENTICATED,this.clientId=k.D(),this.Of=function(){},this.g=new tr,this.credentials.A(function(t){d("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Of(t)),r.g.resolve()})}return t.prototype.getConfiguration=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(t){switch(t.label){case 0:return[4,this.g.promise];case 1:return[2,(t.sent(),{di:this.di,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},t.prototype.Mf=function(t){var e=this;this.Of=t,this.g.promise.then(function(){return e.Of(e.user)})},t.prototype.kf=function(){if(this.di.Ci)throw new I(b.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.di.Oi();var n=new tr;return this.di.Ni(function(){return(0,e.__awaiter)(t,void 0,void 0,function(){var t,r;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),this.$f?[4,this.$f.terminate()]:[3,2];case 1:e.sent(),e.label=2;case 2:return this.Lf?[4,this.Lf.terminate()]:[3,4];case 3:e.sent(),e.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return t=e.sent(),r=Ir(t,"Failed to shutdown persistence"),n.reject(r),[3,6];case 6:return[2]}})})}),n.promise},t}();function Ca(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i=this;return(0,e.__generator)(this,function(o){switch(o.label){case 0:return t.di.Li(),d("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return r=o.sent(),[4,n.initialize(r)];case 2:return o.sent(),t.Mf(function(r){return t.di.Mi(function(){return(0,e.__awaiter)(i,void 0,void 0,function(){return(0,e.__generator)(this,function(t){switch(t.label){case 0:return[4,Bi(n.Cu,r)];case 1:return t.sent(),[2]}})})})}),n.persistence.tc(function(){return t.terminate()}),t.Lf=n,[2]}})})}function Ra(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i;return(0,e.__generator)(this,function(o){switch(o.label){case 0:return t.di.Li(),[4,Va(t)];case 1:return r=o.sent(),d("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return i=o.sent(),[4,n.initialize(r,i)];case 3:return o.sent(),t.Mf(function(r){return t.di.Mi(function(){return function(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return(r=w(t)).di.Li(),d("RemoteStore","RemoteStore received new credentials"),i=yo(r),r.Mu.add(3),[4,ao(r)];case 1:return e.sent(),i&&r.Bu.set("Unknown"),[4,r.xu.s_(n)];case 2:return e.sent(),r.Mu.delete(3),[4,so(r)];case 3:return e.sent(),[2]}})})}(n.Oh,r)})}),t.$f=n,[2]}})})}function Va(t){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return t.Lf?[3,2]:(d("FirestoreClient","Using default OfflineComponentProvider"),[4,Ca(t,new $u)]);case 1:e.sent(),e.label=2;case 2:return[2,t.Lf]}})})}function La(t){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return t.$f?[3,2]:(d("FirestoreClient","Using default OnlineComponentProvider"),[4,Ra(t,new Zu)]);case 1:e.sent(),e.label=2;case 2:return[2,t.$f]}})})}function Ua(t){return Va(t).then(function(t){return t.persistence})}function qa(t){return Va(t).then(function(t){return t.Cu})}function Ma(t){return La(t).then(function(t){return t.Oh})}function ja(t){return La(t).then(function(t){return t.ga})}function Fa(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,La(t)];case 1:return n=e.sent(),[2,((r=n.Mh).Ju=ou.bind(null,n.ga),r.Zu=su.bind(null,n.ga),r)]}})})}function za(t,e,n,r,i){var o=new ts({next:function(o){e.Ri(function(){return Lo(t,u)});var s=o.docs.has(n);!s&&o.fromCache?i.reject(new I(b.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new I(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),u=new jo(_n(n.path),o,{includeMetadataChanges:!0,oa:!0});return Vo(t,u)}function Ba(t,e,n,r,i){var o=new ts({next:function(n){e.Ri(function(){return Lo(t,u)}),n.fromCache&&"server"===r.source?i.reject(new I(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),u=new jo(n,o,{includeMetadataChanges:!0,oa:!0});return Vo(t,u)}var Ga=function(){function t(t,e){this.U_=t,this.Bf=e,this.qf=[],this.Uf=!1,this.Qf=ha(t)}return t.prototype.set=function(t,e,n){this.Kf();var r=Ka(t,this.U_),i=fc(r.j_,e,n),o=ga(this.Qf,"WriteBatch.set",r.K_,i,null!==r.j_,n);return this.qf=this.qf.concat(o.ef(r.K_,Qe.on())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Kf();var o,u=Ka(t,this.U_);return e instanceof es&&(e=e.o_),o="string"==typeof e||e instanceof Os?_a(this.Qf,"WriteBatch.update",u.K_,e,n,r):ma(this.Qf,"WriteBatch.update",u.K_,e),this.qf=this.qf.concat(o.ef(u.K_,Qe.exists(!0))),this},t.prototype.delete=function(t){this.Kf();var e=Ka(t,this.U_);return this.qf=this.qf.concat(new an(e.K_,Qe.on())),this},t.prototype.commit=function(){return this.Kf(),this.Uf=!0,this.qf.length>0?this.Bf(this.qf):Promise.resolve()},t.prototype.Kf=function(){if(this.Uf)throw new I(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Ka(t,e){if(t instanceof es&&(t=t.o_),t.firestore!==e)throw new I(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Wa=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n)||this).U_=e,r}return(0,e.__extends)(n,t),n.prototype.get=function(e){var n=this,r=Ka(e,this.U_),i=new Ms(this.U_);return t.prototype.get.call(this,e).then(function(t){return new Rs(n.U_,i,r.K_,t.W_,new rc(!1,!1),r.j_)})},n}(function(){function t(t,e){this.U_=t,this.Wf=e,this.Qf=ha(t)}return t.prototype.get=function(t){var e=this,n=Ka(t,this.U_),r=new sa(this.U_);return this.Wf.pf([n.K_]).then(function(t){if(!t||1!==t.length)return m();var i=t[0];if(i instanceof vn)return new xs(e.U_,r,n.K_,null,n.j_);if(i instanceof dn)return new xs(e.U_,r,i.key,i,n.j_);throw m()})},t.prototype.set=function(t,e,n){var r=Ka(t,this.U_),i=fc(r.j_,e,n),o=ga(this.Qf,"Transaction.set",r.K_,i,null!==r.j_,n);return this.Wf.set(r.K_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,u=Ka(t,this.U_);return e instanceof es&&(e=e.o_),o="string"==typeof e||e instanceof Os?_a(this.Qf,"Transaction.update",u.K_,e,n,r):ma(this.Qf,"Transaction.update",u.K_,e),this.Wf.update(u.K_,o),this},t.prototype.delete=function(t){var e=Ka(t,this.U_);return this.Wf.delete(e.K_),this},t}()),Qa=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Cs(t);var n=Ya(t),r=t.S_(),i=new Zu;return Ps(n,i,new Ju(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Cs(t);var e=Ya(t),n=t.S_(),r=new Zu;return Ps(e,r,new Xu(r,n.cacheSizeBytes))}(t.o_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var n=this;if(t.y_&&!t.V_)throw new I(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new tr;return t.z_.Ni(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){var n;return(0,e.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,function(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return cr.Gs()?(n=t+"main",[4,cr.delete(n)]):[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(ji(t.R_,t.I_))];case 1:return i.sent(),r.resolve(),[3,3];case 2:return n=i.sent(),r.reject(n),[3,3];case 3:return[2]}})})}),r.promise}(t.o_)},t}(),Ha=function(t){function n(e,n,r){var i=this;return(i=t.call(this,n)||this).jf=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof h||(i.Gf=e),i}return(0,e.__extends)(n,t),Object.defineProperty(n.prototype,"R_",{get:function(){return this.o_.R_},enumerable:!1,configurable:!0}),n.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.b_()),t)).merge,this.o_.v_(t)},n.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.b_().host&&y("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},n.prototype.enableNetwork=function(){return function(t){var n=this;return t.di.enqueue(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){var n,r;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,Ua(t)];case 1:return n=e.sent(),[4,Ma(t)];case 2:return r=e.sent(),[2,(n.ec(!0),function(t){var e=w(r);return e.Mu.delete(0),so(e)}())]}})})})}(Ya(this.o_))},n.prototype.disableNetwork=function(){return function(t){var n=this;return t.di.enqueue(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){var n,r;return(0,e.__generator)(this,function(i){switch(i.label){case 0:return[4,Ua(t)];case 1:return n=i.sent(),[4,Ma(t)];case 2:return r=i.sent(),[2,(n.ec(!1),function(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return(n=w(t)).Mu.add(0),[4,ao(n)];case 1:return e.sent(),n.Bu.set("Offline"),[2]}})})}(r))]}})})})}(Ya(this.o_))},n.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&is("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.jf.enableMultiTabIndexedDbPersistence(this):this.jf.enableIndexedDbPersistence(this,n)},n.prototype.clearPersistence=function(){return this.jf.clearIndexedDbPersistence(this)},n.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},n.prototype.waitForPendingWrites=function(){return function(t){var n=this,r=new tr;return t.di.Ri(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){var n;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return n=du,[4,ja(t)];case 1:return[2,n.apply(void 0,[e.sent(),r])]}})})}),r.promise}(Ya(this.o_))},n.prototype.onSnapshotsInSync=function(t){return function(t,n){var r=this,i=Ya(t),o=nr(n)?n:{next:n},u=new ts(o);return t.z_.Ri(function(){return(0,e.__awaiter)(r,void 0,void 0,function(){var t;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return t=function(t,e){w(t).Hu.add(e),e.next()},[4,Fa(i)];case 1:return t.apply(void 0,[e.sent(),u]),[2]}})})}),function(){u.r_(),t.z_.Ri(function(){return(0,e.__awaiter)(r,void 0,void 0,function(){var t;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return t=function(t,e){w(t).Hu.delete(e)},[4,Fa(i)];case 1:return t.apply(void 0,[e.sent(),u]),[2]}})})})}}(this.o_,t)},Object.defineProperty(n.prototype,"app",{get:function(){if(!this.Gf)throw new I(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Gf},enumerable:!1,configurable:!0}),n.prototype.collection=function(t){try{return new cc(this,oa(this.o_,t))}catch(t){throw tc(t,"collection()","Firestore.collection()")}},n.prototype.doc=function(t){try{return new Za(this,ua(this.o_,t))}catch(t){throw tc(t,"doc()","Firestore.doc()")}},n.prototype.collectionGroup=function(t){try{return new uc(this,function(t,e){if(ns("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new I(b.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Ks(t,null,function(t){return new gn(L.X(),t)}(e))}(this.o_,t))}catch(t){throw tc(t,"collectionGroup()","Firestore.collectionGroup()")}},n.prototype.runTransaction=function(t){var n=this;return function(t,n){return function(t,n){var r=this,i=new tr;return t.di.Ri(function(){return(0,e.__awaiter)(r,void 0,void 0,function(){var r;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,function(t){return La(t).then(function(t){return t.Nu})}(t)];case 1:return r=e.sent(),new Sa(t.di,r,n,i).run(),[2]}})})}),i.promise}(Ya(t),function(e){return n(new Wa(t,e))})}(this.o_,function(e){return t(new Ja(n,e))})},n.prototype.batch=function(){var t=this;return Ya(this.o_),new Xa(new Ga(this.o_,function(e){return zs(t.o_,e)}))},n}(es);function Ya(t){return t.H_||$a(t),t.H_.kf(),t.H_}function $a(t){var e=t.S_(),n=function(t,e,n){return new c(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.R_,t.I_,e);t.H_=new Pa(t.P_,t.z_,n)}var Ja=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return(0,e.__extends)(n,t),n.prototype.get=function(t){var e=this,n=hc(t);return this.o_.get(n).then(function(t){return new ic(e.U_,t)})},n.prototype.set=function(t,e,n){var r=hc(t);return n?(rs("Transaction.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},n.prototype.update=function(t,n,r){for(var i,o=[],u=3;u<arguments.length;u++)o[u-3]=arguments[u];var s=hc(t);return 2===arguments.length?this.o_.update(s,n):(i=this.o_).update.apply(i,(0,e.__spreadArrays)([s,n,r],o)),this},n.prototype.delete=function(t){var e=hc(t);return this.o_.delete(e),this},n}(es),Xa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype.set=function(t,e,n){var r=hc(t);return n?(rs("WriteBatch.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},n.prototype.update=function(t,n,r){for(var i,o=[],u=3;u<arguments.length;u++)o[u-3]=arguments[u];var s=hc(t);return 2===arguments.length?this.o_.update(s,n):(i=this.o_).update.apply(i,(0,e.__spreadArrays)([s,n,r],o)),this},n.prototype.delete=function(t){var e=hc(t);return this.o_.delete(e),this},n.prototype.commit=function(){return this.o_.commit()},n}(es),Za=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Q_=new As(e),r}return(0,e.__extends)(n,t),n.zf=function(t,e,r){if(t.length%2!=0)throw new I(b.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.J()+" has "+t.length);return new n(e,new Gs(e.o_,r,new M(t)))},n.q_=function(t,e,r){return new n(e,new Gs(e.o_,r,t))},Object.defineProperty(n.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){return new cc(this.firestore,this.o_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),n.prototype.collection=function(t){try{return new cc(this.firestore,oa(this.o_,t))}catch(t){throw tc(t,"collection()","DocumentReference.collection()")}},n.prototype.isEqual=function(t){return t instanceof es&&(t=t.o_),t instanceof Gs&&aa(this.o_,t)},n.prototype.set=function(t,e){e=rs("DocumentReference.set",e);try{return function(t,e,n){var r=as(t.firestore,Ss),i=fc(t.j_,e,n);return zs(r,ga(ha(r),"setDoc",t.K_,i,null!==t.j_,n).ef(t.K_,Qe.on()))}(this.o_,t,e)}catch(t){throw tc(t,"setDoc()","DocumentReference.set()")}},n.prototype.update=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];try{return 1===arguments.length?js(this.o_,t):js.apply(void 0,(0,e.__spreadArrays)([this.o_,t,n],r))}catch(t){throw tc(t,"updateDoc()","DocumentReference.update()")}},n.prototype.delete=function(){return zs(as((t=this.o_).firestore,Ss),[new an(t.K_,Qe.on())]);var t},n.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=ec(e),i=nc(e,function(e){return new ic(t.firestore,new Rs(t.firestore.o_,t.Q_,e.K_,e.W_,e.metadata,t.o_.j_))});return Fs(this.o_,r,i)},n.prototype.get=function(t){var n=this;return("cache"===(null==t?void 0:t.source)?function(t){var n=this,r=as(t.firestore,Ss),i=Ya(r),o=new Ms(r),u=new tr;return r.z_.Ri(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){return(0,e.__generator)(this,function(n){switch(n.label){case 0:return[4,qa(i)];case 1:return[4,function(t,n,r){return(0,e.__awaiter)(this,void 0,void 0,function(){var i,o,u;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,function(t,e){var n=w(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Oc.cs(t,e)})}(t,n)];case 1:return(i=e.sent())instanceof dn?r.resolve(i):i instanceof vn?r.resolve(null):r.reject(new I(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return o=e.sent(),u=Ir(o,"Failed to get document '"+n+" from cache"),r.reject(u),[3,3];case 3:return[2]}})})}(n.sent(),t.K_,u)];case 2:return n.sent(),[2]}})})}),u.promise.then(function(e){return new Rs(r,o,t.K_,e,new rc(e instanceof dn&&e.an,!0),t.j_)})}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var n=this,r=as(t.firestore,Ss),i=Ya(r),o=new tr;return r.z_.Ri(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,Fa(i)];case 1:return[4,za(e.sent(),r.z_,t.K_,{source:"server"},o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return Bs(r,t,e)})}(this.o_):function(t){var n=this,r=as(t.firestore,Ss),i=Ya(r),o=new tr;return r.z_.Ri(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,Fa(i)];case 1:return[4,za(e.sent(),r.z_,t.K_,{source:"default"},o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return Bs(r,t,e)})}(this.o_)).then(function(t){return new ic(n.firestore,new Rs(n.firestore.o_,n.Q_,t.K_,t.W_,t.metadata,n.o_.j_))})},n.prototype.withConverter=function(t){return new n(this.firestore,this.o_.withConverter(t))},n}(es);function tc(t,e,n){return t.message=t.message.replace(e,n),t}function ec(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==a(r)&&!nr(r))return r}return{}}function nc(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=nr(t[0])?t[0]:nr(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var rc=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),ic=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return(0,e.__extends)(n,t),Object.defineProperty(n.prototype,"ref",{get:function(){return new Za(this.U_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),n.prototype.data=function(t){return this.o_.data(t)},n.prototype.get=function(t,e){return this.o_.get(t,e)},n.prototype.isEqual=function(t){return qs(this.o_,t.o_)},n}(es),oc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype.data=function(t){return this.o_.data(t)},n}(ic),uc=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r}return(0,e.__extends)(n,t),n.prototype.where=function(t,e,r){try{return new n(this.firestore,Qs(this.o_,function(t,e,n){var r=e,i=ks("where",t);return new Hs(i,r,n)}(t,e,r)))}catch(t){throw tc(t,/(orderBy|where)\(\)/,"Query.$1()")}},n.prototype.orderBy=function(t,e){try{return new n(this.firestore,Qs(this.o_,function(t,e){void 0===e&&(e="asc");var n=e,r=ks("orderBy",t);return new Ys(r,n)}(t,e)))}catch(t){throw tc(t,/(orderBy|where)\(\)/,"Query.$1()")}},n.prototype.limit=function(t){try{return new n(this.firestore,Qs(this.o_,function(t){return cs("limit",t),new $s("limit",t,"F")}(t)))}catch(t){throw tc(t,"limit()","Query.limit()")}},n.prototype.limitToLast=function(t){try{return new n(this.firestore,Qs(this.o_,function(t){return cs("limitToLast",t),new $s("limitToLast",t,"L")}(t)))}catch(t){throw tc(t,"limitToLast()","Query.limitToLast()")}},n.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new n(this.firestore,Qs(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Js("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw tc(t,"startAt()","Query.startAt()")}},n.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new n(this.firestore,Qs(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Js("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw tc(t,"startAfter()","Query.startAfter()")}},n.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new n(this.firestore,Qs(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Xs("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw tc(t,"endBefore()","Query.endBefore()")}},n.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new n(this.firestore,Qs(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Xs("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw tc(t,"endAt()","Query.endAt()")}},n.prototype.isEqual=function(t){return ca(this.o_,t.o_)},n.prototype.get=function(t){var n=this;return("cache"===(null==t?void 0:t.source)?function(t){var n=this,r=as(t.firestore,Ss),i=Ya(r),o=new Ms(r),u=new tr;return r.z_.Ri(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){return(0,e.__generator)(this,function(n){switch(n.label){case 0:return[4,qa(i)];case 1:return[4,function(t,n,r){return(0,e.__awaiter)(this,void 0,void 0,function(){var i,o,u,s,a,c;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,$i(t,n,!0)];case 1:return i=e.sent(),o=new eu(n,i.Bc),u=o.gh(i.documents),s=o.Zn(u,!1),r.resolve(s.snapshot),[3,3];case 2:return a=e.sent(),c=Ir(a,"Failed to execute query '"+n+" against cache"),r.reject(c),[3,3];case 3:return[2]}})})}(n.sent(),t.tf,u)];case 2:return n.sent(),[2]}})})}),u.promise.then(function(e){return new Ls(r,o,t,e)})}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var n=this,r=as(t.firestore,Ss),i=Ya(r),o=new Ms(r),u=new tr;return r.z_.Ri(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,Fa(i)];case 1:return[4,Ba(e.sent(),r.z_,t.tf,{source:"server"},u)];case 2:return e.sent(),[2]}})})}),u.promise.then(function(e){return new Ls(r,o,t,e)})}(this.o_):function(t){var n=this,r=as(t.firestore,Ss),i=Ya(r),o=new Ms(r);ra(t.tf);var u=new tr;return r.z_.Ri(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,Fa(i)];case 1:return[4,Ba(e.sent(),r.z_,t.tf,{source:"default"},u)];case 2:return e.sent(),[2]}})})}),u.promise.then(function(e){return new Ls(r,o,t,e)})}(this.o_)).then(function(t){return new ac(n.firestore,t)})},n.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=ec(e),i=nc(e,function(e){return new ac(t.firestore,e)});return Fs(this.o_,r,i)},n.prototype.withConverter=function(t){return new n(this.firestore,this.o_.withConverter(t))},n}(es),sc=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return(0,e.__extends)(n,t),Object.defineProperty(n.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"doc",{get:function(){return new oc(this.U_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"newIndex",{get:function(){return this.o_.newIndex},enumerable:!1,configurable:!0}),n}(es),ac=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return(0,e.__extends)(n,t),Object.defineProperty(n.prototype,"query",{get:function(){return new uc(this.U_,this.o_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"docs",{get:function(){var t=this;return this.o_.docs.map(function(e){return new oc(t.U_,e)})},enumerable:!1,configurable:!0}),n.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new sc(e.U_,t)})},n.prototype.forEach=function(t,e){var n=this;this.o_.forEach(function(r){t.call(e,new oc(n.U_,r))})},n.prototype.isEqual=function(t){return qs(this.o_,t.o_)},n}(es),cc=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.o_=n,r}return(0,e.__extends)(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){var t=this.o_.parent;return t?new Za(this.firestore,t):null},enumerable:!1,configurable:!0}),n.prototype.doc=function(t){try{return new Za(this.firestore,void 0===t?ua(this.o_):ua(this.o_,t))}catch(t){throw tc(t,"doc()","CollectionReference.doc()")}},n.prototype.add=function(t){var e=this;return function(t,e){var n=as(t.firestore,Ss),r=ua(t),i=fc(t.j_,e);return zs(n,ga(ha(t.firestore),"addDoc",r.K_,i,null!==t.j_,{}).ef(r.K_,Qe.exists(!1))).then(function(){return r})}(this.o_,t).then(function(t){return new Za(e.firestore,t)})},n.prototype.isEqual=function(t){return aa(this.o_,t.o_)},n.prototype.withConverter=function(t){return new n(this.firestore,this.o_.withConverter(t))},n}(uc);function hc(t){return t instanceof es&&(t=t.o_),as(t,Gs)}function fc(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var lc=function(t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.call(this,new(Os.bind.apply(Os,(0,e.__spreadArrays)([void 0],n))))||this}return(0,e.__extends)(n,t),n.documentId=function(){return new n(q.et().J())},n.prototype.isEqual=function(t){return t instanceof es&&(t=t.o_),t instanceof Os&&this.o_.G_.isEqual(t.G_)},n}(es),pc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.serverTimestamp=function(){var t=new ps("serverTimestamp");return t.c_="FieldValue.serverTimestamp",new n(t)},n.delete=function(){var t=new fs("deleteField");return t.c_="FieldValue.delete",new n(t)},n.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ds("arrayUnion",t)}.apply(void 0,t);return r.c_="FieldValue.arrayUnion",new n(r)},n.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vs("arrayRemove",t)}.apply(void 0,t);return r.c_="FieldValue.arrayRemove",new n(r)},n.increment=function(t){var e=function(t){return new ys("increment",t)}(t);return e.c_="FieldValue.increment",new n(e)},n.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},n}(es),dc={Firestore:Ha,GeoPoint:gs,Timestamp:C,Blob:Ts,Transaction:Ja,WriteBatch:Xa,DocumentReference:Za,DocumentSnapshot:ic,Query:uc,QueryDocumentSnapshot:oc,QuerySnapshot:ac,CollectionReference:cc,FieldPath:lc,FieldValue:pc,setLogLevel:function(t){var e;e=t,l.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};function vc(t){!function(t,e){t.INTERNAL.registerComponent(new u.Component("firestore",function(t){return function(t,e){return new Ha(t,new Ss(t,e),new Qa)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},dc)))}(t),t.registerVersion("@firebase/firestore","2.0.4")}vc(n.default);
},{"tslib":"vCxL","@firebase/app":"VxYX","@firebase/logger":"TUpU","@firebase/util":"KxmD","@firebase/webchannel-wrapper":"ueHA","@firebase/component":"sLOu","process":"NG2Q"}],"vHL5":[function(require,module,exports) {
"use strict";require("@firebase/firestore");
},{"@firebase/firestore":"A6C1"}],"wU43":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.registerStorage=St;var e=o(require("@firebase/app")),t=require("tslib"),r=require("@firebase/util"),n=require("@firebase/component");function o(e){return e&&e.__esModule?e:{default:e}}var i="firebasestorage.googleapis.com",a="storageBucket",s=12e4,u=6e5,c=function(e){function r(t,n){var o=e.call(this,h(t),"Firebase Storage: "+n+" ("+h(t)+")")||this;return o.customData={serverResponse:null},Object.setPrototypeOf(o,r.prototype),o}return(0,t.__extends)(r,e),r.prototype.codeEquals=function(e){return h(e)===this.code},Object.defineProperty(r.prototype,"message",{get:function(){return this.customData.serverResponse?this.message+"\n"+this.customData.serverResponse:this.message},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(e){this.customData.serverResponse=e},enumerable:!1,configurable:!0}),r}(r.FirebaseError),l={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error",UNSUPPORTED_ENVIRONMENT:"unsupported-environment"};function h(e){return"storage/"+e}function f(){return new c(l.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function p(e){return new c(l.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function d(e){return new c(l.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function _(){return new c(l.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}function g(e){return new c(l.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function v(){return new c(l.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function b(){return new c(l.CANCELED,"User canceled the upload/download.")}function m(e){return new c(l.INVALID_URL,"Invalid URL '"+e+"'.")}function y(e){return new c(l.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function R(){return new c(l.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+a+"' property when initializing the app?")}function w(){return new c(l.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function E(){return new c(l.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function T(){return new c(l.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function U(e){return new c(l.INVALID_ARGUMENT,e)}function N(){return new c(l.APP_DELETED,"The Firebase app was deleted.")}function O(e){return new c(l.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function A(e,t){return new c(l.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function C(e){throw new c(l.INTERNAL_ERROR,"Internal error: "+e)}var k={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},S=function(){return function(e,t){this.data=e,this.contentType=t||null}}();function P(e,t){switch(e){case k.RAW:return new S(I(t));case k.BASE64:case k.BASE64URL:return new S(D(e,t));case k.DATA_URL:return new S(j(t),G(t))}throw f()}function I(e){for(var t=[],r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n<=127)t.push(n);else if(n<=2047)t.push(192|n>>6,128|63&n);else if(55296==(64512&n))if(r<e.length-1&&56320==(64512&e.charCodeAt(r+1)))n=65536|(1023&n)<<10|1023&e.charCodeAt(++r),t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n);else t.push(239,191,189);else 56320==(64512&n)?t.push(239,191,189):t.push(224|n>>12,128|n>>6&63,128|63&n)}return new Uint8Array(t)}function x(e){var t;try{t=decodeURIComponent(e)}catch(r){throw A(k.DATA_URL,"Malformed data URL.")}return I(t)}function D(e,t){switch(e){case k.BASE64:var r=-1!==t.indexOf("-"),n=-1!==t.indexOf("_");if(r||n)throw A(e,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break;case k.BASE64URL:var o=-1!==t.indexOf("+"),i=-1!==t.indexOf("/");if(o||i)throw A(e,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(t)}catch(c){throw A(e,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var L=function(){return function(e){this.base64=!1,this.contentType=null;var t=e.match(/^data:([^,]+)?,/);if(null===t)throw A(k.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var r=t[1]||null;null!=r&&(this.base64=M(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-";base64".length):r),this.rest=e.substring(e.indexOf(",")+1)}}();function j(e){var t=new L(e);return t.base64?D(k.BASE64,t.rest):x(t.rest)}function G(e){return new L(e).contentType}function M(e,t){return!!(e.length>=t.length)&&e.substring(e.length-t.length)===t}var B,q={STATE_CHANGED:"state_changed"},F={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},H={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function z(e){switch(e){case F.RUNNING:case F.PAUSING:case F.CANCELING:return H.RUNNING;case F.PAUSED:return H.PAUSED;case F.SUCCESS:return H.SUCCESS;case F.CANCELED:return H.CANCELED;case F.ERROR:default:return H.ERROR}}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(B||(B={}));var V=function(){function e(){var e=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=B.NO_ERROR,this.sendPromise_=new Promise(function(t){e.xhr_.addEventListener("abort",function(){e.errorCode_=B.ABORT,t(e)}),e.xhr_.addEventListener("error",function(){e.errorCode_=B.NETWORK_ERROR,t(e)}),e.xhr_.addEventListener("load",function(){t(e)})})}return e.prototype.send=function(e,t,r,n){if(this.sent_)throw C("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==n)for(var o in n)n.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,n[o].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_},e.prototype.getErrorCode=function(){if(!this.sent_)throw C("cannot .getErrorCode() before sending");return this.errorCode_},e.prototype.getStatus=function(){if(!this.sent_)throw C("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}},e.prototype.getResponseText=function(){if(!this.sent_)throw C("cannot .getResponseText() before sending");return this.xhr_.responseText},e.prototype.abort=function(){this.xhr_.abort()},e.prototype.getResponseHeader=function(e){return this.xhr_.getResponseHeader(e)},e.prototype.addUploadProgressListener=function(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)},e.prototype.removeUploadProgressListener=function(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)},e}(),X=function(){function e(){}return e.prototype.createXhrIo=function(){return new V},e}();function W(e){return void 0!==e}function K(e){return"function"==typeof e}function Z(e){return"object"==typeof e&&!Array.isArray(e)}function J(e){return"string"==typeof e||e instanceof String}function Y(e){return Q()&&e instanceof Blob}function Q(){return"undefined"!=typeof Blob}function $(e,t,r,n){if(n<t)throw new c(l.INVALID_ARGUMENT,"Invalid value for '"+e+"'. Expected "+t+" or greater.");if(n>r)throw new c(l.INVALID_ARGUMENT,"Invalid value for '"+e+"'. Expected "+r+" or less.")}function ee(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function te(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=ee();if(void 0!==r){for(var n=new r,o=0;o<e.length;o++)n.append(e[o]);return n.getBlob()}if(Q())return new Blob(e);throw new c(l.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function re(e,t,r){return e.webkitSlice?e.webkitSlice(t,r):e.mozSlice?e.mozSlice(t,r):e.slice?e.slice(t,r):null}var ne=function(){function e(e,t){var r=0,n="";Y(e)?(this.data_=e,r=e.size,n=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=n}return e.prototype.size=function(){return this.size_},e.prototype.type=function(){return this.type_},e.prototype.slice=function(t,r){if(Y(this.data_)){var n=re(this.data_,t,r);return null===n?null:new e(n)}return new e(new Uint8Array(this.data_.buffer,t,r-t),!0)},e.getBlob=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(Q()){var n=t.map(function(t){return t instanceof e?t.data_:t});return new e(te.apply(null,n))}var o=t.map(function(e){return J(e)?P(k.RAW,e).data:e.data_}),i=0;o.forEach(function(e){i+=e.byteLength});var a=new Uint8Array(i),s=0;return o.forEach(function(e){for(var t=0;t<e.length;t++)a[s++]=e[t]}),new e(a,!0)},e.prototype.uploadData=function(){return this.data_},e}(),oe=function(){function e(e,t){this.bucket=e,this.path_=t}return Object.defineProperty(e.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),e.prototype.fullServerUrl=function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)},e.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},e.makeFromBucketSpec=function(t){var r;try{r=e.makeFromUrl(t)}catch(n){return new e(t,"")}if(""===r.path)return r;throw y(t)},e.makeFromUrl=function(t){var r=null;var n=new RegExp("^gs://([A-Za-z0-9.\\-_]+)(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}for(var a=i.replace(/[.]/g,"\\."),s=[{regex:n,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+a+"/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-_]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp("^https?://(?:storage.googleapis.com|storage.cloud.google.com)/([A-Za-z0-9.\\-_]+)/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:o}],u=0;u<s.length;u++){var c=s[u],l=c.regex.exec(t);if(l){var h=l[c.indices.bucket],f=l[c.indices.path];f||(f=""),r=new e(h,f),c.postModify(r);break}}if(null==r)throw m(t);return r},e}();function ie(e){var t;try{t=JSON.parse(e)}catch(r){return null}return Z(t)?t:null}function ae(e){if(0===e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}function se(e,t){var r=t.split("/").filter(function(e){return e.length>0}).join("/");return 0===e.length?r:e+"/"+r}function ue(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function ce(e){return"https://"+i+"/v0"+e}function le(e){var t=encodeURIComponent,r="?";for(var n in e){if(e.hasOwnProperty(n))r=r+(t(n)+"="+t(e[n]))+"&"}return r=r.slice(0,-1)}function he(e,t){return t}var fe=function(){return function(e,t,r,n){this.server=e,this.local=t||e,this.writable=!!r,this.xform=n||he}}(),pe=null;function de(e){return!J(e)||e.length<2?e:ue(e)}function _e(){if(pe)return pe;var e=[];e.push(new fe("bucket")),e.push(new fe("generation")),e.push(new fe("metageneration")),e.push(new fe("name","fullPath",!0));var t=new fe("name");t.xform=function(e,t){return de(t)},e.push(t);var r=new fe("size");return r.xform=function(e,t){return void 0!==t?Number(t):t},e.push(r),e.push(new fe("timeCreated")),e.push(new fe("updated")),e.push(new fe("md5Hash",null,!0)),e.push(new fe("cacheControl",null,!0)),e.push(new fe("contentDisposition",null,!0)),e.push(new fe("contentEncoding",null,!0)),e.push(new fe("contentLanguage",null,!0)),e.push(new fe("contentType",null,!0)),e.push(new fe("metadata","customMetadata",!0)),pe=e}function ge(e,t){Object.defineProperty(e,"ref",{get:function(){var r=e.bucket,n=e.fullPath,o=new oe(r,n);return t.makeStorageReference(o)}})}function ve(e,t,r){for(var n={type:"file"},o=r.length,i=0;i<o;i++){var a=r[i];n[a.local]=a.xform(n,t[a.server])}return ge(n,e),n}function be(e,t,r){var n=ie(t);return null===n?null:ve(e,n,r)}function me(e,t){var r=ie(t);if(null===r)return null;if(!J(r.downloadTokens))return null;var n=r.downloadTokens;if(0===n.length)return null;var o=encodeURIComponent;return n.split(",").map(function(t){var r=e.bucket,n=e.fullPath;return ce("/b/"+o(r)+"/o/"+o(n))+le({alt:"media",token:t})})[0]}function ye(e,t){for(var r={},n=t.length,o=0;o<n;o++){var i=t[o];i.writable&&(r[i.server]=e[i.local])}return JSON.stringify(r)}var Re="prefixes",we="items";function Ee(e,t,r){var n={prefixes:[],items:[],nextPageToken:r.nextPageToken};if(r[Re])for(var o=0,i=r[Re];o<i.length;o++){var a=i[o].replace(/\/$/,""),s=e.makeStorageReference(new oe(t,a));n.prefixes.push(s)}if(r[we])for(var u=0,c=r[we];u<c.length;u++){var l=c[u];s=e.makeStorageReference(new oe(t,l.name));n.items.push(s)}return n}function Te(e,t,r){var n=ie(r);return null===n?null:Ee(e,t,n)}var Ue=function(){return function(e,t,r,n){this.url=e,this.method=t,this.handler=r,this.timeout=n,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}();function Ne(e){if(!e)throw f()}function Oe(e,t){return function(r,n){var o=be(e,n,t);return Ne(null!==o),o}}function Ae(e,t){return function(r,n){var o=Te(e,t,n);return Ne(null!==o),o}}function Ce(e,t){return function(r,n){var o=be(e,n,t);return Ne(null!==o),me(o,n)}}function ke(e){return function(t,r){var n;return(n=401===t.getStatus()?_():402===t.getStatus()?d(e.bucket):403===t.getStatus()?g(e.path):r).serverResponse=r.serverResponse,n}}function Se(e){var t=ke(e);return function(r,n){var o=t(r,n);return 404===r.getStatus()&&(o=p(e.path)),o.serverResponse=n.serverResponse,o}}function Pe(e,t,r){var n=ce(t.fullServerUrl()),o=e.maxOperationRetryTime,i=new Ue(n,"GET",Oe(e,r),o);return i.errorHandler=Se(t),i}function Ie(e,t,r,n,o){var i={};t.isRoot?i.prefix="":i.prefix=t.path+"/",r&&r.length>0&&(i.delimiter=r),n&&(i.pageToken=n),o&&(i.maxResults=o);var a=ce(t.bucketOnlyServerUrl()),s=e.maxOperationRetryTime,u=new Ue(a,"GET",Ae(e,t.bucket),s);return u.urlParams=i,u.errorHandler=ke(t),u}function xe(e,t,r){var n=ce(t.fullServerUrl()),o=e.maxOperationRetryTime,i=new Ue(n,"GET",Ce(e,r),o);return i.errorHandler=Se(t),i}function De(e,t,r,n){var o=ce(t.fullServerUrl()),i=ye(r,n),a=e.maxOperationRetryTime,s=new Ue(o,"PATCH",Oe(e,n),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=i,s.errorHandler=Se(t),s}function Le(e,t){var r=ce(t.fullServerUrl()),n=e.maxOperationRetryTime;var o=new Ue(r,"DELETE",function(e,t){},n);return o.successCodes=[200,204],o.errorHandler=Se(t),o}function je(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function Ge(e,t,r){var n=Object.assign({},r);return n.fullPath=e.path,n.size=t.size(),n.contentType||(n.contentType=je(null,t)),n}function Me(e,t,r,n,o){var i=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};var s=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+s;var u=Ge(t,n,o),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+ye(u,r)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",h=ne.getBlob(c,n,l);if(null===h)throw w();var f={name:u.fullPath},p=ce(i),d=e.maxUploadRetryTime,_=new Ue(p,"POST",Oe(e,r),d);return _.urlParams=f,_.headers=a,_.body=h.uploadData(),_.errorHandler=ke(t),_}var Be=function(){return function(e,t,r,n){this.current=e,this.total=t,this.finalized=!!r,this.metadata=n||null}}();function qe(e,t){var r=null;try{r=e.getResponseHeader("X-Goog-Upload-Status")}catch(n){Ne(!1)}return Ne(!!r&&-1!==(t||["active"]).indexOf(r)),r}function Fe(e,t,r,n,o){var i=t.bucketOnlyServerUrl(),a=Ge(t,n,o),s={name:a.fullPath},u=ce(i),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":n.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},l=ye(a,r),h=e.maxUploadRetryTime;var f=new Ue(u,"POST",function(e){var t;qe(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(r){Ne(!1)}return Ne(J(t)),t},h);return f.urlParams=s,f.headers=c,f.body=l,f.errorHandler=ke(t),f}function He(e,t,r,n){var o=e.maxUploadRetryTime,i=new Ue(r,"POST",function(e){var t=qe(e,["active","final"]),r=null;try{r=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(i){Ne(!1)}r||Ne(!1);var o=Number(r);return Ne(!isNaN(o)),new Be(o,n.size(),"final"===t)},o);return i.headers={"X-Goog-Upload-Command":"query"},i.errorHandler=ke(t),i}var ze=262144;function Ve(e,t,r,n,o,i,a,s){var u=new Be(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=n.size()),n.size()!==u.total)throw E();var c=u.total-u.current,l=c;o>0&&(l=Math.min(l,o));var h=u.current,f=h+l,p={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},d=n.slice(h,f);if(null===d)throw w();var _=t.maxUploadRetryTime,g=new Ue(r,"POST",function(e,r){var o,a=qe(e,["active","final"]),s=u.current+l,c=n.size();return o="final"===a?Oe(t,i)(e,r):null,new Be(s,c,"final"===a,o)},_);return g.headers=p,g.body=d.uploadData(),g.progressCallback=s||null,g.errorHandler=ke(e),g}var Xe=function(){return function(e,t,r){if(K(e)||null!=t||null!=r)this.next=e,this.error=t,this.complete=r;else{var n=e;this.next=n.next,this.error=n.error,this.complete=n.complete}}}(),We=function(){return function(e,t,r,n,o,i){this.bytesTransferred=e,this.totalBytes=t,this.state=r,this.metadata=n,this.task=o,this.ref=i}}();function Ke(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];Promise.resolve().then(function(){return e.apply(void 0,t)})}}var Ze=function(){function e(e,t,r){var n=this;void 0===r&&(r=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=_e(),this._resumable=this._shouldDoResumable(this._blob),this._state=F.RUNNING,this._errorHandler=function(e){n._request=void 0,n._chunkMultiplier=1,e.codeEquals(l.CANCELED)?(n._needToFetchStatus=!0,n.completeTransitions_()):(n._error=e,n._transition(F.ERROR))},this._metadataErrorHandler=function(e){n._request=void 0,e.codeEquals(l.CANCELED)?n.completeTransitions_():(n._error=e,n._transition(F.ERROR))},this._promise=new Promise(function(e,t){n._resolve=e,n._reject=t,n._start()}),this._promise.then(null,function(){})}return e.prototype._makeProgressCallback=function(){var e=this,t=this._transferred;return function(r){return e._updateProgress(t+r)}},e.prototype._shouldDoResumable=function(e){return e.size()>262144},e.prototype._start=function(){this._state===F.RUNNING&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},e.prototype._resolveToken=function(e){var t=this;this._ref.storage.getAuthToken().then(function(r){switch(t._state){case F.RUNNING:e(r);break;case F.CANCELING:t._transition(F.CANCELED);break;case F.PAUSING:t._transition(F.PAUSED)}})},e.prototype._createResumable=function(){var e=this;this._resolveToken(function(t){var r=Fe(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),n=e._ref.storage.makeRequest(r,t);e._request=n,n.getPromise().then(function(t){e._request=void 0,e._uploadUrl=t,e._needToFetchStatus=!1,e.completeTransitions_()},e._errorHandler)})},e.prototype._fetchStatus=function(){var e=this,t=this._uploadUrl;this._resolveToken(function(r){var n=He(e._ref.storage,e._ref._location,t,e._blob),o=e._ref.storage.makeRequest(n,r);e._request=o,o.getPromise().then(function(t){t=t,e._request=void 0,e._updateProgress(t.current),e._needToFetchStatus=!1,t.finalized&&(e._needToFetchMetadata=!0),e.completeTransitions_()},e._errorHandler)})},e.prototype._continueUpload=function(){var e=this,t=ze*this._chunkMultiplier,r=new Be(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken(function(o){var i;try{i=Ve(e._ref._location,e._ref.storage,n,e._blob,t,e._mappings,r,e._makeProgressCallback())}catch(s){return e._error=s,void e._transition(F.ERROR)}var a=e._ref.storage.makeRequest(i,o);e._request=a,a.getPromise().then(function(t){e._increaseMultiplier(),e._request=void 0,e._updateProgress(t.current),t.finalized?(e._metadata=t.metadata,e._transition(F.SUCCESS)):e.completeTransitions_()},e._errorHandler)})},e.prototype._increaseMultiplier=function(){ze*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},e.prototype._fetchMetadata=function(){var e=this;this._resolveToken(function(t){var r=Pe(e._ref.storage,e._ref._location,e._mappings),n=e._ref.storage.makeRequest(r,t);e._request=n,n.getPromise().then(function(t){e._request=void 0,e._metadata=t,e._transition(F.SUCCESS)},e._metadataErrorHandler)})},e.prototype._oneShotUpload=function(){var e=this;this._resolveToken(function(t){var r=Me(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),n=e._ref.storage.makeRequest(r,t);e._request=n,n.getPromise().then(function(t){e._request=void 0,e._metadata=t,e._updateProgress(e._blob.size()),e._transition(F.SUCCESS)},e._errorHandler)})},e.prototype._updateProgress=function(e){var t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()},e.prototype._transition=function(e){if(this._state!==e)switch(e){case F.CANCELING:case F.PAUSING:this._state=e,void 0!==this._request&&this._request.cancel();break;case F.RUNNING:var t=this._state===F.PAUSED;this._state=e,t&&(this._notifyObservers(),this._start());break;case F.PAUSED:this._state=e,this._notifyObservers();break;case F.CANCELED:this._error=b(),this._state=e,this._notifyObservers();break;case F.ERROR:case F.SUCCESS:this._state=e,this._notifyObservers()}},e.prototype.completeTransitions_=function(){switch(this._state){case F.PAUSING:this._transition(F.PAUSED);break;case F.CANCELING:this._transition(F.CANCELED);break;case F.RUNNING:this._start()}},Object.defineProperty(e.prototype,"snapshot",{get:function(){var e=z(this._state);return new We(this._transferred,this._blob.size(),e,this._metadata,this,this._ref)},enumerable:!1,configurable:!0}),e.prototype.on=function(e,t,r,n){var o=this,i=new Xe(t,r,n);return this._addObserver(i),function(){o._removeObserver(i)}},e.prototype.then=function(e,t){return this._promise.then(e,t)},e.prototype.catch=function(e){return this.then(null,e)},e.prototype._addObserver=function(e){this._observers.push(e),this._notifyObserver(e)},e.prototype._removeObserver=function(e){var t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)},e.prototype._notifyObservers=function(){var e=this;this._finishPromise(),this._observers.slice().forEach(function(t){e._notifyObserver(t)})},e.prototype._finishPromise=function(){if(void 0!==this._resolve){var e=!0;switch(z(this._state)){case H.SUCCESS:Ke(this._resolve.bind(null,this.snapshot))();break;case H.CANCELED:case H.ERROR:Ke(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}},e.prototype._notifyObserver=function(e){switch(z(this._state)){case H.RUNNING:case H.PAUSED:e.next&&Ke(e.next.bind(e,this.snapshot))();break;case H.SUCCESS:e.complete&&Ke(e.complete.bind(e))();break;case H.CANCELED:case H.ERROR:e.error&&Ke(e.error.bind(e,this._error))();break;default:e.error&&Ke(e.error.bind(e,this._error))()}},e.prototype.resume=function(){var e=this._state===F.PAUSED||this._state===F.PAUSING;return e&&this._transition(F.RUNNING),e},e.prototype.pause=function(){var e=this._state===F.RUNNING;return e&&this._transition(F.PAUSING),e},e.prototype.cancel=function(){var e=this._state===F.RUNNING||this._state===F.PAUSING;return e&&this._transition(F.CANCELING),e},e}(),Je=function(){function e(e,t){this._service=e,this._location=t instanceof oe?t:oe.makeFromUrl(t)}return e.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},e.prototype.newRef=function(t,r){return new e(t,r)},Object.defineProperty(e.prototype,"root",{get:function(){var e=new oe(this._location.bucket,"");return this.newRef(this._service,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return ue(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=ae(this._location.path);if(null===t)return null;var r=new oe(this._location.bucket,t);return new e(this._service,r)},enumerable:!1,configurable:!0}),e.prototype._throwIfRoot=function(e){if(""===this._location.path)throw O(e)},e}();function Ye(e,t,r){return void 0===r&&(r=null),e._throwIfRoot("uploadBytesResumable"),new Ze(e,new ne(t),r)}function Qe(e,r,n,o){void 0===n&&(n=k.RAW),e._throwIfRoot("putString");var i=P(n,r),a=(0,t.__assign)({},o);return null==a.contentType&&null!=i.contentType&&(a.contentType=i.contentType),new Ze(e,new ne(i.data,!0),a)}function $e(e){var t={prefixes:[],items:[]};return et(e,t).then(function(){return t})}function et(e,r,n){return(0,t.__awaiter)(this,void 0,void 0,function(){var o,i,a;return(0,t.__generator)(this,function(t){switch(t.label){case 0:return[4,tt(e,{pageToken:n})];case 1:return o=t.sent(),(i=r.prefixes).push.apply(i,o.prefixes),(a=r.items).push.apply(a,o.items),null==o.nextPageToken?[3,3]:[4,et(e,r,o.nextPageToken)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function tt(e,r){return(0,t.__awaiter)(this,void 0,void 0,function(){var n,o,i;return(0,t.__generator)(this,function(t){switch(t.label){case 0:return null!=r&&"number"==typeof r.maxResults&&$("options.maxResults",1,1e3,r.maxResults),[4,e.storage.getAuthToken()];case 1:return n=t.sent(),o=r||{},i=Ie(e.storage,e._location,"/",o.pageToken,o.maxResults),[2,e.storage.makeRequest(i,n).getPromise()]}})})}function rt(e){return(0,t.__awaiter)(this,void 0,void 0,function(){var r,n;return(0,t.__generator)(this,function(t){switch(t.label){case 0:return e._throwIfRoot("getMetadata"),[4,e.storage.getAuthToken()];case 1:return r=t.sent(),n=Pe(e.storage,e._location,_e()),[2,e.storage.makeRequest(n,r).getPromise()]}})})}function nt(e,r){return(0,t.__awaiter)(this,void 0,void 0,function(){var n,o;return(0,t.__generator)(this,function(t){switch(t.label){case 0:return e._throwIfRoot("updateMetadata"),[4,e.storage.getAuthToken()];case 1:return n=t.sent(),o=De(e.storage,e._location,r,_e()),[2,e.storage.makeRequest(o,n).getPromise()]}})})}function ot(e){return(0,t.__awaiter)(this,void 0,void 0,function(){var r,n;return(0,t.__generator)(this,function(t){switch(t.label){case 0:return e._throwIfRoot("getDownloadURL"),[4,e.storage.getAuthToken()];case 1:return r=t.sent(),n=xe(e.storage,e._location,_e()),[2,e.storage.makeRequest(n,r).getPromise().then(function(e){if(null===e)throw T();return e})]}})})}function it(e){return(0,t.__awaiter)(this,void 0,void 0,function(){var r,n;return(0,t.__generator)(this,function(t){switch(t.label){case 0:return e._throwIfRoot("deleteObject"),[4,e.storage.getAuthToken()];case 1:return r=t.sent(),n=Le(e.storage,e._location),[2,e.storage.makeRequest(n,r).getPromise()]}})})}function at(e,t){var r=se(e._location.path,t),n=new oe(e._location.bucket,r);return new Je(e.storage,n)}var st=function(){function e(e,t,r){this._delegate=e,this.task=t,this.ref=r}return Object.defineProperty(e.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),e}(),ut=function(){function e(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate),this._snapshot=new st(this._delegate.snapshot,this,this._ref)}return Object.defineProperty(e.prototype,"snapshot",{get:function(){return this._snapshot},enumerable:!1,configurable:!0}),e.prototype.then=function(e,t){var r=this;return this._delegate.then(function(t){if(e)return e(new st(t,r,r._ref))},t)},e.prototype.on=function(e,t,r,n){var o=this,i=void 0;return t&&(i="function"==typeof t?function(e){return t(new st(e,o,o._ref))}:{next:t.next?function(e){return t.next(new st(e,o,o._ref))}:void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,i,r||void 0,n||void 0)},e}(),ct=function(){function e(e,t){this._delegate=e,this._service=t}return Object.defineProperty(e.prototype,"prefixes",{get:function(){var e=this;return this._delegate.prefixes.map(function(t){return new lt(t,e._service)})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){var e=this;return this._delegate.items.map(function(t){return new lt(t,e._service)})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),e}(),lt=function(){function e(e,t){this._delegate=e,this.storage=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this._delegate.toString()},e.prototype.child=function(t){return new e(at(this._delegate,t),this.storage)},Object.defineProperty(e.prototype,"root",{get:function(){return new e(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return null==t?null:new e(t,this.storage)},enumerable:!1,configurable:!0}),e.prototype.put=function(e,t){return this._throwIfRoot("put"),new ut(Ye(this._delegate,e,t),this)},e.prototype.putString=function(e,t,r){return void 0===t&&(t=k.RAW),this._throwIfRoot("putString"),new ut(Qe(this._delegate,e,t,r),this)},e.prototype.listAll=function(){var e=this;return $e(this._delegate).then(function(t){return new ct(t,e.storage)})},e.prototype.list=function(e){var t=this;return tt(this._delegate,e).then(function(e){return new ct(e,t.storage)})},e.prototype.getMetadata=function(){return rt(this._delegate)},e.prototype.updateMetadata=function(e){return nt(this._delegate,e)},e.prototype.getDownloadURL=function(){return ot(this._delegate)},e.prototype.delete=function(){return this._throwIfRoot("delete"),it(this._delegate)},e.prototype._throwIfRoot=function(e){if(""===this._delegate._location.path)throw O(e)},e}(),ht=function(){function e(e){this.promise_=Promise.reject(e)}return e.prototype.getPromise=function(){return this.promise_},e.prototype.cancel=function(e){},e}();function ft(e,r,n){var o=1,i=null,a=!1,s=0;function u(){return 2===s}var c=!1;function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];c||(c=!0,r.apply(null,e))}function h(t){i=setTimeout(function(){i=null,e(f,u())},t)}function f(e){for(var r,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];c||(e?l.call.apply(l,(0,t.__spreadArrays)([null,e],n)):u()||a?l.call.apply(l,(0,t.__spreadArrays)([null,e],n)):(o<64&&(o*=2),1===s?(s=2,r=0):r=1e3*(o+Math.random()),h(r)))}var p=!1;function d(e){p||(p=!0,c||(null!==i?(e||(s=2),clearTimeout(i),h(0)):e||(s=1)))}return h(0),setTimeout(function(){a=!0,d(!0)},n),d}function pt(e){e(!1)}var dt=function(){function e(e,t,r,n,o,i,a,s,u,c,l){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=e,this.method_=t,this.headers_=r,this.body_=n,this.successCodes_=o.slice(),this.additionalRetryCodes_=i.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise(function(e,t){h.resolve_=e,h.reject_=t,h.start_()})}return e.prototype.start_=function(){var e=this;function t(t,r){var n,o=e.resolve_,i=e.reject_,a=r.xhr;if(r.wasSuccessCode)try{var s=e.callback_(a,a.getResponseText());W(s)?o(s):o()}catch(u){i(u)}else null!==a?((n=f()).serverResponse=a.getResponseText(),e.errorCallback_?i(e.errorCallback_(a,n)):i(n)):r.canceled?i(n=e.appDelete_?N():b()):i(n=v())}this.canceled_?t(0,new _t(!1,null,!0)):this.backoffId_=ft(function(t,r){if(r)t(!1,new _t(!1,null,!0));else{var n=e.pool_.createXhrIo();e.pendingXhr_=n,null!==e.progressCallback_&&n.addUploadProgressListener(o),n.send(e.url_,e.method_,e.body_,e.headers_).then(function(r){null!==e.progressCallback_&&r.removeUploadProgressListener(o),e.pendingXhr_=null;var n=(r=r).getErrorCode()===B.NO_ERROR,i=r.getStatus();if(n&&!e.isRetryStatusCode_(i)){var a=-1!==e.successCodes_.indexOf(i);t(!0,new _t(a,r))}else{var s=r.getErrorCode()===B.ABORT;t(!1,new _t(!1,null,s))}})}function o(t){var r=t.loaded,n=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(r,n)}},t,this.timeout_)},e.prototype.getPromise=function(){return this.promise_},e.prototype.cancel=function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&pt(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},e.prototype.isRetryStatusCode_=function(e){var t=e>=500&&e<600,r=-1!==[408,429].indexOf(e),n=-1!==this.additionalRetryCodes_.indexOf(e);return t||r||n},e}(),_t=function(){return function(e,t,r){this.wasSuccessCode=e,this.xhr=t,this.canceled=!!r}}();function gt(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}function vt(t){var r=void 0!==e.default?e.default.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+r}function bt(e,t){t&&(e["X-Firebase-GMPID"]=t)}function mt(e,t,r,n){var o=le(e.urlParams),i=e.url+o,a=Object.assign({},e.headers);return bt(a,t),gt(a,r),vt(a),new dt(i,e.method,a,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,n)}function yt(e){return/^[A-Za-z]+:\/\//.test(e)}function Rt(e,t){return new Je(e,t)}function wt(e,t){if(e instanceof Ut){var r=e;if(null==r._bucket)throw R();var n=new Je(r,r._bucket);return null!=t?wt(n,t):n}if(void 0!==t){if(t.includes(".."))throw U('`path` param cannot contain ".."');return at(e,t)}return e}function Et(e,t){if(t&&yt(t)){if(e instanceof Ut)return Rt(e,t);throw U("To use ref(service, url), the first argument must be a Storage instance.")}return wt(e,t)}function Tt(e){var t=null==e?void 0:e[a];return null==t?null:oe.makeFromBucketSpec(t)}var Ut=function(){function e(e,t,r,n){this.app=e,this._authProvider=t,this._pool=r,this._url=n,this._bucket=null,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=s,this._maxUploadRetryTime=u,this._requests=new Set,this._bucket=null!=n?oe.makeFromBucketSpec(n):Tt(this.app.options)}return Object.defineProperty(e.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(e){$("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(e){$("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e},enumerable:!1,configurable:!0}),e.prototype.getAuthToken=function(){return(0,t.__awaiter)(this,void 0,void 0,function(){var e,r;return(0,t.__generator)(this,function(t){switch(t.label){case 0:return(e=this._authProvider.getImmediate({optional:!0}))?[4,e.getToken()]:[3,2];case 1:if(null!==(r=t.sent()))return[2,r.accessToken];t.label=2;case 2:return[2,null]}})})},e.prototype._delete=function(){return this._deleted=!0,this._requests.forEach(function(e){return e.cancel()}),this._requests.clear(),Promise.resolve()},e.prototype.makeStorageReference=function(e){return new Je(this,e)},e.prototype.makeRequest=function(e,t){var r=this;if(this._deleted)return new ht(N());var n=mt(e,this._appId,t,this._pool);return this._requests.add(n),n.getPromise().then(function(){return r._requests.delete(n)},function(){return r._requests.delete(n)}),n},e}(),Nt=function(){function e(e,t){var r=this;this.app=e,this._delegate=t,this.INTERNAL={delete:function(){return r._delegate._delete()}}}return Object.defineProperty(e.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),e.prototype.ref=function(e){if(yt(e))throw U("ref() expected a child path but got a URL, use refFromURL instead.");return new lt(Et(this._delegate,e),this)},e.prototype.refFromURL=function(e){if(!yt(e))throw U("refFromURL() expected a full URL but got a child path, use ref() instead.");try{oe.makeFromUrl(e)}catch(t){throw U("refFromUrl() expected a valid full URL but got an invalid one.")}return new lt(Et(this._delegate,e),this)},e.prototype.setMaxUploadRetryTime=function(e){this._delegate.maxUploadRetryTime=e},e.prototype.setMaxOperationRetryTime=function(e){this._delegate.maxOperationRetryTime=e},e}(),Ot="@firebase/storage",At="0.4.2",Ct="storage";function kt(e,t){var r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal");return new Nt(r,new Ut(r,n,new X,t))}function St(e){var t={TaskState:H,TaskEvent:q,StringFormat:k,Storage:Ut,Reference:lt};e.INTERNAL.registerComponent(new n.Component(Ct,kt,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion(Ot,At)}St(e.default);
},{"@firebase/app":"VxYX","tslib":"vCxL","@firebase/util":"KxmD","@firebase/component":"sLOu"}],"jzRU":[function(require,module,exports) {
"use strict";require("@firebase/storage");
},{"@firebase/storage":"wU43"}],"z5Lg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.storage=exports.default=void 0;var e=r(require("firebase/app"));function r(e){return e&&e.__esModule?e:{default:e}}require("firebase/firestore"),require("firebase/storage");var o={apiKey:"AIzaSyCbT6Pkdo2fF6M_xT4ePB5F2gVROofBshU",authDomain:"portfolio-24d92.firebaseapp.com",databaseURL:"https://portfolio-24d92.firebaseio.com",projectId:"portfolio-24d92",storageBucket:"portfolio-24d92.appspot.com",messagingSenderId:"490599112206",appId:"1:490599112206:web:cfdb1f5c938d2ee724665f"};e.default.initializeApp(o);var t=e.default.firestore(),a=e.default.storage(),s=t;exports.default=s;var i=a;exports.storage=i;
},{"firebase/app":"OJEJ","firebase/firestore":"vHL5","firebase/storage":"jzRU"}],"Focm":[function(require,module,exports) {
"use strict";var e=t(require("./firebase"));function t(e){return e&&e.__esModule?e:{default:e}}require("firebase/firestore");var r=e.default.collection("skills").get();function n(e,t){var r=t.querySelector(".skill-name"),n=r.querySelector("a");return n.innerText=e.name,e.projectExample&&(n.href="./works.html#".concat(e.projectExample),n.classList.add("underline")),r.querySelector("span").id="".concat(e.language,"-value"),t.querySelector(".progress-bar-container").style.width="".concat(e.progress,"%"),t}function l(e){setTimeout(function(){var t,r,n,l,o,c,a;t="".concat(e.language,"-value"),r=e.progress,n=600,l=document.getElementById(t),o=Math.floor(n/r),c=0,a=setInterval(function(){try{l.innerText="".concat(c,"%"),c+1<=r?c+=1:(console.log("Animation finished"),clearInterval(a))}catch(e){console.error("Error while animating progress"),clearInterval(a)}},o)},1e3)}if("content"in document.createElement("template")&&null!=document.querySelector("#skill-template")){var o=document.querySelector("#ul-skillset"),c=document.querySelector("#skill-template"),a=e.default.collection("skills");a.get().then(function(e){e.forEach(function(e){var t=c.content.cloneNode(!0),r=e.data();o.appendChild(n(r,t)),l(r)})}).catch(function(e){console.error("Failed to fetch skills: "+e)})}
},{"./firebase":"z5Lg","firebase/firestore":"vHL5"}]},{},["Focm"], null)
//# sourceMappingURL=/src.90aea432.js.map